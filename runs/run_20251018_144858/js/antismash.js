/*!
 * antismash-js, version: 0.16.6
 * License: GNU Affero General Public License v3 or later
 */
var viewer;(()=>{var t={8111:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Area=void 0;const r=n(6041);class i{static fromInterface(t){var e,n,r,s,a,o,l;return new i(t.start,t.end,t.height,null!==(e=t.neighbouring_start)&&void 0!==e?e:t.start,null!==(n=t.neighbouring_end)&&void 0!==n?n:t.end,null!==(r=t.product)&&void 0!==r?r:"",null!==(s=t.category)&&void 0!==s?s:"",null!==(a=t.tool)&&void 0!==a?a:"",null!==(o=t.kind)&&void 0!==o?o:"",null!==(l=t.prefix)&&void 0!==l?l:"",t.group)}constructor(t,e,n,i,s,a,o,l,c,u,h,d){this.start=t,this.end=e,this.height=n,this.neighbouringStart=null!=i?i:t,this.neighbouringEnd=null!=s?s:e,this.product=null!=a?a:"",this.category=null!=o?o:"",this.tool=null!=l?l:"",this.prefix=null!=u?u:"",this.kind=null!=c?c:"",this.group=h,this.otherSide=d,this.css="candidatecluster"===this.kind?`candidate-${a.split(" ")[2].replace("chemical_","")}`:"subregion"===this.kind&&0===this.prefix.length?`svgene-border-${this.tool}`:"",this.transform=new r.Transform(0,0,0,0)}isSplit(){return void 0!==this.otherSide}containsCore(){return this.start!==this.end}splitsInNeighbourhood(){return!(!this.isSplit()||"protocluster"!==this.kind)&&(void 0!==this.otherSide&&!(this.otherSide.containsCore()&&this.containsCore()))}getWidthOffset(){return this.splitsInNeighbourhood()&&0===this.neighbouringStart?1:0}}e.Area=i},1029:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addCircularMarkerGroup=e.CircularMarkerInfo=void 0;const r=n(777);e.CircularMarkerInfo=class{constructor(t,e,n,r){this.image=t,this.barEnd=e,this.barTop=n,this.cssClass=r}},e.addCircularMarkerGroup=function(t,e,n,i,s){const a=t.append("g").attr("class",`circular-marker ${e.cssClass}`),o=function(t,e){const i=t+10,s=(0,r.path)();return s.moveTo(t,e),s.bezierCurveTo(t+2.8418902,e,i,e+.691745,i,e+2),e-=n-2.6458332,s.lineTo(i,e-.8829578),s.bezierCurveTo(i,e-1.7593968,t+3.8196618,e-2.6561282,t,e-2.6458332),s.toString()}(e.barEnd,n);return a.append("path").attr("class",`circular-back-arc ${e.cssClass}`).style("fill","url(#cross-origin-region-gradient-fade)").style("stroke","none").style("stroke-width",0).style("transform",`scale(1, -0.66) translate(${i.x-1}px, ${i.y-2*n}px)`).attr("d",o+"Z"),a.append("path").attr("class",`circular-front-arc cluster-bar-extension ${e.cssClass}`).attr("d",o+"Z").style("stroke-width","0").style("stroke","none"),s||a.append("path").attr("class",`${e.cssClass} circular-border`).attr("d",o).style("stroke","black").style("fill","none"),a}},3176:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Coordinates=void 0;e.Coordinates=class{constructor(t,e){this.x=t,this.y=e}}},9813:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Dimensions=void 0;e.Dimensions=class{constructor(t,e){this.height=e,this.width=t}}},3446:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Orf=void 0;const r=n(6041);e.Orf=class{constructor(t){this.start=t.start,this.end=t.end,this.strand=t.strand,this.type=t.type,this.description=t.description,this.locusTag=t.locus_tag,this.product=t.product,this.translation=t.translation,this.dna=t.dna,this.resistance=t.resistance,this.color=t.color,this.group=t.group,this.transform=new r.Transform(0,0,0,0)}getLocus(){return this.isSplit()&&void 0!==this.otherSide&&1===this.start?this.otherSide.locusTag:this.locusTag}isSplit(){return void 0!==this.otherSide}}},6041:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Transform=void 0;const r=n(3176);class i{constructor(t,e,n,i){this.scale=new r.Coordinates(t,e),this.translate=new r.Coordinates(n,i)}toStyle(t){return t||(t=new i(0,0,0,0)),`scale(${this.scale.x+t.scale.x},${this.scale.y+t.scale.y}) translate(${this.translate.x+t.translate.x}px,${this.translate.y+t.translate.y}px)`}}e.Transform=i},2220:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clipboardCopyConstruct=e.copyToClipboard=void 0,e.copyToClipboard=function(){const t=$(this).attr("data-seq")||"";try{navigator.clipboard.writeText(t)}catch(t){return void alert("A browser permissions error occured while trying to copy the sequence to the clipboard")}alert("Sequence copied to clipboard")},e.clipboardCopyConstruct=function(t){return`<span class="clipboard-copy" data-seq="${t}">Copy to clipboard</span>`}},5225:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.drawClusterblast=e.setClusterblastData=void 0;const r=n(9086),i=n(4677),s=n(5003),a=n(5130);let o=null,l=null;const c=16,u=10,h=10;function d(t,e,n){$("#cb-current-label").remove();const r=$("<div>");r.addClass("clusterblast-locustag"),r.attr("id","cb-current-label"),e?r.text(e):r.text("unknown");let i=n.offset();void 0===i&&(i={left:0,top:0}),r.css("top",i.top-30),r.css("left",i.left-15),$(`#${t}`).parent().append(r),r.show()}function g(){$("#cb-current-label").remove()}function f(t,e,n,r,i=!1){const s=n+r/2,a=n-r/2,o=e(t.start),l=e(t.end);if(i){if(1===t.strand){const t=Math.floor(o),e=Math.floor(Math.min(l+r/2,t));return`${t},${s} ${e},${s} ${Math.floor(l)},${n} ${e},${a} ${t},${a}`}if(-1===t.strand){const t=Math.floor(o),e=Math.floor(l),i=Math.floor(Math.max(o-r/2,e));return`${t},${n} ${i},${s} ${e},${s} ${e},${a} ${i},${a}`}return`${o},${s} ${l},${s} ${l},${a} ${o},${a}`}if(1===t.strand){const t=Math.floor(o),e=Math.floor(Math.max(l-r/2,t));return`${t},${s} ${e},${s} ${Math.floor(l)},${n} ${e},${a} ${t},${a}`}if(-1===t.strand){const t=Math.floor(o),e=Math.floor(l),i=Math.floor(Math.min(o+r/2,e));return`${t},${n} ${i},${s} ${e},${s} ${e},${a} ${i},${a}`}return`${o},${s} ${l},${s} ${l},${a} ${o},${a}`}function p(t,e,n,s,o,p,m,v,y,b=u){if(!l)return;const x=l.anchor,w=n-Math.floor((b+c)/2),S=t.append("rect").attr("x",0).attr("y",w-c).attr("width",o).attr("height",b+2*c).style("opacity","0");let A=t;if(v){const n=(0,a.replaceWildcardsInText)(v,e);A=t.append("a").attr("xlink:href",n).attr("target","_blank")}A.append("text").attr("x",h).attr("y",w).attr("text-anchor","start").attr("class","clusterblast-acc").text(e.label),t.append("text").attr("x",o-h).attr("y",w).attr("text-anchor","end").attr("class","clusterblast-acc").text(e.product),t.append("line").attr("x1",0).attr("y1",n).attr("x2",o).attr("y2",n).attr("class","centerline");const C=e.start-m,M=e.end+m,_=(0,r.scaleLinear)().domain([C,M]).range([0,o]);function T(){e.reverse?_.domain([M,C]):_.domain([C,M])}T();const k=t.selectAll("g.cb-svg-reforf-group").data(e.genes).enter().append("g").attr("class","cb-svg-reforf-group");function N(){$(`#${y}-${x}-orf-tooltip`).hide(),e.reverse=!e.reverse,T(),k.select("polygon").transition().duration(750).attr("points",(t=>f(t,_,n,b,e.reverse)))}k.append("polygon").attr("points",(t=>f(t,_,n,b,e.reverse))).attr("class",(t=>"cb-svg-orf cb-svg-reforf svgene-type-other")).attr("id",((t,n)=>`${e.accession.replace(".","-")}-orf-${n}`)).attr("data-locus",(t=>t.locus_tag)).style("fill",(t=>t.colour)).on("click",(t=>function(t,e,n,r){if(!l)return;const i=l.anchor,s=$(`#${r}-${i}-orf-tooltip`);clearTimeout(s.data("timeout")),s.hide(),s.find(".clusterblast-tooltip-locus").html(t.locus_tag),s.find(".clusterblast-tooltip-product").html(t.product),s.find(".clusterblast-tooltip-location").html(`${t.real_start} - ${t.real_end}`);const a=s.find(".clusterblast-tooltip-matches");if(a.find(".cb-tooltip-table-cell").remove(),t.matches.length<1)a.hide();else{const e='<div class="cb-tooltip-table-cell';for(const n of t.matches)a.append(`${e} cb-tooltip-table-locus">${n.query}</div>`),a.append(`${e} cb-tooltip-table-numeric">${n.pid}%</div>`),a.append(`${e} cb-tooltip-table-numeric">${n.coverage}%</div>`);a.show()}s.css("top",n).css("left",e).show();let o=setTimeout((()=>s.slideUp("fast")),5e3);s.css("top",n).css("left",e).show().click((function(){$(this).hide()})).data("timeout",o).mouseover((()=>clearTimeout(s.data("timeout")))).mouseout((()=>{clearTimeout(s.data("timeout")),o=setTimeout((()=>s.slideUp("fast")),5e3),s.data("timeout",o)}))}(t,i.event.pageX+15,i.event.pageY+15,y))).on("mouseenter",((t,n)=>d(p,t.locus_tag,$(`#${e.accession.replace(".","-")}-orf-${n}`)))).on("mouseleave",(t=>g())),S.on("dblclick",N),k.on("dblclick",N)}function m(t,e,n,i,a,o,m=u){if(null===l)return;let v=[];o?v.push(o):v=i.matches.slice();const y=n.end-n.start,b=Math.max(y,Math.max(...v.map((t=>t.end-t.start)))),x=128+c,w=2.5*c+m,S=x+w*(v.length-1);let A=.25*x;l.idx;const C=800,M=n.genes.reduce(((t,e)=>t.start<e.start?t:e)).start,_=n.genes.reduce(((t,e)=>t.start>e.start?t:e)).end,T=.5*(b-(_-M)),k=(0,r.scaleLinear)().domain([M-T,_+T]).range([0,C]);t.attr("viewport",`0 ${S} 0 ${y}`).attr("height",S).attr("width",C);const N=t.append("g").attr("class","cb-query-group");N.append("text").attr("x",h).attr("y",c).attr("text-anchor","start").attr("class","clusterblast-acc").text("Query sequence"),N.append("line").attr("x1",0).attr("y1",A).attr("x2",C).attr("y2",A).attr("class","centerline");N.selectAll("g.cb-svg-orf-group").data(n.genes).enter().append("g").attr("class","cb-svg-orf-group").append("polygon").attr("points",(t=>f(t,k,A,m))).attr("class",(t=>"cb-svg-orf svgene-type-other")).attr("id",(t=>`${e}-${(0,s.tag_to_id)(t.locus_tag)}`)).attr("opacity","1").style("fill",(t=>`${i.query_colours[t.locus_tag]}`)).attr("data-locus",(t=>t.locus_tag)).on("click",(t=>(0,s.selectOrfsByLoci)([t.locus_tag],!1))).on("mouseenter",(t=>d(e,t.locus_tag,$(`#${e}-${(0,s.tag_to_id)(t.locus_tag)}`)))).on("mouseleave",(t=>g()));for(const n of v){A+=w;const r=.5*(b-(n.end-n.start));p(t.append("g").attr("id",`cb-ref-group-${n.accession}`),n,A,0,C,e,r,i.url,a)}}function v(){if(!l||!o)return;const t=l.anchor;for(const e of o.references){const n=e.variant_name,r=$(`.body-details-header.${t}-${n}`),s=$(`#${n}-${t}-orf-tooltip`);r.on("click",(()=>s.hide())),r.off(".firstClick").one("click.firstClick",(()=>{const r=`${n}-${t}-svg`;$(r).empty();const a=(0,i.select)(`#${r}`).append("svg").attr("class","cb-svg").attr("width","100%"),l=$(`#${n}-${t}-select`);l.off("change").change((function(){if(s.hide(),!o)return;let t=$(this).find(":selected").val();if(a.selectAll("*").remove(),"string"!=typeof t||"all"===t)return t="",void m(a,r,o.query,e,n);for(const i of e.matches)if(i.unique_name===t)return void m(a,r,o.query,e,n,i)})),l.change()}))}}e.setClusterblastData=function(t,e,n){o=e,l=n,$(".cb-svg").remove(),$(".clusterblast-orf-tooltip").hide(),v()},e.drawClusterblast=v},9026:(t,e)=>{"use strict";function n(t){t.toggleClass("expanded"),t.hasClass("expanded")?t.next().css("display","block"):t.next().removeAttr("style")}Object.defineProperty(e,"__esModule",{value:!0}),e.toggleCollapserHandler=e.toggleCollapser=void 0,e.toggleCollapser=n,e.toggleCollapserHandler=function(t){n($(this))}},8322:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setComparisonData=void 0;const r=n(9086),i=n(4677),s=n(5003);let a=null,o=null;function l(t,e,n,r,i){const s=n+r/2,a=n-r/2,o=n;if(i){if(1===t.strand){const n=Math.floor(e(t.start)),i=Math.floor(Math.min(e(t.end)+r/2,n));return`${n},${s} ${i},${s} ${Math.floor(e(t.end))},${o} ${i},${a} ${n},${a}`}if(-1===t.strand){const n=Math.floor(e(t.start)),i=Math.floor(e(t.end)),l=Math.floor(Math.max(e(t.start)-r/2,i));return`${n},${o} ${l},${s} ${i},${s} ${i},${a} ${l},${a}`}return`${t.start},${s} ${t.end},${s} ${t.end},${a} ${t.start},${a}`}if(1===t.strand){const n=Math.floor(e(t.start)),i=Math.floor(Math.max(e(t.end)-r/2,n));return`${n},${s} ${i},${s} ${Math.floor(e(t.end))},${o} ${i},${a} ${n},${a}`}if(-1===t.strand){const n=Math.floor(e(t.start)),i=Math.floor(e(t.end)),l=Math.floor(Math.min(e(t.start)+r/2,i));return`${n},${o} ${l},${s} ${i},${s} ${i},${a} ${l},${a}`}return`${t.start},${s} ${e(t.end)},${s} ${e(t.end)},${a} ${e(t.start)},${a}`}function c(t,e){const n=window.location.hash.substring(1),c=document.getElementById(`comparison-${e}-${n}-selector`);if(!c||!c.value)return;const u=$(`#${t} * .heat-row-${e}`);u.off("click").click((function(){$(`.heat-row-${e}`).css("border",""),$(this).css("border","1px solid black");const t=$(this),u=`comparison-${e}-${n}-svg`;$(`#${u}`).remove();const h=(0,i.select)(`#comparison-${e}-${n}`).append("svg").attr("width","100%").attr("id",u),d=a[e][c.value],g=t.attr("data-accession");g&&(!function(t,e,n,i){if(null===i||null===o)return;const a=54.5,c=109.5,u=10,h=o.end-o.start,d=o.idx,g=800,f=(0,r.scaleLinear)().domain([o.start,o.end]).range([0,g]);let p=(0,r.scaleLinear)().domain([i.start,i.end]).range([0,g]);i.reverse&&(p=(0,r.scaleLinear)().domain([i.end,i.start]).range([0,g])),t.attr("viewport",`0 164 0 ${h}`).attr("height",164).attr("width",g),t.append("text").attr("x",0).attr("y",20).attr("text-anchor","start").text("Query"),t.append("text").attr("x",0).attr("y",155).attr("text-anchor","start").text(`Reference: ${e.indexOf("-mibig-")>-1?n.split(":")[0]:n}`),t.append("line").attr("x1",0).attr("y1",a).attr("x2",h).attr("y2",a).attr("class","centerline"),t.append("line").attr("x1",0).attr("y1",c).attr("x2",h).attr("y2",c).attr("class","centerline"),t.selectAll("line.link").data(i.links).enter().append("line").attr("x1",(t=>f(t.query_loc))).attr("y1",59.5).attr("x2",(t=>p(t.subject_loc))).attr("y2",104.5).attr("class","link").attr("class","centerline");const m=t.selectAll("g.cc-svg-orf-group").data(o.orfs).enter().append("g").attr("class","cc-svg-orf-group");m.append("polygon").attr("points",(t=>l(t,f,a,u))).attr("class","cc-svg-orf-bg").attr("id",(t=>`${e}-${(0,s.tag_to_id)(t.locus_tag)}-bg`)).style("fill","white"),m.append("polygon").attr("points",(t=>l(t,f,a,u))).attr("class",(t=>`cc-svg-orf svgene-type-${t.type}`)).attr("id",(t=>`${e}-${(0,s.tag_to_id)(t.locus_tag)}`)).attr("opacity","1").attr("data-locus",(t=>t.locus_tag)),t.selectAll("text.svgene-locustag").data(o.orfs).enter().append("text").attr("x",(t=>f(t.start)<400?f(t.start):f(t.end))).attr("text-anchor",(t=>f(t.start)<400?"start":"end")).attr("y",36.5).attr("class","cc-svg-locustag").attr("id",(t=>`${e}-${(0,s.tag_to_id)(t.locus_tag)}-tag`)).text((t=>t.locus_tag));const v=t.selectAll("g.cc-svg-reforf-group").data(i.genes).enter().append("g").attr("class","cc-svg-reforf-group");v.append("polygon").attr("points",(t=>l(t,p,c,u,i.reverse))).attr("class","cc-svg-reforf-bg").attr("id",(t=>`${e}-ref${(0,s.tag_to_id)(t.locus_tag)}-bg`)).style("fill","white"),v.append("polygon").attr("points",(t=>l(t,p,c,u,i.reverse))).attr("class",(t=>`cc-svg-reforf svgene-type-${t.function}`)).attr("id",(t=>`${e}-ref${(0,s.tag_to_id)(t.locus_tag)}`)).attr("data-locus",(t=>t.locus_tag)).style("opacity",(t=>t.linked[`${d}`]?"1":"0.5")),t.selectAll("text.svgene-locustag").data(i.genes).enter().append("text").attr("x",(t=>p(t.start)<400?p(t.start):p(t.end))).attr("text-anchor",(t=>p(t.start)<400?"start":"end")).attr("y",127.5).attr("class","cc-svg-locustag").attr("id",(t=>`${e}-ref${(0,s.tag_to_id)(t.locus_tag)}-tag`)).text((t=>t.locus_tag))}(h,u,g,d.reference_clusters[g]),$(".cc-svg-orf").mouseover((function(t){const e=$(this).attr("id");void 0!==e&&$(`#${e}-tag`).show()})).mouseout((function(t){const e=$(this).attr("id");void 0!==e&&$(`#${e}-tag`).hide()})).click((function(t){const e=$(this).attr("data-locus");e&&(0,s.selectOrfsByLoci)([e],t.ctrlKey||t.metaKey)})),$(".cc-svg-reforf").mouseover((function(t){const e=$(this).attr("id");void 0!==e&&$(`#${e}-tag`).show()})).mouseout((function(t){const e=$(this).attr("id");void 0!==e&&$(`#${e}-tag`).hide()})))})),u.first().click()}e.setComparisonData=function(t,e,n){a=e,o=n;for(const n in e)e.hasOwnProperty(n)&&c(t,n)}},6128:(t,e)=>{"use strict";function n(t,e){!function(t,e){$(`#${e} * .body-details-section`).hide(),$(`#${e} * .body-details-header-active`).toggleClass("body-details-header-active"),t.addClass("body-details-header-active"),$(`#${e} * .body-details-section.${t.attr("data-name")}`).show()}($(this),t);const n=$(`#${t} * .sidepanel-details-header.${$(this).attr("data-name")}`);n.length>0&&i(n,t)}function r(t,e){i($(this),t);$(`#${t} * .body-details-header.${$(this).attr("data-name")}`).click()}function i(t,e){$(`#${e} * .sidepanel-details-section`).hide(),$(`#${e} * .sidepanel-details-header-active`).toggleClass("sidepanel-details-header-active"),t.addClass("sidepanel-details-header-active"),$(`#${e} * .sidepanel-details-section.${t.attr("data-name")}`).show()}Object.defineProperty(e,"__esModule",{value:!0}),e.setupDetails=void 0,e.setupDetails=function(t){$(".sidepanel-details-header").off("click"),$(".sidepanel-details-section").hide();for(const e of t)$(`#${e} * .sidepanel-details-header`).click($.proxy(r,null,e)).first().trigger("click");$(".body-details-header").off("click"),$(".body-details-section").hide();for(const e of t)$(`#${e} * .body-details-header`).click($.proxy(n,null,e)).first().trigger("click")}},4501:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.actualDrawDomainBubbleData=e.drawDomainBubbleData=void 0;const r=n(4677),i=n(5003),s=15,a=-s,o=m(0,a,2*s)-s,l=6,c=s/3,u=2*s,h=16,d=10,g=20,f=20;let p=null;function m(t,e,n){return 0===t?Math.round(Math.sqrt(n*n-e*e)):0===e?Math.round(Math.sqrt(n*n-t*t)):Math.round(Math.sqrt(t*t+e*e))}function v(t,e){const n=e;let r=n.y-1.5*l,i=n.y+1.5*l,s=n.x-l,a=s+2*l;const o=l-1;return t.append("polygon").attr("class","bubble-domain-terminal-docking").attr("points",`${s},${r} ${s+o},${n.y} ${s},${i} ${s+o},${i} ${a},${n.y} ${s+o},${r} ${s},${r}`),"end"===e.terminalDocking?(s=n.x-l,a=n.x):(s=n.x,a=n.x+l),r=n.y-l/3,i=n.y+l/3,t.append("polygon").attr("class","bubble-domain-terminal-docking").attr("points",`${s},${r} ${a},${r} ${a},${i} ${s},${i} ${s},${r}`),t}function y(t,e,n){if(!e.iterative)return t.append("line").attr("x1",e.start).attr("x2",e.end).attr("y1",n).attr("y2",n).attr("class","bubble-module-line"+(e.nonElongating?"-non-elongating":"")),t;const r=n+2.5*s,i=n+(r-n)/2,a=(e.end,r-i+2),o=e.start+1.5*s,l=e.end-1.5*s,c=e.start+.75*(e.end-e.start);return t.append("path").attr("class","bubble-module-line").attr("d",`M ${e.start},${i}\n                  A ${a} ${a} 0 0 1 ${o},${n}\n                  L ${l},${n}\n                  A ${a} ${a} 0 0 1 ${e.end},${i}\n                  A ${a} ${a} 0 0 1 ${l},${r}\n                  L ${c},${r}\n                  L ${c+10},${r-10}\n                  M ${c-10},${r}\n                  L ${o},${r}\n                  A ${a} ${a} 0 0 1 ${e.start},${i}`).attr("fill","none"),t}function b(t,e){if(!document.getElementById(`${t}-domain-bubble-svg-container`))return;const n=`${t}-domain-bubble-svg`;if($(`#${n}`).remove(),!e)return;const h=[],p=e.modules,b=function(t){const e=[];for(const n of t)for(const t of n.domains)e.push({dom:t,mod:t.modifier});e.push({dom:null,mod:!1});let n=0,r=0,i=0;for(const t of e){if(t.dom&&(t.dom.level=0),t.mod){r+=1,n+=1;continue}if(0===r){n+=1;continue}const s=Math.floor(r/2);s+r%2>i&&(i=s+r%2);for(let t=0;t<s;t++)e[n-r+t].dom.level=t+1,e[n-1-t].dom.level=t+1;r%2==1&&(e[n-r+s].dom.level=s+1),r=0,n+=1}return i+1}(p),S=s*(b+1)+2*g,A=(0,r.select)(`#${t}-domain-bubble-svg-container`).append("svg").attr("width","100%").attr("height",S+4.5*s).attr("id",n).attr("class","domain-bubble-container");let C=s,M=S+a*p[0].domains[0].level,_=C,T=0,k=0,N=null,R="",L=0;for(const t of p){T>0&&(C+=c),t.number=++T,t.complete&&(t.completeNumber=++k);let e=0;for(const n of t.domains)N&&(N.cds!==n.cds?(0===e&&(C-=c),h.push({end:C+N.radius,name:R,scale:1,start:_}),C+=u,_=C,L=0):L=N&&N.special&&n.modifier?s-m(0,a,l+s):N.level!==n.level?o:N.radius,N.cds===n.cds&&(n.terminalDocking||N.terminalDocking)&&(L-=c)),C+=L,n.special?n.radius=l:n.radius=s,C+=n.radius,n.x=C,N&&N.level!==n.level&&(N.level>n.level?M-=a:M+=a),n.terminalDocking&&(M=S),n.y=M,N=n,R=n.cds,e+=1;const n=t.domains[0],r=t.domains[t.domains.length-1];t.start=n.x-n.radius,t.end=r.x+r.radius,L=0}N&&(C+=N.radius),h.push({end:C,name:R,scale:1,start:_});const E=(0,r.select)(".bubble-tooltip");function P(t){const e=(0,r.select)(this);if(t.terminalDocking)return void v(e,t);e.append("circle").attr("class",(t=>`${t.css}`)).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).attr("r",(t=>t.special?l:s)),e.append("text").attr("x",(t=>t.x)).attr("y",(t=>t.y+s/3)).attr("text-anchor","middle").text((t=>t.special?"":t.name));const n=Math.sqrt(s*s/2),i=e.filter((t=>t.inactive)).append("g").attr("class","bubble-domain-inactive");i.append("line").attr("x1",(t=>t.x-n)).attr("x2",(t=>t.x+n)).attr("y1",(t=>t.y-n)).attr("y2",(t=>t.y+n)),i.append("line").attr("x1",(t=>t.x-n)).attr("x2",(t=>t.x+n)).attr("y1",(t=>t.y+n)).attr("y2",(t=>t.y-n))}T=0;for(const t of p){const e=A.append("g").attr("class",`module-group-${t.number}`).selectAll("g.domain-group").data(t.domains).enter().append("g").attr("class","g.domain-group");e.each(P),t.complete||e.style("opacity","50%"),e.on("click",(t=>E.text(t.description).style("display","block").style("top",`${r.event.pageY+20}px`).style("left",`${r.event.pageX+20}px`))).on("mouseout",(()=>E.style("display","none")))}M=S;const D=A.append("g").attr("class","module-labels").selectAll("g.bubble-module-label").data(p.filter((t=>t.complete))).enter().append("g").attr("class","bubble-module-label");D.each((function(t){return y((0,r.select)(this),t,M+1.5*s)})).append("text").attr("x",(t=>(t.start+t.end)/2)).attr("y",M+2.5*s).attr("class","bubble-module-number").attr("text-anchor","middle").text((t=>`M ${t.completeNumber}`)),D.append("text").attr("x",(t=>(t.start+t.end)/2)).attr("y",M+3.5*s).attr("class","bubble-module-monomer").attr("text-anchor","middle").text((t=>t.polymer)),M-=s*(b+1);const I=A.append("g").attr("class","bubble-genes").selectAll("line.bubble-gene-line").data(h).enter().append("g");I.attr("data-locus",(t=>t.name)).attr("class","bubble-gene"),I.append("polygon").attr("class","bubble-gene-arrow").attr("points",(t=>w(t.start,t.end,M))),I.append("text").text((t=>t.name)).attr("x",(t=>(t.start+t.end)/2)).attr("y",M).attr("class","serif bubble-gene-label").style("font-size","1px").each(x).style("font-size",(t=>t.scale>=d?`${t.scale}px`:`${d}px`)).style("fill",(t=>t.scale>=d?"white":"black")).attr("text-anchor",((t,e)=>{if(t.scale<d){if(0===e)return"start";if(e===h.length-1)return"end"}return"middle"})).attr("x",((t,e)=>{const n=Math.floor((t.start+t.end)/2);return t.scale<d?0===e?t.start:e===h.length-1?t.end:n:n-f/5})).attr("y",((t,e)=>t.scale<d?M-1.5*g+1.5*d*((e+1)%2):Math.floor(M+t.scale/3))),A.attr("width",C+2*s),$(".bubble-gene").off("click").click((function(t){$(`#${(0,i.locusToFullId)($(this).attr("data-locus")||"none")}-svgeneorf`).trigger(t)}))}function x(t){if(!this||!this.parentNode)return void(t.scale=h);const e=this.getBBox(),n=this.parentNode.getBBox();n.height;return t.scale=Math.min(h,Math.round((n.width-f)/e.width)),t.scale}function w(t,e,n){const r=n-g/2,i=r+g;let s=f;.2*(e-t)<s&&(s=Math.floor(.2*(e-t)));const a=Math.floor((i-r)/5),o=e-s;return`${t},${r}\n            ${o},${r}\n            ${o},${r-a}\n            ${e},${n}\n            ${o},${i+a}\n            ${o},${i}\n            ${t},${i}\n            ${t},${r}`}e.drawDomainBubbleData=function(t,e){p=e,$(`#${t}-domain-bubble-select`).off("change").change((function(){const e=""+$(this).val();if(p&&e&&p[e]){const n={};b(t,p[e]),n.showNonElongating=p[e].modules.some((t=>t.nonElongating)),function(t,e){const n="bubble-legend";if($(`#${n}`).length)return void $(`#${n}`).detach().appendTo(`#${t}-bubble-legend`);const i=2*s+4,a=2*s+4,o=s+2,c=(0,r.select)(`#${t}-bubble-legend`).append("div").attr("id",n);c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",a).attr("height",i).append("circle").attr("class","jsdomain-other module-bubble").attr("cx",o).attr("cy",o).attr("r",s),c.append("div").attr("class","bubble-legend-text").text("Domain in a complete module"),c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",a).attr("height",i).append("circle").attr("class","jsdomain-other module-bubble").attr("cx",o).attr("cy",o).attr("r",l),c.append("div").attr("class","bubble-legend-text").text("Special domain (e.g. trans-AT docking domains)"),c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",a).attr("height",i).append("circle").attr("class","jsdomain-other module-bubble").attr("cx",o).attr("cy",o).attr("r",s).style("opacity","50%"),c.append("div").attr("class","bubble-legend-text").text("Domain in an incomplete module or outside modules"),v(c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",a).attr("height",i),{x:a/2,y:i/2,terminalDocking:"start"}).style("opacity","50%"),c.append("div").attr("class","bubble-legend-text").text("N-terminal docking domains"),v(c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",a).attr("height",i),{x:a/2,y:i/2,terminalDocking:"end"}).style("opacity","50%"),c.append("div").attr("class","bubble-legend-text").text("C-terminal docking domains");const u=Math.floor(Math.sqrt(s*s/2)),h=o+u,d=o-u,g=c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",a).attr("height",i).append("g").attr("class","bubble-domain-inactive");g.append("circle").attr("class","jsdomain-other module-bubble").attr("cx",o).attr("cy",o).attr("r",s).style("opacity","50%"),g.append("line").attr("x1",d).attr("y1",d).attr("x2",h).attr("y2",h),g.append("line").attr("x1",d).attr("y1",h).attr("x2",h).attr("y2",d),c.append("div").attr("class","bubble-legend-text").text("Domains predicted to be inactive"),c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",4*s).attr("height",i).append("polygon").attr("class","bubble-gene-arrow").attr("points",w(s/3,4*s-s/3,o)),c.append("div").attr("class","bubble-legend-text").text("The gene/CDS feature containing the domains");const f=c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",3*s).attr("height",i).append("g").attr("class","bubble-module-label");if(f.append("line").attr("x1",2).attr("x2",3*s-2).attr("y1",4).attr("y2",4).attr("class","bubble-module-line"),f.append("text").attr("x",1.75*s).attr("y",1.75*s).attr("class","bubble-module-text").attr("text-anchor","middle").text("M #"),c.append("div").attr("class","bubble-legend-text").text("The extent of a module, with the module number and the predicted monomer for that module"),e.showNonElongating){const t=c.append("div").attr("class","bubble-legend-icon bubble-legend-non-elongating").append("svg").attr("width",3*s).attr("height",i).append("g").attr("class","bubble-module-label");t.append("line").attr("x1",2).attr("x2",3*s-2).attr("y1",4).attr("y2",4).attr("class","bubble-module-line-non-elongating"),t.append("text").attr("x",1.75*s).attr("y",1.75*s).attr("class","bubble-module-text").attr("text-anchor","middle").text("M #"),c.append("div").attr("class","bubble-legend-text bubble-legend-non-elongating").text("The extent of a module predicted to be non-elongating, though modification domains may still apply")}y(c.append("div").attr("class","bubble-legend-icon").append("svg").attr("width",6*s).attr("height",2.75*s).attr("viewbox",`0 0 ${6*s} ${4*s}`).attr("transform",`scale(${i/(3.5*s)} ${i/(3.5*s)})`).append("g").attr("class","bubble-module-label"),{complete:!0,completeNumber:1,domains:[],end:6*s-2,iterative:!0,number:1,polymer:"",start:2},1),c.append("div").attr("class","bubble-legend-text").text("Module extents when predicted to be iterative"),$(".bubble-legend-icon").css("height",`${i}px`)}(t,n)}})),$(`.body-details-header.${t}-nrps-pks-bubbles`).off(".firstClick").one("click.firstClick",(()=>{$(`#${t}-domain-bubble-select`).change()})),0===$(".bubble-tooltip").length&&(0,r.select)("body").append("div").attr("class","tooltip bubble-tooltip").text("")},e.actualDrawDomainBubbleData=b},5415:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.downloadSvg=e.initDownloadButtons=void 0;const n={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"};function r(t){if(!t.target)return!0;const n=t.target,r=n.getAttribute("data-tag"),i=n.getAttribute("data-filename");return!(!r||!i)&&((0,e.downloadSvg)(r,i),!1)}e.initDownloadButtons=()=>{document.querySelectorAll(".download-svg").forEach((t=>{t.removeEventListener("click",r,!1),t.addEventListener("click",r,!1)}))};function i(t,e){const n=getComputedStyle(t);let r="";for(let t=0,i=n.length;t<i;t++){const i=n[t],s=n.getPropertyValue(i);"cursor"!==i&&(s!==e.get(i)&&(r+=`${i}:${s};`))}t.setAttribute("style",r)}function s(t,e){if(!(null==t?void 0:t.hasChildNodes()))return;let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&"SCRIPT"!==n.nodeName&&(e.push(n),s(n,e)),n=n.nextSibling}e.downloadSvg=(t,e)=>{const r=document.querySelector(`#${t}`);if(!r)return;const a=r.children.length;let o;if(o="svg"===r.nodeName?r:r.children.item(0),!o||"svg"!==o.nodeName)return;const l=o.cloneNode(!0);!function(t){t.hasAttribute("version")||t.setAttribute("version","1.1");t.hasAttributeNS(n.xmlns,"xmlns")||t.setAttributeNS(n.xmlns,"xmlns",n.svg);t.hasAttributeNS(n.xmlns,"xmlns:xlink")||t.setAttributeNS(n.xmlns,"xmlns:xlink",n.xlink);document.body.appendChild(t),function(t){const e=document.createElementNS(n.svg,"svg");document.body.appendChild(e);const r=new Map,a=getComputedStyle(e);Object.values(a).forEach((t=>{r.set(t,a.getPropertyValue(t))})),document.body.removeChild(e);const o=function(t){const e=[];return e.push(t),s(t,e),e}(t);let l=o.length;for(;l--;)i(o[l],r);t.removeAttribute("width"),t.removeAttribute("height"),t.style.removeProperty("width"),t.style.removeProperty("height"),t.style.removeProperty("inline-size");const c=t.getAttribute("viewbox");c&&c.split(" ").length>3&&t.setAttribute("width",c.split(" ")[2])}(t),document.body.removeChild(t)}(l);const c=(new XMLSerializer).serializeToString(l),u=`data:image/svg+xml;base64,${btoa(c)}`,h=document.createElement("a");h.href=u,h.download=e;const d=e=>{setTimeout((()=>{var n;null===(n=null==e?void 0:e.target)||void 0===n||n.removeEventListener("click",d);const r=$(`#${t}`);r.children().length>a&&r.children().last().remove()}),200)};h.addEventListener("click",d,!1),h.click()}},6457:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initGeneTableHandler=void 0;const r=n(2220),i=n(5003),s=n(5130),a="gt";function o(t,e,n){if(!n)for(const e of t.querySelectorAll(`.${a}-matching-cell`))e.classList.remove(`.${a}-matching-cell`);e%2==1?(t.classList.remove("row-even"),t.classList.add("row-odd")):(t.classList.remove("row-odd"),t.classList.add("row-even")),t.style.display="";const r=t.querySelectorAll(`td.${a}-cell-match`)[0];r&&n.length>0&&(r.style.display=n.length>0?"":"none",r.innerHTML=n)}e.initGeneTableHandler=function(t,e){const n=`#${a}-container-${t.anchor}`,l=`#${a}-${t.anchor}`,c=$(n),u=c.find(`.${a}-scroll-container`),h=$(l),d=h.find("thead"),g=c.find(`.${a}-no-hits`),f=$(`#${a}-${t.anchor}-toggle`);var p,m;if(p=f,(m=$(`.${a}-zoom-toggle`)).off("change"),p.on("change",(()=>{const t=p.prop("checked");m.not(p).prop("checked",t),t?(0,i.zoom_to_selection)():(0,i.resetZoom)()})),0===h.length)return;!function(t,e,n){const r=$(`${t} tbody`);if($(r).children().length>0)return;let i=1;for(const t of e.orfs.sort(((t,e)=>t.start-e.start))){const e=(0,s.replaceWildcardsInText)(n.blast_template,t),a=(0,s.replaceWildcardsInText)(n.selected_template,t);let o=t.locus_tag;void 0!==t.group&&(o=o.replace(/_split$/gi,""));const l=[`<td class="serif search-cell" data-type="name">${a}${o}</td>`,`<td class="search-cell" data-type="product">${t.product}</td>`,`<td class="gt-cell-numeric">${t.dna.length}</td>`,`<td class="gt-cell-numeric">${t.translation.length}</td>`,`<td class="search-cell" data-type="function"><span class="colour-square legend-type-${t.type}"></span>${t.type}</td>`,`<td class="seq-copy seq-copy-nt gt-cell-interactable" data-locus="${t.locus_tag}"><span class="button-like">Copy</span></td>`,`<td class="seq-copy seq-copy-aa gt-cell-interactable" data-locus="${t.locus_tag}"><span class="button-like">Copy</span></td>`,`<td class="gt-cell-link gt-cell-interactable">${e}</td>`,'<td class="gt-column-match gt-cell-match" style="display:none"></td>'];r.append(`<tr class="gt-row row-${i%2?"odd":"even"}" data-locus="${t.locus_tag}">${l.join("")}</tr>`),i++}}(l,t,e);let v=!0;const y=new MutationObserver(((t,e)=>{if(!v||0===u.length)return;const n=$(h.find(".cds-selected-marker.active").first().closest("tr"));if(!n.length)return;u.scrollTop(0);const r=n.position(),i=d.position(),s=d.height();r&&i&&s&&u.animate({scrollTop:r.top-i.top-s},"250")}));h.find(".cds-selected-marker").each((function(){y.observe(this,{attributeFilter:["class"],attributes:!0})}));const b=$(`${l}-search`);b.off(`input.${a}-search`).on("input",(function(t){if(t.stopPropagation(),!(this instanceof HTMLInputElement))return;const n=this.value;$(`.${a}-matching-cell`).removeClass(`${a}-matching-cell`);const r=h.find(`.${a}-column-match`);if(0===n.length){let t=1;h.show(),h.find(`.${a}-row`).each((function(){o(this,t++,"")})),h.find(`.${a}-column-match`).hide(),g.hide(),f.prop("checked")&&(0,i.resetZoom)()}else!function(t,e,n){let r=0;const s=[];let l=!1;for(const i of e.getElementsByTagName("tbody")[0].querySelectorAll("tr")){const e=i.getAttribute("data-locus");if(!e){i.style.display="none";continue}const c={columns:[],functions:[]};for(const e of i.querySelectorAll("td.search-cell")){if(!t.test(e.innerText))continue;const n=e.getAttribute("data-type");n&&(e.classList.add(`${a}-matching-cell`),c.columns.push(n))}let u=n[e];void 0===u&&(u={functions:[]});for(const e of u.functions){let n="";t.test(e.name)&&(n=`${e.tool}: ${e.product}`),t.test(e.function)&&(n=`${e.tool}: ${e.function}`),t.test(e.description)&&(n=`${e.tool}: ${e.description}`),n&&-1===c.functions.indexOf(n)&&c.functions.push(n)}if(0===c.columns.length&&0===c.functions.length){i.style.display="none";continue}l=!0,s.push(e);const h=[];c.columns.length>0&&h.push("Indicated columns<br>"),c.functions.length>0&&h.push(`Gene functions:<ul><li>${c.functions.join("</li><li>")}</li></ul>`),o(i,++r,h.join(""))}return s.length>0?((0,i.clearSelectedOrfs)(),(0,i.selectOrfsByLoci)(s)):(0,i.clearSelectedOrfs)(),s.length>0}(new RegExp(n,"i"),h[0],e.orfs)?(r.hide(),h.hide(),g.show()):(r.show(),h.show(),g.hide()),f.prop("checked")&&(0,i.zoom_to_selection)()})).off("keyup").on("keyup",(t=>t.stopPropagation())),b[0]instanceof HTMLInputElement&&b[0].value.length>0&&b.trigger("input"),$(`${l} tbody tr`).off("click").on("click",(function(t){$(t.target).closest("td").hasClass(`${a}-cell-interactable`)||(v=!1,i.locusSelectionHandler.call(this,t),f.prop("checked")&&(0,i.zoom_to_selection)(),setTimeout((()=>{v=!0}),50))}));const x=$(l).find(".seq-copy");x.each((function(){const e=this.getAttribute("data-locus");if(void 0===e)return;const n=t.orfs.filter((t=>t.locus_tag===e))[0];this.classList.contains("seq-copy-aa")?this.setAttribute("data-seq",n.translation):this.classList.contains("seq-copy-nt")&&this.setAttribute("data-seq",n.dna)})),x.on("click",r.copyToClipboard),(0,s.replaceWildcards)(h[0],t)}},7082:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.redrawGenericDomains=e.drawGenericDomains=void 0;const r=n(9086),i=n(4677),s=n(2220),a=n(5003);let o;const l={text_height:14,unique_id:0,version:"0.0.1"};let c=null,u=25;const h="generic-domain";function d(t,e,n,r,i,s,a,o,c,u=!1){const d=(s+i)*n+4,g=t.append("g").attr("class","domain-group");g.append("text").text(e.id).attr("x",0).attr("y",d+.7*s).attr("class",`${h}-orflabel`).attr("data-locus",e.id),g.append("line").attr("y1",d+s/2).attr("y2",d+s/2).attr("x1",o(0)).attr("x2",o(e.seqLength)).attr("class",`${h}-line`),g.append("line").attr("x1",o(0)).attr("x2",o(0)).attr("y1",d+s/4).attr("y2",d+3*s/4).attr("class",`${h}-line`),g.append("line").attr("x1",o(e.seqLength)).attr("x2",o(e.seqLength)).attr("y1",d+s/4).attr("y2",d+3*s/4).attr("class",`${h}-line`),g.selectAll(`rect.${h}-domain`).data(e.domains).enter().append("rect").attr("x",(t=>o(t.start))).attr("y",d).attr("rx",17).attr("ry",17).attr("width",(t=>o(t.end)-o(t.start))).attr("height",s).attr("data-id",((t,e)=>`${c.name}-details-orf-${r}-${e}-tooltip`)).attr("class",(t=>`${h}-domain ${t.html_class?t.html_class:"generic-type-other"}`)).attr("stroke-width",(t=>t.go_terms&&t.go_terms.length>0?3:1)),g.selectAll(`text.${h}-text`).data(e.domains).enter().append("text").text((t=>{if(u)return t.name;const e=o(t.end)-o(t.start),n=(t.name.match(/[a-z]/g)||[]).length,r=(t.name.match(/[A-Z]/g)||[]).length;return e>16*r+18*(t.name.length-r-n)+8*n?t.name:"..."})).attr("x",(t=>o((t.start+t.end)/2))).attr("text-anchor","middle").attr("y",d+.7*s).attr("class",(t=>`${h}-text ${t.html_class}`)).attr("font-size",l.text_height).attr("font-weight","bold")}function g(t,e,n){c=e,u=n;for(const r of e)$(`.${t}-${r.name}-details`).off(".firstClick").one("click.firstClick",(()=>{f(`${t}-${r.name}-details-svg`,r,n)}))}function f(t,e,n){if($(`#${t}`).find(`svg.${h}-svg`).length>0)return;const o=$("input.domains-expand-full").prop("checked"),c=(0,i.select)(`#${t}`),u=n;let g=$(`#${t}`).width()||1200;const f=(u+10)*e.data.length,y=c.append("svg").attr("height",f).attr("width",g).attr("class",`${h}-svg`);let b=0,x="";for(const t of e.data)b=Math.max(b,t.seqLength||0),x.length<t.id.length&&(x=t.id);const w=y.append("g"),S=w.append("text").text(x).attr("x",0).attr("y",0).attr("id","dummy-label"),A=S.node().getComputedTextLength()||10*x.length;if(o){let t=0;S.attr("class",`${h}-text`);for(const n of e.data)for(const e of n.domains){S.text(e.name);const n=e.end-e.start,r=S.node().getComputedTextLength()/n;r>t&&(t=r)}const n=t*b;n>g&&(g=n),y.attr("width",g).attr("viewbox",`-1 -1 ${g} ${f}`)}w.remove();const C=(0,r.scaleLinear)().domain([1,1.02*b]).range([A+10,g]),M=c.append("div").attr("class",`${h}-svg-singles`),_=u+8;for(let t=0;t<e.data.length;t++){const n=e.data[t],r=l.unique_id++,i=(0,a.locusToFullId)(n.id),f=`${i}-generic-domains`;d(M.append("svg").attr("height",_).attr("width",o?g:"100%").attr("viewbox",`-1 -1 ${g} ${_}`).attr("class",`${h}-svg-single ${f}`),n,0,r,10,u,0,C,e,o),d(y,n,t,r,10,u,0,C,e,o),$(`#${i}-svgeneorf`)[0].classList.contains("svgene-selected-orf")||$(`.${f}`).hide();c.append("div").attr("id",`${e.name}-details-orf-${r}`).selectAll(`div.${h}-tooltip`).data(n.domains).enter().append("div").attr("class",`${h}-tooltip`).attr("id",((t,n)=>`${e.name}-details-orf-${r}-${n}-tooltip`)).html((t=>p(t,e.url))),$(`.${h}-tooltip .clipboard-copy`).off("click").click(s.copyToClipboard)}$(`.${h}-orflabel`).off("click").click((function(t){$(`#${(0,a.locusToFullId)($(this).attr("data-locus")||"none")}-svgeneorf`).trigger(t),(0,a.zoom_to_selection)()})),(0,i.selectAll)("g.domain-group").data(e.data),$(`.${h}-domain`).click(m),v()}function p(t,e){let n=`${t.name}<br>`;if(e.length>0){const r=`<a class='external-link' target='_blank' href="${e.replace("$ACCESSION",t.accession)}">${t.accession}</a>`;n=t.accession!==t.name?`${r} - ${t.name}<br>`:`${r}<br>`}if(n+=`Location: ${t.start}-${t.end} AA<br>`,n+=`Score: ${t.score}, E-Value: ${t.evalue}<br>`,n+=`${t.description}<br><br>`,t.go_terms&&t.go_terms.length>0){n+="Gene Ontologies:<br>";for(const e of t.go_terms)n+=`&nbsp;${e}<br>`;n+="<br>"}return n}function m(t){const e=$(this).attr("data-id");if(void 0===e)return;const n=$(`#${e}`);if(o&&(clearTimeout(n.data("timeout")),o.hide()),o=n,"none"!==n.css("display"))return void n.hide();let r=$(this).offset();void 0===r&&(r={left:0,top:0});let i=setTimeout((()=>n.slideUp("fast")),5e3);n.css("top",r.top+30).css("left",r.left+10).show().click((function(){$(this).hide()})).data("timeout",i).mouseover((()=>clearTimeout(n.data("timeout")))).mouseout((()=>{clearTimeout(n.data("timeout")),i=setTimeout((()=>n.slideUp("fast")),5e3),n.data("timeout",i)}))}function v(t){if(t&&t.reset){g(t.anchor,c,u);for(const e of c){const n=`${t.anchor}-${e.name}-details`;$(`#${`${n}-svg`}`).empty(),$(`.${n}`).hasClass("body-details-header-active")&&($(`.${n}`).off(".firstClick"),f(`${n}-svg`,e,u))}}$("input.domains-selected-only").prop("checked")?($(`.${h}-svg`).hide(),$(`.${h}-svg-singles`).show()):($(`.${h}-svg`).show(),$(`.${h}-svg-singles`).hide())}e.drawGenericDomains=g,e.redrawGenericDomains=v},6878:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createModuleHandlers=e.redrawDomains=e.drawDomains=void 0;const r=n(777),i=n(9086),s=n(4677),a=n(2220),o=n(5003),l=n(5130);let c;const u={text_height:14,unique_id:0,version:"0.0.1"};function h(t,e,n,i,s){const a=(0,r.path)(),o=e(t.start),l=e(t.end),c=n+i;return"head"===t.multi_cds?(a.moveTo(l+s,n),a.lineTo(l,n+i/3),a.lineTo(l+s,n+2*i/3),a.lineTo(l,c),a.lineTo(o+s,c),a.arcTo(o,c,o,n,s),a.lineTo(o,n+s),a.arcTo(o,n,l,n,s)):(a.moveTo(l-s,n),a.arcTo(l,n,l,c,s),a.lineTo(l,c-s),a.arcTo(l,c,o,c,s),a.lineTo(o-s,c),a.lineTo(o,n+2*i/3),a.lineTo(o-s,n+i/3),a.lineTo(o,n)),a.closePath(),a.toString()}function d(t,e,n,i,s,a,o,l){const c=(a+s)*n+4,d=t.append("g").attr("class","domain-group");d.append("text").text(e.id).attr("x",0).attr("y",c+.7*a).attr("class","jsdomain-orflabel").attr("data-locus",e.id),d.selectAll("rect.jsdomain-module").data(e.modules.filter((t=>!t.multi_cds))).enter().append("rect").attr("x",(t=>l(t.start))).attr("y",c-3).attr("width",(t=>l(t.end)-l(t.start))).attr("height",a+6).attr("rx",5).attr("class",(t=>t.complete?"jsdomain-module":"jsdomain-module jsdomain-incomplete-module")),d.selectAll("text.jsdomain-match").data(e.modules.filter((t=>t.multi_cds))).enter().append("text").text((t=>t.match_id)).attr("x",(t=>l("head"===t.multi_cds?t.end:t.start)+("head"===t.multi_cds?7:-5))).attr("y",(t=>c+("head"===t.multi_cds?2:4)*a/4-2)).attr("text-anchor","middle").attr("class","jsdomain-match"),d.selectAll("path.jsdomain-module").data(e.modules.filter((t=>t.multi_cds))).enter().append("path").attr("d",(t=>h(t,l,c-3,a+6,5))).attr("class","jsdomain-module"),d.append("line").attr("y1",c+a/2).attr("y2",c+a/2).attr("x1",l(0)).attr("x2",l(e.sequence.length)).attr("class","jsdomain-line"),d.append("line").attr("x1",l(0)).attr("x2",l(0)).attr("y1",c+a/4).attr("y2",c+3*a/4).attr("class","jsdomain-line"),d.append("line").attr("x1",l(e.sequence.length)).attr("x2",l(e.sequence.length)).attr("y1",c+a/4).attr("y2",c+3*a/4).attr("class","jsdomain-line"),d.selectAll("rect.jsdomain-domain").data(e.domains).enter().append("rect").attr("x",(t=>l(t.start))).attr("y",c).attr("rx",17).attr("ry",17).attr("width",(t=>l(t.end)-l(t.start))).attr("height",a).attr("data-id",((t,e)=>`details-orf-${i}-${e}-tooltip`)).attr("class",(t=>`jsdomain-domain ${t.html_class}`)).attr("stroke-width",1),d.selectAll("text.jsdomain-text").data(e.domains).enter().append("text").text((t=>t.abbreviation)).attr("x",(t=>l((t.start+t.end)/2))).attr("text-anchor","middle").attr("y",c+.7*a).attr("class","jsdomain-text").attr("font-size",u.text_height).attr("font-weight","bold");const g=d.selectAll("g.jsdomain-module-lid").data(e.modules.filter((t=>t.complete&&!t.multi_cds))).enter().append("g").attr("class","jsdomain-module-lid");g.append("rect").attr("x",(t=>l(t.start))).attr("y",c-3).attr("width",(t=>l(t.end)-l(t.start))).attr("height",a+6).attr("rx",5).attr("class","jsdomain-module-lid-body"),g.append("text").text((t=>t.monomer||"no prediction")).attr("x",(t=>l((t.start+t.end)/2))).attr("y",(t=>c+a*(t.iterative?.5:.7))).attr("text-anchor","middle").attr("class","jsdomain-text");const f=d.selectAll("g.jsdomain-module-lid-fragment").data(e.modules.filter((t=>t.multi_cds))).enter().append("g").attr("class","jsdomain-module-lid jsdomain-module-lid-fragment");f.append("path").attr("d",(t=>h(t,l,c-3,a+6,5))).attr("class","jsdomain-module-lid-body"),f.append("text").text((t=>t.monomer||"no prediction")).attr("x",(t=>l((t.start+t.end)/2))).attr("y",(t=>c+a*(t.iterative?.5:.7))).attr("text-anchor","middle").attr("class","jsdomain-text");const p=(0,r.path)();p.moveTo(50,50),p.arc(0,50,50,0,Math.PI/180*45,!0),p.moveTo(50,50),p.lineTo(10,40);const m=p.toString();g.append("path").attr("d",m).attr("stroke",(t=>t.iterative?"black":"none")).attr("stroke-width","5px").attr("fill","none").attr("stroke-linecap","round").attr("transform",(t=>`translate(${l((t.start+t.end)/2)}, ${c+.6*a}) scale(0.1, 0.1)`))}function g(t,e){var n;let r=`${t.type}<br>Location: ${t.start}-${t.end} AA<br>`;t.napdoslink.length>0&&(r+=`<a class="external-link" href="${t.napdoslink}" target="_blank">Analyze with NaPDoS</a><br>`),r+=`<a class="external-link" href="${t.blastlink}" target="_blank">Run BlastP on this domain</a><br>`;for(const e of null!==(n=t.extra_links)&&void 0!==n?n:[])r+=`${e}</br>`;if(t.predictions.length>0){r+="<dl><dt>Predictions:</dt>";for(const e of t.predictions)r+=`<dd>-${e[0]}: ${e[1]}</dd>`;r+="</dl>"}return r+=`AA sequence: ${(0,a.clipboardCopyConstruct)(t.sequence)}<br>`,t.dna_sequence&&(r+=`Nucleotide sequence: ${(0,a.clipboardCopyConstruct)(t.dna_sequence)}<br>`),r=(0,l.replaceWildcardsInText)(r,t),r}function f(t){const e=$(this).attr("data-id");if(void 0===e)return;const n=$(`#${e}`);if(c&&(clearTimeout(n.data("timeout")),c.hide()),c=n,"none"!==n.css("display"))return void n.hide();let r=$(this).offset();void 0===r&&(r={left:0,top:0});let i=setTimeout((()=>n.slideUp("fast")),5e3);n.css("top",r.top+30).css("left",r.left+10).show().click((function(){$(this).hide()})).data("timeout",i).mouseover((()=>clearTimeout(n.data("timeout")))).mouseout((()=>{clearTimeout(n.data("timeout")),i=setTimeout((()=>n.slideUp("fast")),5e3),n.data("timeout",i)}))}function p(t){if($(this).hide(),t.clientX&&t.clientY){const e=document.elementFromPoint(t.clientX,t.clientY);e&&$(e).click()}$(this).show()}function m(){$("input.domains-selected-only").prop("checked")?($(".jsdomain-svg").hide(),$(".jsdomain-svg-singles").show()):($(".jsdomain-svg").show(),$(".jsdomain-svg-singles").hide()),$("input.show-module-domains").prop("checked")?$(".jsdomain-module-lid").hide():$(".jsdomain-module-lid").show()}e.drawDomains=function(t,e,n){$(`.body-details-header.${t}-nrps_pks`).off(".firstClick").one("click.firstClick",(()=>{!function(t,e,n){const r=(0,s.select)(`#${t}`),l=n,c=10,h=$(`#${t}`).width()||700;r.selectAll("svg.jsdomain-svg").remove(),r.selectAll("svg.jsdomain-svg-single").remove();const v=(l+c)*e.orfs.length,y=r.append("svg").attr("height",v).attr("width","100%").attr("viewbox",`-1 -1 ${h} ${v}`).attr("class","jsdomain-svg");let b=0,x="";for(const t of e.orfs)b=Math.max(b,t.sequence.length),x.length<t.id.length&&(x=t.id);const w=y.append("g").append("text").text(x).attr("x",0).attr("y",0).attr("id","dummy-label"),S=w.node().getComputedTextLength()||15*x.length;w.remove();const A=(0,i.scaleLinear)().domain([1,1.02*b]).range([S+10,h]),C=r.append("div").attr("class","jsdomain-svg-singles"),M=l+.8*c;for(let t=0;t<e.orfs.length;t++){const n=e.orfs[t],i=u.unique_id++;d(C.append("svg").attr("height",M).attr("width","100%").attr("viewbox",`-1 -1 ${h} ${M}`).attr("class","jsdomain-svg-single").attr("id",`${(0,o.locusToFullId)(n.id)}-domains`),n,0,i,c,l,0,A),d(y,n,t,i,c,l,0,A);r.append("div").attr("id",`details-orf-${i}`).selectAll("div.jsdomain-tooltip").data(n.domains).enter().append("div").attr("class","jsdomain-tooltip").attr("id",((t,e)=>`details-orf-${i}-${e}-tooltip`)).html((t=>g(t,n))),$(".jsdomain-tooltip .clipboard-copy").off("click").click(a.copyToClipboard)}$(".jsdomain-orflabel").off("click").click((function(t){$(`#${(0,o.locusToFullId)($(this).attr("data-locus")||"none")}-svgeneorf`).trigger(t)})),(0,s.selectAll)("g.domain-group").data(e.orfs),$(".jsdomain-domain").click(f),$(".jsdomain-module-lid").click(p),$(".jsdomain-svg-single").hide(),$(".svgene-selected-orf").each((function(){const t=($(this).attr("id")||"invalid-id").replace("-svgeneorf","-domains");$(`#${t}`).show()})),m()}(`${t}-details-svg`,e,n)}))},e.redrawDomains=m,e.createModuleHandlers=function(){$("input.show-module-domains").change((function(){$("input.show-module-domains").prop("checked",$(this).prop("checked")),m()}))}},9681:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createRecordOverviews=void 0;const r=n(777),i=n(9086),s=n(4677),a=n(1029),o=n(3176),l=n(9813),c=n(6041),u=10;function h(t,e,n){if(0===e.length)return;const h=830,d=(0,s.select)(`#record-minimap-${t}`);d.attr("width",h).attr("height",40);const g=(0,i.scaleLinear)().domain([0,n]).range([20,810]);d.append("line").attr("x1",g(0)).attr("y1",20).attr("x2",g(n)).attr("y2",20).attr("class","centerline"),d.append("line").attr("x1",g(0)).attr("y1",0).attr("x2",g(0)).attr("y2",40).attr("class","minimap-record-end centerline"),d.append("line").attr("x1",g(n)).attr("y1",0).attr("x2",g(n)).attr("y2",40).attr("class","minimap-record-end centerline"),e.forEach((t=>{if(t.end>n){const e=d.append("defs").append("linearGradient").attr("id","cross-origin-region-gradient-fade").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","0%");e.append("stop").attr("offset","0%").style("stop-opacity",0),e.append("stop").attr("offset","50%").style("stop-opacity",.75),e.append("stop").attr("offset","100%").style("stop-opacity",1);const r=new a.CircularMarkerInfo(new l.Dimensions(40,h),g(n),15,t.cssClass);(0,a.addCircularMarkerGroup)(d,r,u,new o.Coordinates(0,0)).attr("class","right-circular-marker").style("transform",new c.Transform(1,1,0,15).toStyle()),(0,a.addCircularMarkerGroup)(d,r,u,new o.Coordinates(1,0)).attr("class","left-circular-marker").style("transform",new c.Transform(-1,1,-830,15).toStyle())}const e=d.append("g");e.append("rect").attr("class",`minimap-region ${t.cssClass}`).attr("y",15).attr("x",g(t.start)).attr("width",g(Math.min(t.end,n))-g(t.start)).attr("height",10).style("stroke",t.end>n?"none":"black");const i=parseInt(t.anchor.split("c")[1],10),s=i%2==0?25:15,f=i%2==0?30:10;e.append("line").attr("class","minimap-region-label-line centerline").attr("x1",g((t.start+Math.min(t.end,n))/2)).attr("y1",s).attr("x2",g((t.start+Math.min(t.end,n))/2)).attr("y2",f);const p=(parseInt(t.anchor.split("c")[1],10)%2==0?"2":"-1.2")+"em";if(e.append("text").attr("x",g(t.start+(Math.min(t.end,n)-t.start)/2)).attr("y",20).attr("font-size","xx-small").attr("class","minimap-region-label").attr("text-anchor","middle").attr("dy",p).text(t.anchor.split("c")[1]),t.end<=n)return;e.append("rect").attr("class",`minimap-region ${t.cssClass}`).attr("y",15).attr("x",g(0)).attr("width",g(t.end)-g(n)).attr("height",u).style("stroke","none"),e.append("path").attr("class",`minimap-region ${t.cssClass}`).style("fill","none").style("stroke","black").attr("d",(()=>{const e=(0,r.path)();return e.moveTo(g(0),15),e.lineTo(g(0)+g(t.end)-g(n),15),e.lineTo(g(0)+g(t.end)-g(n),25),e.lineTo(g(0),25),e.moveTo(g(n),15),e.lineTo(g(t.start),15),e.lineTo(g(t.start),25),e.lineTo(g(n),25),e.toString()}));const m=g(t.end%n/2);e.append("line").attr("class","minimap-region-label-line centerline").attr("x1",m).attr("y1",s).attr("x2",m).attr("y2",f),e.append("text").attr("x",m).attr("y",20).attr("font-size","xx-small").attr("class","minimap-region-label").attr("text-anchor","middle").attr("dy",p).text(t.anchor.split("c")[1])})),d.selectAll("text.minimap-region-label").data(e).enter().append("text").attr("x",(t=>g((t.start+t.end)/2))).attr("y",20).attr("font-size","xx-small").attr("class","minimap-region-label").attr("text-anchor","middle").attr("dy",(t=>(parseInt(t.anchor.split("c")[1],u)%2==0?"2":"-1.2")+"em")).text((t=>t.anchor.split("c")[1]))}e.createRecordOverviews=function(t){let e=0;for(const n of t)e+=1,0!==n.regions.length&&h(e,n.regions,n.length)}},2625:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.drawStructures=e.drawStructure=void 0;const i=r(n(4261));function s(){const t=this,e={experimentalSSSR:!0,height:200,padding:30,width:($(t).parent().width()||270)-20},n=$(t).parent(),r=$(t).is(":visible");r||(n.detach(t.id),$("body").append(t));const s=new i.default.Drawer(e);i.default.parse(t.getAttribute("data-smiles"),(e=>s.draw(e,t,"light",!1))),r||n.prepend(t),$(this).click((function(t){$(`#${$(this).attr("id")}-modal`).show();const e=$(`#${$(this).attr("id")}-modal`).children(".modal-content").children(".smiles-canvas-modal").first();if(void 0===e)return;const n={experimentalSSSR:!0,height:e.height()||500,padding:30,width:(e.width()||700)+80},r=e.parent().parent().hasClass("expanded");r||e.parent().css("display","block");const s=new i.default.Drawer(n),a=e[0];i.default.parse(a.getAttribute("data-smiles"),(t=>s.draw(t,a,"light",!1))),r||$(e).parent().removeAttr("style"),$(`#${$(this).attr("id")}-modal`).children(".modal-content").css("top",$(this).position().top-n.height/2+"px")}))}e.drawStructure=s,e.drawStructures=function(){$(".smiles-canvas").each(s),$(".modal-container").off("click").click((()=>$(".modal-container").hide()))}},7024:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.drawBindingSites=void 0;const r=n(4677),i=n(5003),s=4.5,a=2.25,o=40,l=74,c=40;function u(t,e,n,r,i){const s=i/2;t.append("line").attr("x1",e).attr("x2",n).attr("y1",r).attr("y2",r).attr("class","tfbs-arrow-base"),e>n&&(i*=-1),t.append("path").attr("d",`M ${n} ${r} L ${n-i} ${r+s} L ${n-i} ${r-s} z`).attr("class","tfbs-arrow-head")}e.drawBindingSites=function(t,e){if(!e)return;let n=0,h=0,d=0,g=0;for(const t of e)"weak"!==t.confidence?(t.left&&t.left.name.length>n&&(n=t.left.name.length),t.right&&t.right.name.length>h&&(h=t.right.name.length)):(t.left&&t.left.name.length>d&&(d=t.left.name.length),t.right&&t.right.name.length>g&&(g=t.right.name.length));const f=Math.max(100,12*Math.max(n,h)),p=f+c+9*(e[0].presequence.length+2),m=p+300;for(const n of e){const e=`tfbs-${t}-${n.start}-${n.name}`,i=$(`#${e}`);if($(i).children().length>0)continue;const h=300/n.sequence.length,d=9*n.presequence.length+s,g=9*n.postsequence.length+s,v=p-d-s,y=m+g+s,b=(0,r.select)(`#${e}`).append("svg").attr("width",y+c+f).attr("height",99).attr("id",e).attr("class","tfbs-svg");b.append("text").attr("x",v).attr("y",o).attr("textLength",d).attr("class","tfbs-sequence tfbs-hit-text-nearby").text(n.presequence);const x=b.append("g");b.append("text").attr("x",m+s).attr("y",o).attr("textLength",g).attr("class","tfbs-sequence tfbs-hit-text-nearby").text(n.postsequence);const w=b.append("g"),S=b.append("g");for(let t=0;t<n.target.length;t++){const e=p+t*h+h/4;x.append("text").attr("x",e).attr("y",o).attr("class","tfbs-sequence").text(n.sequence[t]),w.append("text").attr("x",e).attr("y",58).attr("class","tfbs-sequence tfbs-hit-text-nearby").text(n.matches[t]?"|":" "),S.append("text").attr("x",e).attr("y",l).attr("class","tfbs-sequence "+("N"===n.target[t]?"tfbs-hit-text-nearby":"")).text(n.target[t])}const A=b.append("g").attr("class","tfbs-boundary");A.append("text").text(n.start.toLocaleString()).attr("text-anchor","middle").attr("x",p-a).attr("y",20).attr("class","tfbs-coordinate"),A.append("line").attr("x1",p-a).attr("x2",p-a).attr("y1",25).attr("y2",79).attr("class","tfbs-line"),A.append("text").text(n.end.toLocaleString()).attr("text-anchor","middle").attr("x",m+a).attr("y",20).attr("class","tfbs-coordinate"),A.append("line").attr("x1",m+a).attr("x2",m+a).attr("y1",25).attr("y2",79).attr("class","tfbs-line");const C=(t,e,n=0)=>{const r=b.append("g").attr("class","tfbs-nearby");for(let n=0;n<3;n++)r.append("circle").attr("cx",t+(5+10*n)*e).attr("cy",34).attr("r",2).attr("class","tfbs-ellipsis");if(!(n<=0)){for(let n=-1;n<2;n+=2)u(r,t+15*e,t+15*e+30*n,l,8);r.append("text").text(n.toLocaleString()).attr("x",t+15*e).attr("y",66).attr("text-anchor","middle").attr("class","tfbs-hit-text-nearby")}},M=(t,e,n,r,i,s,a)=>{let l=.05*f;i<0&&(l*=-1);let c="";c=r?`M ${n},45\n                        L ${n+i},45\n                        L ${n+i},25\n                        L ${n},25`:`M ${n},45\n                        L ${n+i-l},45\n                        L ${n+i},35\n                        L ${n+i-l},25\n                        L ${n},25`;const u=t.append("g").attr("class","tfbs-gene");u.append("text").attr("x",a).attr("y",o).text(e.name).attr("text-anchor",s).attr("class","serif tfbs-gene-label").attr("data-locus",e.name),u.append("path").attr("class","tfbs-line").attr("d",c).attr("fill","none")};if(n.left&&n.contained_by_left&&n.right)M(b,n.left,v-c,1===n.left.strand,-f,"start",v-c-.9*f),C(v,-1,n.start-n.left.location),M(b,n.right,y+c,-1===n.left.strand,f,"end",y+c+.9*f),C(y,1,n.right.location-n.start+n.sequence.length);else{if(n.left){const t=n.start-n.left.location,e=v-f-c;let r=f;if(t<=0){r=p-(t+.2)*h-e}M(b,n.left,e,-1===n.left.strand,r,"end",v-c-.1*f),C(v,-1,t)}if(n.mid){const t=p+(n.mid.location-n.start)*h,e=t+(n.mid.length||0)*h,r=.05*(e-t);let i="";i=-1!==n.mid.strand?`M ${t},45\n                            L ${e-r},45\n                            L ${e},35\n                            L ${e-r},25\n                            L ${t},25\n                            Z`:`M ${e},45\n                            L ${t+r},45\n                            L ${t},35\n                            L ${t+r},25\n                            L ${e},25\n                            Z`;b.append("g").attr("class","tfbs-gene").append("path").attr("class","tfbs-line").attr("d",i).attr("fill","none")}if(n.right){const t=y+f+c;let e=-f;if(n.right.location<n.end){e=m+(n.right.location-n.end)*h-t}M(b,n.right,t,1===n.right.strand,e,"start",y+c+.1*f),C(y,1,n.right.location-n.end)}}const _=(y-v)/3,T=v+_,k=y-_,N=b.append("g").attr("class","tfbs-line tfbs-strand");-1!==n.strand?u(N,T,k,89,10):u(N,k,T,89,10)}$(".tfbs-gene-label").off("click").on("click",(function(){const t=this.getAttribute("data-locus");t&&(0,i.selectOrfsByLoci)([t])}))}},5003:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.resetZoom=e.resetView=e.zoom_to_selection=e.locusSelectionHandler=e.tag_to_id=e.drawRegion=e.clearSelectedOrfs=e.locusToFullId=e.selectOrfsByLoci=void 0;const i=n(6216),s=n(5305),a=n(777),o=n(9086),l=n(4677);n(2473);const c=n(8111),u=n(1029),h=n(3176),d=n(9813),g=n(3446),f=n(6041),p=n(2220),m=n(9026),v=n(5130);let y=100;const b=14,x="cluster-bar-group",w="svgeneorf-group",S="svgene-selected-orf";class A{constructor(t,e,n,r,i){this.sourceData=t,this.scale=e,this.axis=n,this.wrapPoint=r,this.y=i}}function C(t,e=!1){if(!Q)return;if(t.length<1)return;let n=`#${M(t[0])}-${w}`,r=$(n),i=(0,l.selectAll)(n),s=i.datum();r=r.add($(`#${M(s.locusTag)}`)),void 0!==s.otherSide&&(r=r.add($(`#${M(s.otherSide.locusTag)}-${w}`)));for(const e of t.slice(1))n=`#${M(e)}-${w}`,r=r.add(n),i=(0,l.selectAll)(n),s=i.datum(),void 0!==s.otherSide&&(r=r.add(`#${M(s.otherSide.locusTag)}-${w}`));e?L(r):D(r,t.length>1)}function M(t){return Q?`u${tt-1}-region${Q.idx}-${R(t)}`:`${R(t)}`}function _(t,e){const n=K+b+G,r=K+b+y-G,i=K+b+y/2;let s="";if(1===t.strand){const o=J(t.start),l=Math.max(J(t.end)-2*G,o),c=J(t.end);if(e){const t=(0,a.path)();t.moveTo(o,n),t.lineTo(l,n),t.lineTo(c,i),t.lineTo(l,r),t.lineTo(o,r),s=t.toString()}else s=`${o},${n} ${l},${n} ${c},${i} ${l},${r} ${o},${r}`}else if(-1===t.strand){const o=J(t.start),l=J(t.end),c=Math.min(J(t.start)+2*G,l);if(e){const e=(0,a.path)();t.isSplit()?(e.moveTo(l,n),e.lineTo(c,n),e.lineTo(o,i),e.lineTo(c,r),e.lineTo(l,r)):(e.moveTo(o,i),e.lineTo(c,n),e.lineTo(l,n),e.lineTo(l,r),e.lineTo(c,r)),s=e.toString()}else s=`${o},${i} ${c},${n} ${l},${n} ${l},${r} ${c},${r}`}else{const i=J(t.start),o=J(t.end);if(e){const t=(0,a.path)();t.moveTo(i,n),t.lineTo(o,n),t.lineTo(o,r),t.lineTo(i,r),s=t.toString()}else s=`${i},${n} ${o},${n} ${o},${r} ${i},${r}`}return e&&!t.isSplit()&&(s+="Z"),s}function T(t,e,n,r){const i=n+b+e,s=n+2*b+e-r,a=Math.floor(J((t.start+t.end)/2));return`${a},${i} ${a-5},${s} ${a+5},${s}`}function k(t,e,n){return Math.max(t,Math.min(e,n))}function N(t,e){return"biosynthetic"!==t.type&&"biosynthetic"!==e.type||"biosynthetic"===t.type&&"biosynthetic"===e.type?t.start-e.start:"biosynthetic"===t.type?1:-1}function R(t){return t.replace(/(:|\.)/g,"-").replace(/-svgeneorf/g,"_orf")}function L(t){t[0].classList.contains(S)?(j(t),0===$(`.${w}.${S}`).length&&(F(),H())):(0===$(`.${w}.${S}`).length&&j(),F(t)),B(t,"cds")}function E(t){$(".legend-selected").removeClass("legend-selected"),t.ctrlKey||t.metaKey?L($(this)):D($(this))}function P(t){return r(this,void 0,void 0,(function*(){try{const t=yield fetch("https://antismash-db.secondarymetabolites.org/api/jobs/clusterblast",{body:JSON.stringify({name:$(this).attr("data-locus"),sequence:$(this).attr("data-seq")}),headers:{"Content-Type":"application/json"},method:"POST",mode:"cors"}),e=yield t.json();window.open("https://antismash-db.secondarymetabolites.org/job/"+e.id,"_blank")}catch(t){alert("The antiSMASH database is not currently accessible: "+t)}}))}function D(t,e=!1){if(!Q)return;const n=(0,l.selectAll)(t.toArray()),r=n.datum();if(!e){const t=$(`.focus-panel-content-${Q.anchor}`);t.html(r.description).find(".collapser").click(m.toggleCollapserHandler),(0,v.replaceWildcards)(t[0],Q),$(".clipboard-copy",t).off("click").click(p.copyToClipboard),$(".asdb-linkout",t).off("click").click(P)}n.classed(S)&&1===$(`.svgene-orf.${S}`).length?F():(j(),F(t),r.otherSide&&F($(`#${M(r.otherSide.locusTag)}-${w}`))),B(t,"cds")}function I(t){(0,m.toggleCollapser)($(".collapser-level-candidate.expanded"));const e=t.product.split(":")[0].split(" ")[1];(0,m.toggleCollapser)($(`.collapser-level-candidate.collapser-target-CC${e}`))}function B(t,e){const n=(0,l.selectAll)(t.toArray()).datum();(0,m.toggleCollapser)($(`.collapser-target-${R(n.getLocus())}.collapser-level-${e}`))}function O(t,e){$(".legend-selected").removeClass("legend-selected"),$(`.${w}`).each((function(n){const r=(0,l.selectAll)($(this).toArray()).datum();t<=r.start&&r.end<=e&&(F($(this)),B($(this),"candidate"),B($(this),"protocluster"))}))}function z(t,e){const n=e?"1":"0.5",r=Q&&t.length/2===Q.orfs.length;r&&H();const i=(0,l.selectAll)(t.toArray());i.classed(S,e),i.selectAll(".svgene-orf").classed(S,e).attr("opacity",n),i.selectAll(".circular-marker").attr("opacity",n),i.selectAll(".circular-border").style("stroke-width",e?"1px":"0").style("stroke",e?"black":"none"),i.selectAll(".svgene-orf-border").style("stroke-width",e?"1px":"0").style("stroke",e?"black":"none"),i.each((t=>{(0,l.selectAll)(`#svgene-minimap-orf-${R(t.locusTag)}`).attr("opacity",n).classed(S,e);const i=M(t.locusTag);e?($(`#${i}-domains`).show(),$(`.${i}-generic-domains`).show()):($(`#${i}-domains`).hide(),$(`.${i}-generic-domains`).hide()),r||function(t,e,n=!1){if(!t)return;n&&(t=function(t){return t.split(/-/)[2]}(t));e?$(`.cds-selected-marker-${t}`).addClass("active"):$(`.cds-selected-marker-${t}`).removeClass("active")}(t.locusTag,e)}))}function H(){$(".cds-selected-marker").removeClass("active")}function F(t){void 0===t&&(t=$(`.${w}, .svgene-minimap-orf`)),z(t,!0)}function j(t){void 0===t&&(t=$(`.${w}.${S}`)),z(t,!1)}function q(t){const e=$(this).attr("data-id");if(void 0===e)return;let n=".contains-tta-codon";if(n="legend-tta-codon"===e?".contains-tta-codon":"legend-resistance"===e?".svgene-resistance-orf":`.${e.replace("legend-","svgene-")}`,n+="-group",$(this).hasClass("legend-selected"))return $(this).removeClass("legend-selected"),j($(n)),void(0===$(".legend-selected").length&&F());(t.ctrlKey||t.metaKey)&&0!==$(".legend-selected").length||($(".legend-selected").removeClass("legend-selected"),j()),$(this).addClass("legend-selected"),F($(n))}function U(t){if(!Q)return;let e=-1,n=-1;$(`.${S}`).each((function(t){const r=(0,l.selectAll)($(this).toArray()).datum();e=-1===e?Math.min(r.start,r.end):Math.min(e,r.start,r.end),n=-1===n?Math.max(r.start,r.end):Math.max(n,r.start,r.end)})),-1!==e&&-1!==n&&V(Math.max(Q.start,e-3e3),Math.min(n+3e3,Q.end))}function V(t,e,n){if(null===Q)return;let r=0;void 0===n&&(n=!1,r=500),t-=1,e+=1,J.domain([t,e]);const i=t+(e-t)/2,s=(0,l.selectAll)(".svgene-orf,.svgene-orf-bg");s.transition().duration(r).attr("points",(t=>_(t)));(0,l.selectAll)(".svgene-orf-border").transition().duration(r).attr("d",(t=>_(t,!0)));(0,l.selectAll)(".svgene-locustag *").transition().duration(r).attr("x",(t=>t.start<i?J(t.start):J(t.end))).attr("text-anchor",(t=>t.start<i?"start":"end"));(0,l.selectAll)(".cluster-background").transition().duration(r).attr("width",(t=>J(t.neighbouringEnd)-J(t.neighbouringStart)-t.getWidthOffset())).attr("x",(t=>J(t.neighbouringStart)+t.getWidthOffset()));(0,l.selectAll)(".cluster-core").transition().duration(r).attr("width",(t=>J(t.end)-J(t.start)-t.getWidthOffset())).attr("x",(t=>J(t.start)+t.getWidthOffset()));(0,l.selectAll)(".cluster-line").transition().duration(r).attr("x1",(t=>J(t.neighbouringStart)+t.getWidthOffset())).attr("x2",(t=>J(t.neighbouringEnd)));s.selectAll(".left-circular-marker").transition().duration(r).style("transform",(t=>new f.Transform(t.transform.scale.x,t.transform.scale.y,-(t instanceof c.Area?J(t.neighbouringStart):J(t.start))-13,t.transform.translate.y).toStyle()));s.selectAll(".right-circular-marker").transition().duration(r).style("transform",(t=>new f.Transform(t.transform.scale.x,t.transform.scale.y,t instanceof c.Area?Math.max(0,J(t.neighbouringEnd)-J(e))-1:J(t.end)-J(e),t.transform.translate.y).toStyle()));(0,l.selectAll)(".clusterlabel").transition().duration(r).attr("x",(n=>J((Math.max(n.start,t+1)+Math.min(n.end,e-1))/2)));(0,l.selectAll)(".svgene-resistance").filter((t=>t&&!0===t.resistance)).transition().duration(r).attr("x",(t=>J(t.start))).attr("width",(t=>J(t.end)-J(t.start)));(0,l.selectAll)(".svgene-tta-codon").filter((t=>void 0!==t)).transition().duration(r).attr("points",(t=>T(t,y,K,G)));let a=(0,l.selectAll)(".svgene-binding-site");a=a.filter((t=>void 0!==t)).each((function(t){const e=J(t.loc+t.len/2);(0,l.select)(this).selectAll("line").transition().duration(r).attr("x1",e).attr("x2",e),(0,l.select)(this).selectAll("circle").transition().duration(r).attr("cx",e)}));if((0,l.selectAll)(".svgene-source-marker").transition().duration(r).attr("x",(t=>J(t.recordEnd))),X.length<2)null!==Y&&(0,l.select)(".svgene-axis").transition().duration(r).call(Y);else{for(const t of X)t.scale.range([J(t.sourceData.recordStart),J(t.sourceData.recordEnd)]);(0,l.selectAll)(".svgene-subaxis").each((function(t){(0,l.select)(this).transition().duration(r).call(t.axis)}))}if(!n){0===$(`.${S}`).length&&F();const n=Z(t),i=Z(e);(0,l.select)(`#svgene-minimap-grabber-a-${Q.anchor}`).transition().duration(r).attr("x",n),(0,l.select)(`#svgene-minimap-grabber-b-${Q.anchor}`).transition().duration(r).attr("x",i),(0,l.select)(`#svgene-minimap-window-${Q.anchor}`).transition().duration(r).attr("x",n).attr("width",i-n)}}function W(){null!==Q&&($(".legend-selected").removeClass("legend-selected"),F(),V(Q.start,Q.end),(0,m.toggleCollapser)($(".collapser-level-cds.expanded")))}e.selectOrfsByLoci=C,e.locusToFullId=M,e.clearSelectedOrfs=function(){F()},e.drawRegion=function(t,e,n,r,a){var p;Q&&((0,l.select)(`#${Q.anchor}-svg`).selectAll("*").remove(),$(".legend-selected").removeClass("legend-selected")),Q=e;const m=e;if(null===Q)return;void 0===r&&(r=m.start),void 0===a&&(a=m.end);let v=!1;for(const t of m.orfs)if(t.resistance){v=!0;break}const C=m.orfs.sort(N).map((t=>new g.Orf(t))),M=(null!==(p=m.clusters)&&void 0!==p?p:[]).map((t=>c.Area.fromInterface(t))),L=m.sites,P=function(t){var e;const n=new Map;for(const r of t)if(r.group){const t=null!==(e=n.get(r.group))&&void 0!==e?e:[];t.push(r),n.set(r.group,t)}for(const t of n.values())t[0].otherSide=t[1],t[1].otherSide=t[0];return n.size>0}(C),D=function(t){var e;const n=new Map;for(const r of t)if(r.group){const t=null!==(e=n.get(r.group))&&void 0!==e?e:[];t.push(r),n.set(r.group,t)}for(const t of n.values())t[0].otherSide=t[1],t[1].otherSide=t[0];return n.size>0}(M),B=P||D,z=12*Math.max.apply(Math,m.clusters.map((t=>t.height))),H=v||m.sites.ttaCodons.length>0?Math.floor(2*n/3):0;let F=null,et=!1;if(m.sources)for(const t of m.sources)if(t.name)if(F){if(F!==t.name){et=!0;break}}else F=t.name;const nt=et?20:0,rt=n+2*b+z+40+20+H+nt,it=(m.idx,(0,l.select)(`#${t}`)),st=$(`#${t}`).parent().width()||700;it.selectAll("svg").remove(),it.selectAll("div").remove();const at=B?10:0,ot=it.append("svg").attr("height",rt).attr("width","100%").attr("viewbox",`-1 0 ${st} ${rt}`);if(B){const t=ot.append("defs").append("linearGradient").attr("id","cross-origin-region-gradient-fade").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","0%");t.append("stop").attr("offset","0%").style("stop-opacity",0),t.append("stop").attr("offset","50%").style("stop-opacity",.75),t.append("stop").attr("offset","100%").style("stop-opacity",1)}const lt=tt++;G=n/10,J=(0,o.scaleLinear)().domain([r,a]).range([2+at,st-2-at]),function(t,e,n,r,i,s,a,o,c,g,p){if(null===Q)return;const m=Q.idx;K=12*Math.max.apply(Math,n.map((t=>t.height)))+b,y=p;const v=K+b+p/2;t.append("line").attr("x1",J(Q.start)).attr("y1",v).attr("x2",J(Q.end)).attr("y2",v).attr("class","centerline");const A=p/2,C=p/10,M=t.selectAll(`g.${x}`).data(n).enter().append("g").attr("class",(t=>`${x} ${t.css}`)).on("click",(t=>{$(`.${S}`).length!==e.length&&(l.event.ctrlKey||l.event.metaKey)||j(),O(t.neighbouringStart,t.neighbouringEnd),I(t),void 0!==t.otherSide&&O(t.otherSide.neighbouringStart,t.otherSide.neighbouringEnd)})).on("dblclick",(t=>{O(t.neighbouringStart,t.neighbouringEnd),I(t),void 0!==t.otherSide?(O(t.otherSide.neighbouringStart,t.otherSide.neighbouringEnd),null!==Q&&V(Q.start,Q.end)):V(t.neighbouringStart,t.neighbouringEnd)}));if(M.filter((t=>"protocluster"===t.kind)).append("rect").attr("width",(t=>J(t.neighbouringEnd)-J(t.neighbouringStart)-(t.splitsInNeighbourhood()&&0===t.neighbouringStart?1:0))).attr("height",A).attr("x",(t=>J(t.neighbouringStart)+(t.splitsInNeighbourhood()&&0===t.neighbouringStart?1:0))).attr("y",(t=>t.height*(A+C)+o)).attr("opacity","0.5").attr("class",(t=>`cluster-background ${t.product} ${t.category}`)).style("stroke-width","0"),M.filter((t=>"protocluster"===t.kind)).append("line").attr("x1",(t=>J(t.neighbouringStart)+t.getWidthOffset())).attr("y1",(t=>t.height*(A+C)+o+A/2)).attr("x2",(t=>J(t.neighbouringEnd))).attr("y2",(t=>t.height*(A+C)+o+A/2)).attr("class","cluster-line"),M.filter((t=>"protocluster"!==t.kind||t.containsCore())).append("rect").attr("width",(t=>J(t.end)-J(t.start)-t.getWidthOffset())).attr("height",A).attr("x",(t=>J(t.start))).attr("y",(t=>t.height*(A+C)+o)).attr("class",(t=>"subregion"===t.kind?t.prefix?"cluster-core":`cluster-core svgene-border-${t.tool}`:`cluster-core ${t.product} ${t.category}`)).style("stroke","black"),n.some((t=>void 0!==t.otherSide))){const t=new d.Dimensions(a,s);M.filter((t=>void 0!==t.otherSide)).each((function(e){const n=e.height*(A+C)+o;let r=e.product,i=e.category;void 0!==e.otherSide&&(""===r&&(r=e.otherSide.product),""===i&&(i=e.otherSide.category));const s=new u.CircularMarkerInfo(t,0,n,`${r} ${i}`),a=new h.Coordinates(1,0);let c=`left-circular-marker cluster-core ${r} ${i}`;e.transform=new f.Transform(1,1,-1,n),e.splitsInNeighbourhood()?0===e.neighbouringStart?(s.barEnd=J(e.neighbouringStart),e.transform.scale.x=-1,e.transform.translate.x=-2*J(e.neighbouringStart)-1):(c=c.replace(/left/gi,"right"),s.barEnd=J(e.neighbouringEnd)+1):0===e.neighbouringStart?(s.barEnd=J(e.neighbouringStart),e.transform.scale.x=-1,e.transform.translate.x=-2*J(e.neighbouringStart)-1):(c=c.replace(/left/gi,"right"),s.barEnd=J(e.neighbouringEnd));const d=(0,u.addCircularMarkerGroup)((0,l.select)(this),s,A,a,e.splitsInNeighbourhood()).style("transform",e.transform.toStyle()).attr("class",`${(0,l.select)(this).attr("class")} ${c}`);e.splitsInNeighbourhood()&&d.attr("opacity",.5)}))}M.append("text").attr("x",(t=>J((t.start+t.end)/2))).attr("y",(t=>"protocluster"===t.kind?(t.height-1)*(A+C)-C+A+o:t.height*(A+C)-C+A+o)).style("font-size","xx-small").attr("class","clusterlabel").attr("text-anchor","middle").style("pointer-events","none").text((t=>t.prefix+t.product.replace("_"," ")));const k=v-p/2-4.5,N=t.selectAll("g.svgene-binding-site").data(r.bindingSites).enter().append("g").attr("class","svgene-binding-site");N.append("line").attr("x1",(t=>J(t.loc+t.len/2))).attr("x2",(t=>J(t.loc+t.len/2))).attr("y1",v).attr("y2",k),N.append("circle").attr("cx",(t=>J(t.loc+t.len/2))).attr("cy",k).attr("r",3);const L=t.selectAll(`g.${w}`).data(e).enter().append("g").attr("class",(t=>`${w} ${S} svgene-type-${t.type}-group`)).attr("id",(t=>`u${i}-region${m}-${R(t.locusTag)}-${w}`));L.append("polygon").attr("points",(t=>_(t))).attr("class","svgene-orf-bg").attr("id",(t=>`u${i}-region${m}-${R(t.locusTag)}-svgeneorf-bg`)).style("fill","white"),L.append("polygon").attr("points",(t=>_(t))).attr("class",(t=>`svgene-type-${t.type} svgene-orf ${S}`)).attr("id",(t=>`u${i}-region${m}-${R(t.locusTag)}-svgeneorf`)).style("stroke","none").style("stroke-width","0").attr("opacity","1"),L.append("path").attr("d",(t=>_(t,!0))).attr("class",(t=>`svgene-type-${t.type} svgene-orf-border ${S}-border`)).attr("opacity","1"),L.filter((t=>t.isSplit())).each((function(t){const e=new d.Dimensions(a,s),n=K+b+G,r=K+b+y-G-n,i=new u.CircularMarkerInfo(e,0,n,t.type),o=new h.Coordinates(1,2);let c=`circular-marker circular-marker-${t.getLocus()} left-circular-marker svgene-type-${t.type}`;t.transform=new f.Transform(1,1,0,n),t.start<=1?(i.barEnd=J(t.start),t.transform.scale.x=-1,t.transform.translate.x=-2*J(t.start)):(c=c.replace(/left/gi,"right"),i.barEnd=J(t.end)),(0,u.addCircularMarkerGroup)((0,l.select)(this),i,r,o).style("transform",t.transform.toStyle()).attr("class",`${(0,l.select)(this).attr("class")} ${c}`)}));const E=K+b+p+2;t.selectAll("rect.svgene-resist").data(e.filter((t=>t.resistance))).enter().append("rect").attr("class","svgene-resistance").attr("width",(t=>J(t.end)-J(t.start))).attr("height",7).attr("x",(t=>J(t.start))).attr("y",E);for(const t of e.filter((t=>t.resistance))){const e=`#u${i}-region${m}-${R(t.locusTag)}-svgeneorf`;(0,l.select)(e).classed("svgene-resistance-orf",!0)}t.selectAll("polyline.svgene-tta-codon").data(r.ttaCodons).enter().append("polyline").attr("points",(t=>T(t,p,K,o))).attr("class","svgene-tta-codon");const P=t.selectAll("text.svgene-locustag").data(e).enter().append("g").attr("class","svgene-locustag").attr("id",(t=>`u${i}-region${m}-${R(t.locusTag)}-label`));P.append("rect").attr("x",(t=>J(t.start)<a/2?J(t.start):J(t.end)-10*t.getLocus().length)).attr("y",K).attr("width",(t=>10*t.getLocus().length)).attr("height",b).attr("class","svgene-locustag-background"),P.append("text").attr("x",(t=>J(t.start)<a/2?J(t.start):J(t.end))).attr("text-anchor",(t=>J(t.start)<a/2?"start":"end")).attr("y",K+b).text((t=>t.getLocus()));for(const t of r.ttaCodons)for(const e of t.containedBy){const t=`#u${i}-region${m}-${R(e)}-${w}`;(0,l.select)(t).classed("contains-tta-codon",!0)}}(ot,C,M,L,lt,rt,st,G,0,0,n),void 0!==m.label&&ot.append("text").text(m.label).attr("class","svgene-regionlabel").attr("x",(function(){const t=this.getComputedTextLength();return st-t-5})).attr("y",b).attr("font-size",b),Y=(0,i.axisBottom)(J),m.sources?function(t,e,n,r,s,a,l,c){t.selectAll("rect.svgene-source-marker").data(e.slice(0,-1)).enter().append("rect").attr("width",((t,n)=>Math.max(1,J(e[n+1].recordStart)-J(t.recordEnd)))).attr("height",a-r).attr("x",(t=>J(t.recordEnd))).attr("y",0).attr("class","svgene-source-marker");let u=0;for(const t of e)u+=t.recordEnd-t.recordStart;X.length=0;let h=0;for(const n of e){const s=0===h?n.recordEnd+1:e[h-1].recordEnd;h+=1;const l=(0,o.scaleLinear)().domain([n.recordStart%s,n.recordEnd%s]).range([J(n.recordStart),J(n.recordEnd)]),c=(0,i.axisBottom)(l),d=(n.recordEnd-n.recordStart)/u,g=Math.max(2,2*Math.floor(10*d));l.ticks(g),c.ticks(g),X.push(new A(n,l,c,s,(a-r)/.8)),t.selectAll("g.svgene-subaxis").data(X).enter().append("g").attr("class","svgene-subaxis").attr("transform",`translate(0,${a-r/.8})`).call(c)}}(ot,m.sources,0,.8*nt,0,rt-40-20):ot.append("g").attr("class","svgene-axis").attr("transform",`translate(0,${rt-40-20-nt})`).call(Y),function(t,e,n,r,i,a,c){if(!Q)return;Z=(0,o.scaleLinear)().domain([e,n]).range([Math.floor(.25*c),Math.floor(.75*c)]).nice();const u=i/4;t.append("g").attr("class","svgene-minimap"),t.append("line").attr("x1",Z(e)).attr("y1",r).attr("x2",Z(n)).attr("y2",r).attr("class","centerline");t.selectAll("rect.svgene-minimap-orf").data(a).enter().append("rect").attr("width",(t=>Z(t.end)-Z(t.start))).attr("height",u).attr("x",(t=>Z(t.start))).attr("y",r-u/2).attr("class",(t=>`svgene-type-${t.type} ${S} svgene-minimap-orf`)).attr("id",(t=>`svgene-minimap-orf-${R(t.locusTag)}`));const h=Z(e),d=Z(n),g=Z(Math.min(n,e+1e3)),f=Z(Math.max(e,n-1e3));t.append("rect").attr("x",Z(e)).attr("y",r-i/2).attr("width",Z(n)-Z(e)).attr("height",i).style("cursor","grab").attr("id",`svgene-minimap-window-${Q.anchor}`).attr("opacity","0.2").style("fill","blue").call((0,s.drag)().on("drag",(function(){if(null===Q)return;Math.max(0,l.event.x-parseInt((0,l.select)(this).attr("x"),10));let t=parseInt((0,l.select)(this).attr("width"),10);const e=parseInt((0,l.select)(this).attr("x"),10)+l.event.dx;let n=k(h,e,f);e<h?t=Math.max(g-h,t-(h-e)):e+t>d&&(n=Math.min(e,f),t=d-n),n=k(h,n,f);const r=Math.max(g,n+t);(0,l.select)(this).attr("x",n).attr("width",t),(0,l.select)(`#svgene-minimap-grabber-a-${Q.anchor}`).attr("x",n),(0,l.select)(`#svgene-minimap-grabber-b-${Q.anchor}`).attr("x",r),V(Z.invert(n),Z.invert(r),!0)}))),t.append("rect").attr("x",Z(e)).attr("y",r-i/2).attr("id",`svgene-minimap-grabber-a-${Q.anchor}`).attr("width",2).attr("height",i).style("cursor","ew-resize").call((0,s.drag)().on("drag",(function(t,e){if(!Q)return;const n=parseInt((0,l.select)(`#svgene-minimap-grabber-b-${Q.anchor}`).attr("x"),10),r=Math.min(Z(Z.invert(n)-1e3),d,Math.max(l.event.x,h));(0,l.select)(this).transition().duration(10).attr("x",r),(0,l.select)(`#svgene-minimap-window-${Q.anchor}`).transition().duration(10).attr("x",r).attr("width",n-r),V(Z.invert(r),Z.invert(n),!0)}))),t.append("rect").attr("x",Z(n)).attr("y",r-i/2).attr("id",`svgene-minimap-grabber-b-${Q.anchor}`).attr("width",2).attr("height",i).style("cursor","ew-resize").call((0,s.drag)().on("drag",(function(t,e){if(!Q)return;const n=parseInt((0,l.select)(`#svgene-minimap-grabber-a-${Q.anchor}`).attr("x"),10),r=Math.max(Z(Z.invert(n)+1e3),g,Math.min(l.event.x,d));(0,l.select)(this).transition().duration(10).attr("x",r),(0,l.select)(`#svgene-minimap-window-${Q.anchor}`).transition().duration(10).attr("width",r-n),V(Z.invert(n),Z.invert(r),!0)})))}(ot,m.start,m.end,rt-20,40,C,st),$(`.${w}`).mouseover((function(t){let e=$(this).attr("id");void 0!==e&&(e=e.replace(`-${w}`,"-label"),$("#"+e).show())})).mouseout((function(t){let e=$(this).attr("id");void 0!==e&&(e=e.replace(`-${w}`,"-label"),$("#"+e).hide())})).click(E),$(".svgene-textarea").click((t=>t.stopPropagation())),$(".legend-selector").unbind("click").click(q),$(".zoom-in").unbind("click").click(U),$(".zoom-reset").unbind("click").click((()=>W())),1===tt&&$(document).keyup((t=>{const e=t.keyCode;82===e?W():90===e&&U(t)}))},e.tag_to_id=R,e.locusSelectionHandler=function(t){const e=this.getAttribute("data-locus");e&&C([e],t.ctrlKey||t.metaKey)},e.zoom_to_selection=U,e.resetView=W,e.resetZoom=function(){null!==Q&&V(Q.start,Q.end)};let Y=null;const X=[];let Z=(0,o.scaleLinear)().domain([0,100]).range([0,100]),G=0,K=0,Q=null,J=(0,o.scaleLinear)().domain([0,100]).range([0,100]),tt=0},5130:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.replaceWildcards=e.replaceWildcardsInText=void 0;const n="wildcard-container",r=/@![^!]*!@/g;function i(t,e){for(const n of t.match(r)||[]){const r=`${e[n.substring(2,n.length-2)]||""}`;t=t.replace(n,r)}return t}e.replaceWildcardsInText=i,e.replaceWildcards=function(t,e){$(t).find(`.${n}`).each((function(){this.classList.remove(n);const t=this.getAttribute("data-locus");if(void 0===t)return;const r=e.orfs.filter((e=>e.locus_tag===t))[0];for(const t of(this.getAttribute("data-wildcard-attrs")||"").split(" ")){const e=this.getAttribute(t);e&&this.setAttribute(t,i(e,r))}}))}},6216:(t,e,n)=>{"use strict";n.r(e),n.d(e,{axisBottom:()=>y,axisLeft:()=>b,axisRight:()=>v,axisTop:()=>m});var r=Array.prototype.slice;function i(t){return t}var s=1,a=2,o=3,l=4,c=1e-6;function u(t){return"translate("+(t+.5)+",0)"}function h(t){return"translate(0,"+(t+.5)+")"}function d(t){return function(e){return+t(e)}}function g(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function f(){return!this.__axis}function p(t,e){var n=[],p=null,m=null,v=6,y=6,b=3,x=t===s||t===l?-1:1,w=t===l||t===a?"x":"y",$=t===s||t===o?u:h;function S(r){var u=null==p?e.ticks?e.ticks.apply(e,n):e.domain():p,h=null==m?e.tickFormat?e.tickFormat.apply(e,n):i:m,S=Math.max(v,0)+b,A=e.range(),C=+A[0]+.5,M=+A[A.length-1]+.5,_=(e.bandwidth?g:d)(e.copy()),T=r.selection?r.selection():r,k=T.selectAll(".domain").data([null]),N=T.selectAll(".tick").data(u,e).order(),R=N.exit(),L=N.enter().append("g").attr("class","tick"),E=N.select("line"),P=N.select("text");k=k.merge(k.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),N=N.merge(L),E=E.merge(L.append("line").attr("stroke","currentColor").attr(w+"2",x*v)),P=P.merge(L.append("text").attr("fill","currentColor").attr(w,x*S).attr("dy",t===s?"0em":t===o?"0.71em":"0.32em")),r!==T&&(k=k.transition(r),N=N.transition(r),E=E.transition(r),P=P.transition(r),R=R.transition(r).attr("opacity",c).attr("transform",(function(t){return isFinite(t=_(t))?$(t):this.getAttribute("transform")})),L.attr("opacity",c).attr("transform",(function(t){var e=this.parentNode.__axis;return $(e&&isFinite(e=e(t))?e:_(t))}))),R.remove(),k.attr("d",t===l||t==a?y?"M"+x*y+","+C+"H0.5V"+M+"H"+x*y:"M0.5,"+C+"V"+M:y?"M"+C+","+x*y+"V0.5H"+M+"V"+x*y:"M"+C+",0.5H"+M),N.attr("opacity",1).attr("transform",(function(t){return $(_(t))})),E.attr(w+"2",x*v),P.attr(w,x*S).text(h),T.filter(f).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===a?"start":t===l?"end":"middle"),T.each((function(){this.__axis=_}))}return S.scale=function(t){return arguments.length?(e=t,S):e},S.ticks=function(){return n=r.call(arguments),S},S.tickArguments=function(t){return arguments.length?(n=null==t?[]:r.call(t),S):n.slice()},S.tickValues=function(t){return arguments.length?(p=null==t?null:r.call(t),S):p&&p.slice()},S.tickFormat=function(t){return arguments.length?(m=t,S):m},S.tickSize=function(t){return arguments.length?(v=y=+t,S):v},S.tickSizeInner=function(t){return arguments.length?(v=+t,S):v},S.tickSizeOuter=function(t){return arguments.length?(y=+t,S):y},S.tickPadding=function(t){return arguments.length?(b=+t,S):b},S}function m(t){return p(s,t)}function v(t){return p(a,t)}function y(t){return p(o,t)}function b(t){return p(l,t)}},2650:(t,e,n)=>{"use strict";function r(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function i(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function s(){}n.d(e,{ZP:()=>w,B8:()=>A});var a=.7,o=1/a,l="\\s*([+-]?\\d+)\\s*",c="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h=/^#([0-9a-f]{3,8})$/,d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),g=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),f=new RegExp("^rgba\\("+[l,l,l,c]+"\\)$"),p=new RegExp("^rgba\\("+[u,u,u,c]+"\\)$"),m=new RegExp("^hsl\\("+[c,u,u]+"\\)$"),v=new RegExp("^hsla\\("+[c,u,u,c]+"\\)$"),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function x(){return this.rgb().formatRgb()}function w(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=h.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?$(e):3===n?new C(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?S(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?S(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=d.exec(t))?new C(e[1],e[2],e[3],1):(e=g.exec(t))?new C(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=f.exec(t))?S(e[1],e[2],e[3],e[4]):(e=p.exec(t))?S(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=m.exec(t))?k(e[1],e[2]/100,e[3]/100,1):(e=v.exec(t))?k(e[1],e[2]/100,e[3]/100,e[4]):y.hasOwnProperty(t)?$(y[t]):"transparent"===t?new C(NaN,NaN,NaN,0):null}function $(t){return new C(t>>16&255,t>>8&255,255&t,1)}function S(t,e,n,r){return r<=0&&(t=e=n=NaN),new C(t,e,n,r)}function A(t,e,n,r){return 1===arguments.length?((i=t)instanceof s||(i=w(i)),i?new C((i=i.rgb()).r,i.g,i.b,i.opacity):new C):new C(t,e,n,null==r?1:r);var i}function C(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function M(){return"#"+T(this.r)+T(this.g)+T(this.b)}function _(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function T(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function k(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new R(t,e,n,r)}function N(t){if(t instanceof R)return new R(t.h,t.s,t.l,t.opacity);if(t instanceof s||(t=w(t)),!t)return new R;if(t instanceof R)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,l=a-i,c=(a+i)/2;return l?(o=e===a?(n-r)/l+6*(n<r):n===a?(r-e)/l+2:(e-n)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new R(o,l,c,t.opacity)}function R(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function L(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}r(s,w,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:b,formatHex:b,formatHsl:function(){return N(this).formatHsl()},formatRgb:x,toString:x}),r(C,A,i(s,{brighter:function(t){return t=null==t?o:Math.pow(o,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?a:Math.pow(a,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M,formatHex:M,formatRgb:_,toString:_})),r(R,(function(t,e,n,r){return 1===arguments.length?N(t):new R(t,e,n,null==r?1:r)}),i(s,{brighter:function(t){return t=null==t?o:Math.pow(o,t),new R(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?a:Math.pow(a,t),new R(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new C(L(t>=240?t-240:t+120,i,r),L(t,i,r),L(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}))},4594:(t,e,n)=>{"use strict";n.d(e,{W:()=>l});var r={value:function(){}};function i(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new s(r)}function s(t){this._=t}function a(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function o(t,e,n){for(var i=0,s=t.length;i<s;++i)if(t[i].name===e){t[i]=r,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}s.prototype=i.prototype={constructor:s,on:function(t,e){var n,r,i=this._,s=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),l=-1,c=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++l<c;)if(n=(t=s[l]).type)i[n]=o(i[n],t.name,e);else if(null==e)for(n in i)i[n]=o(i[n],t.name,null);return this}for(;++l<c;)if((n=(t=s[l]).type)&&(n=a(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new s(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),s=0;s<n;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(r=this._[t]).length;s<n;++s)r[s].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};const l=i},5305:(t,e,n)=>{"use strict";n.r(e),n.d(e,{drag:()=>p,dragDisable:()=>o,dragEnable:()=>l});var r=n(4594),i=n(4677);function s(){i.event.stopImmediatePropagation()}function a(){i.event.preventDefault(),i.event.stopImmediatePropagation()}function o(t){var e=t.document.documentElement,n=(0,i.select)(t).on("dragstart.drag",a,!0);"onselectstart"in e?n.on("selectstart.drag",a,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function l(t,e){var n=t.document.documentElement,r=(0,i.select)(t).on("dragstart.drag",null);e&&(r.on("click.drag",a,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function c(t){return function(){return t}}function u(t,e,n,r,i,s,a,o,l,c){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=s,this.y=a,this.dx=o,this.dy=l,this._=c}function h(){return!i.event.button}function d(){return this.parentNode}function g(t){return null==t?{x:i.event.x,y:i.event.y}:t}function f(){return"ontouchstart"in this}function p(){var t,e,n,p,m=h,v=d,y=g,b=f,x={},w=(0,r.W)("start","drag","end"),$=0,S=0;function A(t){t.on("mousedown.drag",C).filter(b).on("touchstart.drag",T).on("touchmove.drag",k).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function C(){if(!p&&m.apply(this,arguments)){var r=R("mouse",v.apply(this,arguments),i.mouse,this,arguments);r&&((0,i.select)(i.event.view).on("mousemove.drag",M,!0).on("mouseup.drag",_,!0),o(i.event.view),s(),n=!1,t=i.event.clientX,e=i.event.clientY,r("start"))}}function M(){if(a(),!n){var r=i.event.clientX-t,s=i.event.clientY-e;n=r*r+s*s>S}x.mouse("drag")}function _(){(0,i.select)(i.event.view).on("mousemove.drag mouseup.drag",null),l(i.event.view,n),a(),x.mouse("end")}function T(){if(m.apply(this,arguments)){var t,e,n=i.event.changedTouches,r=v.apply(this,arguments),a=n.length;for(t=0;t<a;++t)(e=R(n[t].identifier,r,i.touch,this,arguments))&&(s(),e("start"))}}function k(){var t,e,n=i.event.changedTouches,r=n.length;for(t=0;t<r;++t)(e=x[n[t].identifier])&&(a(),e("drag"))}function N(){var t,e,n=i.event.changedTouches,r=n.length;for(p&&clearTimeout(p),p=setTimeout((function(){p=null}),500),t=0;t<r;++t)(e=x[n[t].identifier])&&(s(),e("end"))}function R(t,e,n,r,s){var a,o,l,c=n(e,t),h=w.copy();if((0,i.customEvent)(new u(A,"beforestart",a,t,$,c[0],c[1],0,0,h),(function(){return null!=(i.event.subject=a=y.apply(r,s))&&(o=a.x-c[0]||0,l=a.y-c[1]||0,!0)})))return function d(g){var f,p=c;switch(g){case"start":x[t]=d,f=$++;break;case"end":delete x[t],--$;case"drag":c=n(e,t),f=$}(0,i.customEvent)(new u(A,g,a,t,f,c[0]+o,c[1]+l,c[0]-p[0],c[1]-p[1],h),h.apply,h,[g,r,s])}}return A.filter=function(t){return arguments.length?(m="function"==typeof t?t:c(!!t),A):m},A.container=function(t){return arguments.length?(v="function"==typeof t?t:c(t),A):v},A.subject=function(t){return arguments.length?(y="function"==typeof t?t:c(t),A):y},A.touchable=function(t){return arguments.length?(b="function"==typeof t?t:c(!!t),A):b},A.on=function(){var t=w.on.apply(w,arguments);return t===w?A:t},A.clickDistance=function(t){return arguments.length?(S=(t=+t)*t,A):Math.sqrt(S)},A}u.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t}},5302:(t,e,n)=>{"use strict";function r(t){return function(){return t}}n.d(e,{Z:()=>r})},3626:(t,e,n)=>{"use strict";function r(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}n.d(e,{Z:()=>r})},7765:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>c});var r=n(2650);function i(t,e,n,r,i){var s=t*t,a=s*t;return((1-3*t+3*s-a)*e+(4-6*s+3*a)*n+(1+3*t+3*s-3*a)*r+a*i)/6}var s=n(5302);function a(t,e){return function(n){return t+n*e}}function o(t){return 1==(t=+t)?l:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):(0,s.Z)(isNaN(e)?n:e)}}function l(t,e){var n=e-t;return n?a(t,n):(0,s.Z)(isNaN(t)?e:t)}const c=function t(e){var n=o(e);function i(t,e){var i=n((t=(0,r.B8)(t)).r,(e=(0,r.B8)(e)).r),s=n(t.g,e.g),a=n(t.b,e.b),o=l(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=s(e),t.b=a(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function u(t){return function(e){var n,i,s=e.length,a=new Array(s),o=new Array(s),l=new Array(s);for(n=0;n<s;++n)i=(0,r.B8)(e[n]),a[n]=i.r||0,o[n]=i.g||0,l[n]=i.b||0;return a=t(a),o=t(o),l=t(l),i.opacity=1,function(t){return i.r=a(t),i.g=o(t),i.b=l(t),i+""}}}u((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),s=t[r],a=t[r+1],o=r>0?t[r-1]:2*s-a,l=r<e-1?t[r+2]:2*a-s;return i((n-r/e)*e,o,s,a,l)}})),u((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),s=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],l=t[(r+2)%e];return i((n-r/e)*e,s,a,o,l)}}))},9843:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(3626),i=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,s=new RegExp(i.source,"g");function a(t,e){var n,a,o,l=i.lastIndex=s.lastIndex=0,c=-1,u=[],h=[];for(t+="",e+="";(n=i.exec(t))&&(a=s.exec(e));)(o=a.index)>l&&(o=e.slice(l,o),u[c]?u[c]+=o:u[++c]=o),(n=n[0])===(a=a[0])?u[c]?u[c]+=a:u[++c]=a:(u[++c]=null,h.push({i:c,x:(0,r.Z)(n,a)})),l=s.lastIndex;return l<e.length&&(o=e.slice(l),u[c]?u[c]+=o:u[++c]=o),u.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var n,r=0;r<e;++r)u[(n=h[r]).i]=n.x(t);return u.join("")})}},777:(t,e,n)=>{"use strict";n.r(e),n.d(e,{path:()=>c});var r=Math.PI,i=2*r,s=1e-6,a=i-s;function o(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function l(){return new o}o.prototype=l.prototype={constructor:o,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,i,a){t=+t,e=+e,n=+n,i=+i,a=+a;var o=this._x1,l=this._y1,c=n-t,u=i-e,h=o-t,d=l-e,g=h*h+d*d;if(a<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(g>s)if(Math.abs(d*c-u*h)>s&&a){var f=n-o,p=i-l,m=c*c+u*u,v=f*f+p*p,y=Math.sqrt(m),b=Math.sqrt(g),x=a*Math.tan((r-Math.acos((m+g-v)/(2*y*b)))/2),w=x/b,$=x/y;Math.abs(w-1)>s&&(this._+="L"+(t+w*h)+","+(e+w*d)),this._+="A"+a+","+a+",0,0,"+ +(d*f>h*p)+","+(this._x1=t+$*c)+","+(this._y1=e+$*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,o,l,c){t=+t,e=+e;var u=(n=+n)*Math.cos(o),h=n*Math.sin(o),d=t+u,g=e+h,f=1^c,p=c?o-l:l-o;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+d+","+g:(Math.abs(this._x1-d)>s||Math.abs(this._y1-g)>s)&&(this._+="L"+d+","+g),n&&(p<0&&(p=p%i+i),p>a?this._+="A"+n+","+n+",0,1,"+f+","+(t-u)+","+(e-h)+"A"+n+","+n+",0,1,"+f+","+(this._x1=d)+","+(this._y1=g):p>s&&(this._+="A"+n+","+n+",0,"+ +(p>=r)+","+f+","+(this._x1=t+n*Math.cos(l))+","+(this._y1=e+n*Math.sin(l))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const c=l},9086:(t,e,n)=>{"use strict";function r(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function i(t){var e;return 1===t.length&&(e=t,t=function(t,n){return r(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}n.r(e),n.d(e,{scaleBand:()=>R,scaleDiverging:()=>wr,scaleDivergingLog:()=>$r,scaleDivergingPow:()=>Ar,scaleDivergingSqrt:()=>Cr,scaleDivergingSymlog:()=>Sr,scaleIdentity:()=>yt,scaleImplicit:()=>k,scaleLinear:()=>vt,scaleLog:()=>_t,scaleOrdinal:()=>N,scalePoint:()=>E,scalePow:()=>It,scaleQuantile:()=>Ot,scaleQuantize:()=>zt,scaleSequential:()=>fr,scaleSequentialLog:()=>pr,scaleSequentialPow:()=>vr,scaleSequentialQuantile:()=>br,scaleSequentialSqrt:()=>yr,scaleSequentialSymlog:()=>mr,scaleSqrt:()=>Bt,scaleSymlog:()=>Rt,scaleThreshold:()=>Ht,scaleTime:()=>ur,scaleUtc:()=>hr,tickFormat:()=>pt});var s=i(r),a=s.right;s.left;const o=a;var l=Array.prototype,c=(l.slice,l.map,Math.sqrt(50)),u=Math.sqrt(10),h=Math.sqrt(2);function d(t,e,n){var r,i,s,a,o=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=g(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),s=new Array(i=Math.ceil(e-t+1));++o<i;)s[o]=(t+o)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),s=new Array(i=Math.ceil(t-e+1));++o<i;)s[o]=(t-o)/a;return r&&s.reverse(),s}function g(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=c?10:s>=u?5:s>=h?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=c?10:s>=u?5:s>=h?2:1)}function f(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=c?i*=10:s>=u?i*=5:s>=h&&(i*=2),e<t?-i:i}function p(t){return null===t?NaN:+t}function m(t,e,n){if(null==n&&(n=p),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,s=Math.floor(i),a=+n(t[s],s,t);return a+(+n(t[s+1],s+1,t)-a)*(i-s)}}function v(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function y(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var b="$";function x(){}function w(t,e){var n=new x;if(t instanceof x)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,s=t.length;if(null==e)for(;++i<s;)n.set(i,t[i]);else for(;++i<s;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}x.prototype=w.prototype={constructor:x,has:function(t){return b+t in this},get:function(t){return this[b+t]},set:function(t,e){return this[b+t]=e,this},remove:function(t){var e=b+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===b&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===b&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===b&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===b&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===b&&++t;return t},empty:function(){for(var t in this)if(t[0]===b)return!1;return!0},each:function(t){for(var e in this)e[0]===b&&t(this[e],e.slice(1),this)}};const $=w;function S(){}var A=$.prototype;function C(t,e){var n=new S;if(t instanceof S)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}S.prototype=C.prototype={constructor:S,has:A.has,add:function(t){return this[b+(t+="")]=t,this},remove:A.remove,clear:A.clear,values:A.keys,size:A.size,empty:A.empty,each:A.each};var M=Array.prototype,_=M.map,T=M.slice,k={name:"implicit"};function N(){var t=$(),e=[],n=[],r=k;function i(i){var s=i+"",a=t.get(s);if(!a){if(r!==k)return r;t.set(s,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=$();for(var r,s,a=-1,o=n.length;++a<o;)t.has(s=(r=n[a])+"")||t.set(s,e.push(r));return i},i.range=function(t){return arguments.length?(n=T.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return N(e,n).unknown(r)},v.apply(i,arguments),i}function R(){var t,e,n=N().unknown(void 0),r=n.domain,i=n.range,s=[0,1],a=!1,o=0,l=0,c=.5;function u(){var n=r().length,u=s[1]<s[0],h=s[u-0],d=s[1-u];t=(d-h)/Math.max(1,n-o+2*l),a&&(t=Math.floor(t)),h+=(d-h-t*(n-o))*c,e=t*(1-o),a&&(h=Math.round(h),e=Math.round(e));var g=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),s=new Array(i);++r<i;)s[r]=t+r*n;return s}(n).map((function(e){return h+t*e}));return i(u?g.reverse():g)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),u()):r()},n.range=function(t){return arguments.length?(s=[+t[0],+t[1]],u()):s.slice()},n.rangeRound=function(t){return s=[+t[0],+t[1]],a=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,u()):a},n.padding=function(t){return arguments.length?(o=Math.min(1,l=+t),u()):o},n.paddingInner=function(t){return arguments.length?(o=Math.min(1,t),u()):o},n.paddingOuter=function(t){return arguments.length?(l=+t,u()):l},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),u()):c},n.copy=function(){return R(r(),s).round(a).paddingInner(o).paddingOuter(l).align(c)},v.apply(u(),arguments)}function L(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return L(e())},t}function E(){return L(R.apply(null,arguments).paddingInner(1))}var P=n(2650),D=n(7765);function I(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,s=new Array(i),a=new Array(r);for(n=0;n<i;++n)s[n]=q(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=s[n](t);return a}}function B(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}var O=n(3626);function z(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=q(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var H=n(9843),F=n(5302);function j(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(s){for(n=0;n<r;++n)i[n]=t[n]*(1-s)+e[n]*s;return i}}function q(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?(0,F.Z)(e):("number"===i?O.Z:"string"===i?(n=(0,P.ZP)(e))?(e=n,D.ZP):H.Z:e instanceof P.ZP?D.ZP:e instanceof Date?B:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?I:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?z:O.Z:j))(t,e)}function U(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function V(t){return+t}var W=[0,1];function Y(t){return t}function X(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Z(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function G(t,e,n){var r=t[0],i=t[1],s=e[0],a=e[1];return i<r?(r=X(i,r),s=n(a,s)):(r=X(r,i),s=n(s,a)),function(t){return s(r(t))}}function K(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=X(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(e){var n=o(t,e,1,r)-1;return s[n](i[n](e))}}function Q(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function J(){var t,e,n,r,i,s,a=W,o=W,l=q,c=Y;function u(){return r=Math.min(a.length,o.length)>2?K:G,i=s=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),o,l)))(t(c(e)))}return h.invert=function(n){return c(e((s||(s=r(o,a.map(t),O.Z)))(n)))},h.domain=function(t){return arguments.length?(a=_.call(t,V),c===Y||(c=Z(a)),u()):a.slice()},h.range=function(t){return arguments.length?(o=T.call(t),u()):o.slice()},h.rangeRound=function(t){return o=T.call(t),l=U,u()},h.clamp=function(t){return arguments.length?(c=t?Z(a):Y,h):c!==Y},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,u()}}function tt(t,e){return J()(t,e)}function et(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function nt(t){return(t=et(Math.abs(t)))?t[1]:NaN}var rt,it=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function st(t){return new at(t)}function at(t){if(!(e=it.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}function ot(t,e){var n=et(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}st.prototype=at.prototype,at.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const lt={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return ot(100*t,e)},r:ot,s:function(t,e){var n=et(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(rt=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+et(t,Math.max(0,e+s-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ct(t){return t}var ut,ht,dt,gt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ft(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(t.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(n)}):ct,i=t.currency,s=t.decimal,a=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(t.numerals):ct,o=t.percent||"%";function l(t){var e=(t=st(t)).fill,n=t.align,l=t.sign,c=t.symbol,u=t.zero,h=t.width,d=t.comma,g=t.precision,f=t.trim,p=t.type;"n"===p?(d=!0,p="g"):lt[p]||(null==g&&(g=12),f=!0,p="g"),(u||"0"===e&&"="===n)&&(u=!0,e="0",n="=");var m="$"===c?i[0]:"#"===c&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",v="$"===c?i[1]:/[%p]/.test(p)?o:"",y=lt[p],b=/[defgprs%]/.test(p);function x(t){var i,o,c,x=m,w=v;if("c"===p)w=y(t)+w,t="";else{var $=(t=+t)<0;if(t=y(Math.abs(t),g),f&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),$&&0==+t&&($=!1),x=($?"("===l?l:"-":"-"===l||"("===l?"":l)+x,w=("s"===p?gt[8+rt/3]:"")+w+($&&"("===l?")":""),b)for(i=-1,o=t.length;++i<o;)if(48>(c=t.charCodeAt(i))||c>57){w=(46===c?s+t.slice(i+1):t.slice(i))+w,t=t.slice(0,i);break}}d&&!u&&(t=r(t,1/0));var S=x.length+t.length+w.length,A=S<h?new Array(h-S+1).join(e):"";switch(d&&u&&(t=r(A+t,A.length?h-w.length:1/0),A=""),n){case"<":t=x+t+w+A;break;case"=":t=x+A+t+w;break;case"^":t=A.slice(0,S=A.length>>1)+x+t+w+A.slice(S);break;default:t=A+x+t+w}return a(t)}return g=null==g?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),x.toString=function(){return t+""},x}return{format:l,formatPrefix:function(t,e){var n=l(((t=st(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(nt(e)/3))),i=Math.pow(10,-r),s=gt[8+r/3];return function(t){return n(i*t)+s}}}}function pt(t,e,n,r){var i,s=f(t,e,n);switch((r=st(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(nt(e)/3)))-nt(Math.abs(t)))}(s,a))||(r.precision=i),dt(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,nt(e)-nt(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-nt(Math.abs(t)))}(s))||(r.precision=i-2*("%"===r.type))}return ht(r)}function mt(t){var e=t.domain;return t.ticks=function(t){var n=e();return d(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return pt(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),s=0,a=i.length-1,o=i[s],l=i[a];return l<o&&(r=o,o=l,l=r,r=s,s=a,a=r),(r=g(o,l,n))>0?r=g(o=Math.floor(o/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=g(o=Math.ceil(o*r)/r,l=Math.floor(l*r)/r,n)),r>0?(i[s]=Math.floor(o/r)*r,i[a]=Math.ceil(l/r)*r,e(i)):r<0&&(i[s]=Math.ceil(o*r)/r,i[a]=Math.floor(l*r)/r,e(i)),t},t}function vt(){var t=tt(Y,Y);return t.copy=function(){return Q(t,vt())},v.apply(t,arguments),mt(t)}function yt(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=_.call(e,V),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return yt(t).unknown(e)},t=arguments.length?_.call(t,V):[0,1],mt(n)}function bt(t,e){var n,r=0,i=(t=t.slice()).length-1,s=t[r],a=t[i];return a<s&&(n=r,r=i,i=n,n=s,s=a,a=n),t[r]=e.floor(s),t[i]=e.ceil(a),t}function xt(t){return Math.log(t)}function wt(t){return Math.exp(t)}function $t(t){return-Math.log(-t)}function St(t){return-Math.exp(-t)}function At(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Ct(t){return function(e){return-t(-e)}}function Mt(t){var e,n,r=t(xt,wt),i=r.domain,s=10;function a(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(s),n=function(t){return 10===t?At:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(s),i()[0]<0?(e=Ct(e),n=Ct(n),t($t,St)):t(xt,wt),r}return r.base=function(t){return arguments.length?(s=+t,a()):s},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),o=a[0],l=a[a.length-1];(r=l<o)&&(g=o,o=l,l=g);var c,u,h,g=e(o),f=e(l),p=null==t?10:+t,m=[];if(!(s%1)&&f-g<p){if(g=Math.round(g)-1,f=Math.round(f)+1,o>0){for(;g<f;++g)for(u=1,c=n(g);u<s;++u)if(!((h=c*u)<o)){if(h>l)break;m.push(h)}}else for(;g<f;++g)for(u=s-1,c=n(g);u>=1;--u)if(!((h=c*u)<o)){if(h>l)break;m.push(h)}}else m=d(g,f,Math.min(f-g,p)).map(n);return r?m.reverse():m},r.tickFormat=function(t,i){if(null==i&&(i=10===s?".0e":","),"function"!=typeof i&&(i=ht(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,s*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*s<s-.5&&(r*=s),r<=a?i(t):""}},r.nice=function(){return i(bt(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function _t(){var t=Mt(J()).domain([1,10]);return t.copy=function(){return Q(t,_t()).base(t.base())},v.apply(t,arguments),t}function Tt(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function kt(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Nt(t){var e=1,n=t(Tt(e),kt(e));return n.constant=function(n){return arguments.length?t(Tt(e=+n),kt(e)):e},mt(n)}function Rt(){var t=Nt(J());return t.copy=function(){return Q(t,Rt()).constant(t.constant())},v.apply(t,arguments)}function Lt(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Et(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Pt(t){return t<0?-t*t:t*t}function Dt(t){var e=t(Y,Y),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(Y,Y):.5===n?t(Et,Pt):t(Lt(n),Lt(1/n)):n},mt(e)}function It(){var t=Dt(J());return t.copy=function(){return Q(t,It()).exponent(t.exponent())},v.apply(t,arguments),t}function Bt(){return It.apply(null,arguments).exponent(.5)}function Ot(){var t,e=[],n=[],i=[];function s(){var t=0,r=Math.max(1,n.length);for(i=new Array(r-1);++t<r;)i[t-1]=m(e,t/r);return a}function a(e){return isNaN(e=+e)?t:n[o(i,e)]}return a.invertExtent=function(t){var r=n.indexOf(t);return r<0?[NaN,NaN]:[r>0?i[r-1]:e[0],r<i.length?i[r]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,i=0,a=t.length;i<a;++i)null==(n=t[i])||isNaN(n=+n)||e.push(n);return e.sort(r),s()},a.range=function(t){return arguments.length?(n=T.call(t),s()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return Ot().domain(e).range(n).unknown(t)},v.apply(a,arguments)}function zt(){var t,e=0,n=1,r=1,i=[.5],s=[0,1];function a(e){return e<=e?s[o(i,e,0,r)]:t}function l(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return a}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],l()):[e,n]},a.range=function(t){return arguments.length?(r=(s=T.call(t)).length-1,l()):s.slice()},a.invertExtent=function(t){var a=s.indexOf(t);return a<0?[NaN,NaN]:a<1?[e,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.unknown=function(e){return arguments.length?(t=e,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return zt().domain([e,n]).range(s).unknown(t)},v.apply(mt(a),arguments)}function Ht(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[o(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=T.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=T.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return Ht().domain(e).range(n).unknown(t)},v.apply(i,arguments)}ut=ft({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),ht=ut.format,dt=ut.formatPrefix;var Ft=new Date,jt=new Date;function qt(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,s){var a,o=[];if(n=i.ceil(n),s=null==s?1:Math.floor(s),!(n<r&&s>0))return o;do{o.push(a=new Date(+n)),e(n,s),t(n)}while(a<n&&n<r);return o},i.filter=function(n){return qt((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Ft.setTime(+e),jt.setTime(+r),t(Ft),t(jt),Math.floor(n(Ft,jt))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Ut=qt((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));Ut.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?qt((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Ut:null};const Vt=Ut;Ut.range;var Wt=1e3,Yt=6e4,Xt=36e5,Zt=864e5,Gt=6048e5,Kt=qt((function(t){t.setTime(Math.floor(t/Wt)*Wt)}),(function(t,e){t.setTime(+t+e*Wt)}),(function(t,e){return(e-t)/Wt}),(function(t){return t.getUTCSeconds()}));const Qt=Kt;Kt.range;var Jt=qt((function(t){t.setTime(Math.floor(t/Yt)*Yt)}),(function(t,e){t.setTime(+t+e*Yt)}),(function(t,e){return(e-t)/Yt}),(function(t){return t.getMinutes()}));const te=Jt;Jt.range;var ee=qt((function(t){var e=t.getTimezoneOffset()*Yt%Xt;e<0&&(e+=Xt),t.setTime(Math.floor((+t-e)/Xt)*Xt+e)}),(function(t,e){t.setTime(+t+e*Xt)}),(function(t,e){return(e-t)/Xt}),(function(t){return t.getHours()}));const ne=ee;ee.range;var re=qt((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Yt)/Zt}),(function(t){return t.getDate()-1}));const ie=re;re.range;function se(t){return qt((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Yt)/Gt}))}var ae=se(0),oe=se(1),le=se(2),ce=se(3),ue=se(4),he=se(5),de=se(6),ge=(ae.range,oe.range,le.range,ce.range,ue.range,he.range,de.range,qt((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));const fe=ge;ge.range;var pe=qt((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));pe.every=function(t){return isFinite(t=Math.floor(t))&&t>0?qt((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const me=pe;pe.range;var ve=qt((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*Yt)}),(function(t,e){return(e-t)/Yt}),(function(t){return t.getUTCMinutes()}));const ye=ve;ve.range;var be=qt((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*Xt)}),(function(t,e){return(e-t)/Xt}),(function(t){return t.getUTCHours()}));const xe=be;be.range;var we=qt((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/Zt}),(function(t){return t.getUTCDate()-1}));const $e=we;we.range;function Se(t){return qt((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/Gt}))}var Ae=Se(0),Ce=Se(1),Me=Se(2),_e=Se(3),Te=Se(4),ke=Se(5),Ne=Se(6),Re=(Ae.range,Ce.range,Me.range,_e.range,Te.range,ke.range,Ne.range,qt((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})));const Le=Re;Re.range;var Ee=qt((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Ee.every=function(t){return isFinite(t=Math.floor(t))&&t>0?qt((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const Pe=Ee;Ee.range;function De(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Ie(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Be(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}var Oe,ze,He,Fe,je={"-":"",_:" ",0:"0"},qe=/^\s*\d+/,Ue=/^%/,Ve=/[\\^$*+?|[\]().{}]/g;function We(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function Ye(t){return t.replace(Ve,"\\$&")}function Xe(t){return new RegExp("^(?:"+t.map(Ye).join("|")+")","i")}function Ze(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Ge(t,e,n){var r=qe.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ke(t,e,n){var r=qe.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Qe(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Je(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function tn(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function en(t,e,n){var r=qe.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function nn(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function rn(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function sn(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function an(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function on(t,e,n){var r=qe.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function ln(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function cn(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function un(t,e,n){var r=qe.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function hn(t,e,n){var r=qe.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function dn(t,e,n){var r=qe.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function gn(t,e,n){var r=Ue.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function fn(t,e,n){var r=qe.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function pn(t,e,n){var r=qe.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function mn(t,e){return We(t.getDate(),e,2)}function vn(t,e){return We(t.getHours(),e,2)}function yn(t,e){return We(t.getHours()%12||12,e,2)}function bn(t,e){return We(1+ie.count(me(t),t),e,3)}function xn(t,e){return We(t.getMilliseconds(),e,3)}function wn(t,e){return xn(t,e)+"000"}function $n(t,e){return We(t.getMonth()+1,e,2)}function Sn(t,e){return We(t.getMinutes(),e,2)}function An(t,e){return We(t.getSeconds(),e,2)}function Cn(t){var e=t.getDay();return 0===e?7:e}function Mn(t,e){return We(ae.count(me(t),t),e,2)}function _n(t,e){var n=t.getDay();return t=n>=4||0===n?ue(t):ue.ceil(t),We(ue.count(me(t),t)+(4===me(t).getDay()),e,2)}function Tn(t){return t.getDay()}function kn(t,e){return We(oe.count(me(t),t),e,2)}function Nn(t,e){return We(t.getFullYear()%100,e,2)}function Rn(t,e){return We(t.getFullYear()%1e4,e,4)}function Ln(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+We(e/60|0,"0",2)+We(e%60,"0",2)}function En(t,e){return We(t.getUTCDate(),e,2)}function Pn(t,e){return We(t.getUTCHours(),e,2)}function Dn(t,e){return We(t.getUTCHours()%12||12,e,2)}function In(t,e){return We(1+$e.count(Pe(t),t),e,3)}function Bn(t,e){return We(t.getUTCMilliseconds(),e,3)}function On(t,e){return Bn(t,e)+"000"}function zn(t,e){return We(t.getUTCMonth()+1,e,2)}function Hn(t,e){return We(t.getUTCMinutes(),e,2)}function Fn(t,e){return We(t.getUTCSeconds(),e,2)}function jn(t){var e=t.getUTCDay();return 0===e?7:e}function qn(t,e){return We(Ae.count(Pe(t),t),e,2)}function Un(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Te(t):Te.ceil(t),We(Te.count(Pe(t),t)+(4===Pe(t).getUTCDay()),e,2)}function Vn(t){return t.getUTCDay()}function Wn(t,e){return We(Ce.count(Pe(t),t),e,2)}function Yn(t,e){return We(t.getUTCFullYear()%100,e,2)}function Xn(t,e){return We(t.getUTCFullYear()%1e4,e,4)}function Zn(){return"+0000"}function Gn(){return"%"}function Kn(t){return+t}function Qn(t){return Math.floor(+t/1e3)}!function(t){Oe=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,a=t.shortDays,o=t.months,l=t.shortMonths,c=Xe(i),u=Ze(i),h=Xe(s),d=Ze(s),g=Xe(a),f=Ze(a),p=Xe(o),m=Ze(o),v=Xe(l),y=Ze(l),b={a:function(t){return a[t.getDay()]},A:function(t){return s[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return o[t.getMonth()]},c:null,d:mn,e:mn,f:wn,H:vn,I:yn,j:bn,L:xn,m:$n,M:Sn,p:function(t){return i[+(t.getHours()>=12)]},Q:Kn,s:Qn,S:An,u:Cn,U:Mn,V:_n,w:Tn,W:kn,x:null,X:null,y:Nn,Y:Rn,Z:Ln,"%":Gn},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return s[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return o[t.getUTCMonth()]},c:null,d:En,e:En,f:On,H:Pn,I:Dn,j:In,L:Bn,m:zn,M:Hn,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:Kn,s:Qn,S:Fn,u:jn,U:qn,V:Un,w:Vn,W:Wn,x:null,X:null,y:Yn,Y:Xn,Z:Zn,"%":Gn},w={a:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:an,e:an,f:dn,H:ln,I:ln,j:on,L:hn,m:sn,M:cn,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=u[r[0].toLowerCase()],n+r[0].length):-1},Q:fn,s:pn,S:un,u:Ke,U:Qe,V:Je,w:Ge,W:tn,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:nn,Y:en,Z:rn,"%":gn};function $(t,e){return function(n){var r,i,s,a=[],o=-1,l=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++o<c;)37===t.charCodeAt(o)&&(a.push(t.slice(l,o)),null!=(i=je[r=t.charAt(++o)])?r=t.charAt(++o):i="e"===r?" ":"0",(s=e[r])&&(r=s(n,i)),a.push(r),l=o+1);return a.push(t.slice(l,o)),a.join("")}}function S(t,e){return function(n){var r,i,s=Be(1900);if(A(s,t,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("p"in s&&(s.H=s.H%12+12*s.p),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(i=(r=Ie(Be(s.y))).getUTCDay(),r=i>4||0===i?Ce.ceil(r):Ce(r),r=$e.offset(r,7*(s.V-1)),s.y=r.getUTCFullYear(),s.m=r.getUTCMonth(),s.d=r.getUTCDate()+(s.w+6)%7):(i=(r=e(Be(s.y))).getDay(),r=i>4||0===i?oe.ceil(r):oe(r),r=ie.offset(r,7*(s.V-1)),s.y=r.getFullYear(),s.m=r.getMonth(),s.d=r.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),i="Z"in s?Ie(Be(s.y)).getUTCDay():e(Be(s.y)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(i+5)%7:s.w+7*s.U-(i+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,Ie(s)):e(s)}}function A(t,e,n,r){for(var i,s,a=0,o=e.length,l=n.length;a<o;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(s=w[i in je?e.charAt(a++):i])||(r=s(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=$(n,b),b.X=$(r,b),b.c=$(e,b),x.x=$(n,x),x.X=$(r,x),x.c=$(e,x),{format:function(t){var e=$(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=S(t+="",De);return e.toString=function(){return t},e},utcFormat:function(t){var e=$(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t,Ie);return e.toString=function(){return t},e}}}(t),ze=Oe.format,Oe.parse,He=Oe.utcFormat,Fe=Oe.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Jn="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||He(Jn);+new Date("2000-01-01T00:00:00.000Z")||Fe(Jn);var tr=1e3,er=60*tr,nr=60*er,rr=24*nr,ir=7*rr,sr=30*rr,ar=365*rr;function or(t){return new Date(t)}function lr(t){return t instanceof Date?+t:+new Date(+t)}function cr(t,e,n,r,s,a,o,l,c){var u=tt(Y,Y),h=u.invert,d=u.domain,g=c(".%L"),p=c(":%S"),m=c("%I:%M"),v=c("%I %p"),y=c("%a %d"),b=c("%b %d"),x=c("%B"),w=c("%Y"),$=[[o,1,tr],[o,5,5*tr],[o,15,15*tr],[o,30,30*tr],[a,1,er],[a,5,5*er],[a,15,15*er],[a,30,30*er],[s,1,nr],[s,3,3*nr],[s,6,6*nr],[s,12,12*nr],[r,1,rr],[r,2,2*rr],[n,1,ir],[e,1,sr],[e,3,3*sr],[t,1,ar]];function S(i){return(o(i)<i?g:a(i)<i?p:s(i)<i?m:r(i)<i?v:e(i)<i?n(i)<i?y:b:t(i)<i?x:w)(i)}function A(e,n,r,s){if(null==e&&(e=10),"number"==typeof e){var a=Math.abs(r-n)/e,o=i((function(t){return t[2]})).right($,a);o===$.length?(s=f(n/ar,r/ar,e),e=t):o?(s=(o=$[a/$[o-1][2]<$[o][2]/a?o-1:o])[1],e=o[0]):(s=Math.max(f(n,r,e),1),e=l)}return null==s?e:e.every(s)}return u.invert=function(t){return new Date(h(t))},u.domain=function(t){return arguments.length?d(_.call(t,lr)):d().map(or)},u.ticks=function(t,e){var n,r=d(),i=r[0],s=r[r.length-1],a=s<i;return a&&(n=i,i=s,s=n),n=(n=A(t,i,s,e))?n.range(i,s+1):[],a?n.reverse():n},u.tickFormat=function(t,e){return null==e?S:c(e)},u.nice=function(t,e){var n=d();return(t=A(t,n[0],n[n.length-1],e))?d(bt(n,t)):u},u.copy=function(){return Q(u,cr(t,e,n,r,s,a,o,l,c))},u}function ur(){return v.apply(cr(me,fe,ae,ie,ne,te,Qt,Vt,ze).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function hr(){return v.apply(cr(Pe,Le,Ae,$e,xe,ye,Qt,Vt,He).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dr(){var t,e,n,r,i,s=0,a=1,o=Y,l=!1;function c(e){return isNaN(e=+e)?i:o(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}return c.domain=function(i){return arguments.length?(t=r(s=+i[0]),e=r(a=+i[1]),n=t===e?0:1/(e-t),c):[s,a]},c.clamp=function(t){return arguments.length?(l=!!t,c):l},c.interpolator=function(t){return arguments.length?(o=t,c):o},c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(s),e=i(a),n=t===e?0:1/(e-t),c}}function gr(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function fr(){var t=mt(dr()(Y));return t.copy=function(){return gr(t,fr())},y.apply(t,arguments)}function pr(){var t=Mt(dr()).domain([1,10]);return t.copy=function(){return gr(t,pr()).base(t.base())},y.apply(t,arguments)}function mr(){var t=Nt(dr());return t.copy=function(){return gr(t,mr()).constant(t.constant())},y.apply(t,arguments)}function vr(){var t=Dt(dr());return t.copy=function(){return gr(t,vr()).exponent(t.exponent())},y.apply(t,arguments)}function yr(){return vr.apply(null,arguments).exponent(.5)}function br(){var t=[],e=Y;function n(n){if(!isNaN(n=+n))return e((o(t,n)-1)/(t.length-1))}return n.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var i,s=0,a=e.length;s<a;++s)null==(i=e[s])||isNaN(i=+i)||t.push(i);return t.sort(r),n},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return br(e).domain(t)},y.apply(n,arguments)}function xr(){var t,e,n,r,i,s,a,o=0,l=.5,c=1,u=Y,h=!1;function d(t){return isNaN(t=+t)?a:(t=.5+((t=+s(t))-e)*(t<e?r:i),u(h?Math.max(0,Math.min(1,t)):t))}return d.domain=function(a){return arguments.length?(t=s(o=+a[0]),e=s(l=+a[1]),n=s(c=+a[2]),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),d):[o,l,c]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(u=t,d):u},d.unknown=function(t){return arguments.length?(a=t,d):a},function(a){return s=a,t=a(o),e=a(l),n=a(c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),d}}function wr(){var t=mt(xr()(Y));return t.copy=function(){return gr(t,wr())},y.apply(t,arguments)}function $r(){var t=Mt(xr()).domain([.1,1,10]);return t.copy=function(){return gr(t,$r()).base(t.base())},y.apply(t,arguments)}function Sr(){var t=Nt(xr());return t.copy=function(){return gr(t,Sr()).constant(t.constant())},y.apply(t,arguments)}function Ar(){var t=Dt(xr());return t.copy=function(){return gr(t,Ar()).exponent(t.exponent())},y.apply(t,arguments)}function Cr(){return Ar.apply(null,arguments).exponent(.5)}},4677:(t,e,n)=>{"use strict";n.r(e),n.d(e,{clientPoint:()=>St,create:()=>yt,creator:()=>l,customEvent:()=>ct,event:()=>it,local:()=>xt,matcher:()=>m,mouse:()=>At,namespace:()=>s,namespaces:()=>i,select:()=>vt,selectAll:()=>Ct,selection:()=>mt,selector:()=>u,selectorAll:()=>d,style:()=>E,touch:()=>Mt,touches:()=>_t,window:()=>k});var r="http://www.w3.org/1999/xhtml";const i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function s(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t}function a(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===r&&e.documentElement.namespaceURI===r?e.createElement(t):e.createElementNS(n,t)}}function o(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function l(t){var e=s(t);return(e.local?o:a)(e)}function c(){}function u(t){return null==t?c:function(){return this.querySelector(t)}}function h(){return[]}function d(t){return null==t?h:function(){return this.querySelectorAll(t)}}var g=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var f=document.documentElement;if(!f.matches){var p=f.webkitMatchesSelector||f.msMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector;g=function(t){return function(){return p.call(this,t)}}}}const m=g;function v(t){return new Array(t.length)}function y(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}y.prototype={constructor:y,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var b="$";function x(t,e,n,r,i,s){for(var a,o=0,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new y(t,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function w(t,e,n,r,i,s,a){var o,l,c,u={},h=e.length,d=s.length,g=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(g[o]=c=b+a.call(l,l.__data__,o,e),c in u?i[o]=l:u[c]=l);for(o=0;o<d;++o)(l=u[c=b+a.call(t,s[o],o,s)])?(r[o]=l,l.__data__=s[o],u[c]=null):n[o]=new y(t,s[o]);for(o=0;o<h;++o)(l=e[o])&&u[g[o]]===l&&(i[o]=l)}function $(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function S(t){return function(){this.removeAttribute(t)}}function A(t){return function(){this.removeAttributeNS(t.space,t.local)}}function C(t,e){return function(){this.setAttribute(t,e)}}function M(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function T(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function k(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function N(t){return function(){this.style.removeProperty(t)}}function R(t,e,n){return function(){this.style.setProperty(t,e,n)}}function L(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function E(t,e){return t.style.getPropertyValue(e)||k(t).getComputedStyle(t,null).getPropertyValue(e)}function P(t){return function(){delete this[t]}}function D(t,e){return function(){this[t]=e}}function I(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function B(t){return t.trim().split(/^|\s+/)}function O(t){return t.classList||new z(t)}function z(t){this._node=t,this._names=B(t.getAttribute("class")||"")}function H(t,e){for(var n=O(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function F(t,e){for(var n=O(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function j(t){return function(){H(this,t)}}function q(t){return function(){F(this,t)}}function U(t,e){return function(){(e.apply(this,arguments)?H:F)(this,t)}}function V(){this.textContent=""}function W(t){return function(){this.textContent=t}}function Y(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function X(){this.innerHTML=""}function Z(t){return function(){this.innerHTML=t}}function G(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function K(){this.nextSibling&&this.parentNode.appendChild(this)}function Q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function J(){return null}function tt(){var t=this.parentNode;t&&t.removeChild(this)}function et(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function nt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}z.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var rt={},it=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(rt={mouseenter:"mouseover",mouseleave:"mouseout"}));function st(t,e,n){return t=at(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function at(t,e,n){return function(r){var i=it;it=r;try{t.call(this,this.__data__,e,n)}finally{it=i}}}function ot(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,s=e.length;r<s;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function lt(t,e,n){var r=rt.hasOwnProperty(t.type)?st:at;return function(i,s,a){var o,l=this.__on,c=r(e,s,a);if(l)for(var u=0,h=l.length;u<h;++u)if((o=l[u]).type===t.type&&o.name===t.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=c,o.capture=n),void(o.value=e);this.addEventListener(t.type,c,n),o={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(o):this.__on=[o]}}function ct(t,e,n,r){var i=it;t.sourceEvent=it,it=t;try{return e.apply(n,r)}finally{it=i}}function ut(t,e,n){var r=k(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ht(t,e){return function(){return ut(this,t,e)}}function dt(t,e){return function(){return ut(this,t,e.apply(this,arguments))}}var gt=[null];function ft(t,e){this._groups=t,this._parents=e}function pt(){return new ft([[document.documentElement]],gt)}ft.prototype=pt.prototype={constructor:ft,select:function(t){"function"!=typeof t&&(t=u(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,a,o=e[i],l=o.length,c=r[i]=new Array(l),h=0;h<l;++h)(s=o[h])&&(a=t.call(s,s.__data__,h,o))&&("__data__"in s&&(a.__data__=s.__data__),c[h]=a);return new ft(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=d(t));for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var a,o=e[s],l=o.length,c=0;c<l;++c)(a=o[c])&&(r.push(t.call(a,a.__data__,c,o)),i.push(a));return new ft(r,i)},filter:function(t){"function"!=typeof t&&(t=m(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,a=e[i],o=a.length,l=r[i]=[],c=0;c<o;++c)(s=a[c])&&t.call(s,s.__data__,c,a)&&l.push(s);return new ft(r,this._parents)},data:function(t,e){if(!t)return f=new Array(this.size()),u=-1,this.each((function(t){f[++u]=t})),f;var n,r=e?w:x,i=this._parents,s=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=s.length,o=new Array(a),l=new Array(a),c=new Array(a),u=0;u<a;++u){var h=i[u],d=s[u],g=d.length,f=t.call(h,h&&h.__data__,u,i),p=f.length,m=l[u]=new Array(p),v=o[u]=new Array(p);r(h,d,m,v,c[u]=new Array(g),f,e);for(var y,b,$=0,S=0;$<p;++$)if(y=m[$]){for($>=S&&(S=$+1);!(b=v[S])&&++S<p;);y._next=b||null}}return(o=new ft(o,i))._enter=l,o._exit=c,o},enter:function(){return new ft(this._enter||this._groups.map(v),this._parents)},exit:function(){return new ft(this._exit||this._groups.map(v),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var l,c=e[o],u=n[o],h=c.length,d=a[o]=new Array(h),g=0;g<h;++g)(l=c[g]||u[g])&&(d[g]=l);for(;o<r;++o)a[o]=e[o];return new ft(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],s=i.length-1,a=i[s];--s>=0;)(r=i[s])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=$);for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var a,o=n[s],l=o.length,c=i[s]=new Array(l),u=0;u<l;++u)(a=o[u])&&(c[u]=a);c.sort(e)}return new ft(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,s=e[n],a=0,o=s.length;a<o;++a)(i=s[a])&&t.call(i,i.__data__,a,s);return this},attr:function(t,e){var n=s(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?A:S:"function"==typeof e?n.local?T:_:n.local?M:C)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?N:"function"==typeof e?L:R)(t,e,null==n?"":n)):E(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?P:"function"==typeof e?I:D)(t,e)):this.node()[t]},classed:function(t,e){var n=B(t+"");if(arguments.length<2){for(var r=O(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?U:e?j:q)(n,e))},text:function(t){return arguments.length?this.each(null==t?V:("function"==typeof t?Y:W)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?G:Z)(t)):this.node().innerHTML},raise:function(){return this.each(K)},lower:function(){return this.each(Q)},append:function(t){var e="function"==typeof t?t:l(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:l(t),r=null==e?J:"function"==typeof e?e:u(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(tt)},clone:function(t){return this.select(t?nt:et)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,s=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),a=s.length;if(!(arguments.length<2)){for(o=e?lt:ot,null==n&&(n=!1),r=0;r<a;++r)this.each(o(s[r],e,n));return this}var o=this.node().__on;if(o)for(var l,c=0,u=o.length;c<u;++c)for(r=0,l=o[c];r<a;++r)if((i=s[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?dt:ht)(t,e))}};const mt=pt;function vt(t){return"string"==typeof t?new ft([[document.querySelector(t)]],[document.documentElement]):new ft([[t]],gt)}function yt(t){return vt(l(t).call(document.documentElement))}var bt=0;function xt(){return new wt}function wt(){this._="@"+(++bt).toString(36)}function $t(){for(var t,e=it;t=e.sourceEvent;)e=t;return e}function St(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function At(t){var e=$t();return e.changedTouches&&(e=e.changedTouches[0]),St(t,e)}function Ct(t){return"string"==typeof t?new ft([document.querySelectorAll(t)],[document.documentElement]):new ft([null==t?[]:t],gt)}function Mt(t,e,n){arguments.length<3&&(n=e,e=$t().changedTouches);for(var r,i=0,s=e?e.length:0;i<s;++i)if((r=e[i]).identifier===n)return St(t,r);return null}function _t(t,e){null==e&&(e=$t().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=St(t,e[n]);return i}wt.prototype=xt.prototype={constructor:wt,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}}},2473:(t,e,n)=>{"use strict";n.r(e),n.d(e,{active:()=>Mt,interrupt:()=>B,transition:()=>yt});var r,i,s=n(4677),a=n(4594),o=0,l=0,c=0,u=1e3,h=0,d=0,g=0,f="object"==typeof performance&&performance.now?performance:Date,p="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function m(){return d||(p(v),d=f.now()+g)}function v(){d=0}function y(){this._call=this._time=this._next=null}function b(t,e,n){var r=new y;return r.restart(t,e,n),r}function x(){d=(h=f.now())+g,o=l=0;try{!function(){m(),++o;for(var t,e=r;e;)(t=d-e._time)>=0&&e._call.call(null,t),e=e._next;--o}()}finally{o=0,function(){var t,e,n=r,s=1/0;for(;n;)n._call?(s>n._time&&(s=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:r=e);i=t,$(s)}(),d=0}}function w(){var t=f.now(),e=t-h;e>u&&(g-=e,h=t)}function $(t){o||(l&&(l=clearTimeout(l)),t-d>24?(t<1/0&&(l=setTimeout(x,t-f.now()-g)),c&&(c=clearInterval(c))):(c||(h=f.now(),c=setInterval(w,u)),o=1,p(x)))}function S(t,e,n){var r=new y;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r}y.prototype=b.prototype={constructor:y,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?m():+n)+(null==e?0:+e),this._next||i===this||(i?i._next=this:r=this,i=this),this._call=t,this._time=n,$()},stop:function(){this._call&&(this._call=null,this._time=1/0,$())}};var A=(0,a.W)("start","end","cancel","interrupt"),C=[],M=0,_=1,T=2,k=3,N=4,R=5,L=6;function E(t,e,n,r,i,s){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function s(t){n.state=_,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(s){var c,u,h,d;if(n.state!==_)return l();for(c in i)if((d=i[c]).name===n.name){if(d.state===k)return S(a);d.state===N?(d.state=L,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[c]):+c<e&&(d.state=L,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[c])}if(S((function(){n.state===k&&(n.state=N,n.timer.restart(o,n.delay,n.time),o(s))})),n.state=T,n.on.call("start",t,t.__data__,n.index,n.group),n.state===T){for(n.state=k,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=R,1),s=-1,a=r.length;++s<a;)r[s].call(t,i);n.state===R&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=L,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=b(s,0,n.time)}(t,n,{name:e,index:r,group:i,on:A,tween:C,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:M})}function P(t,e){var n=I(t,e);if(n.state>M)throw new Error("too late; already scheduled");return n}function D(t,e){var n=I(t,e);if(n.state>k)throw new Error("too late; already running");return n}function I(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function B(t,e){var n,r,i,s=t.__transition,a=!0;if(s){for(i in e=null==e?null:e+"",s)(n=s[i]).name===e?(r=n.state>T&&n.state<R,n.state=L,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[i]):a=!1;a&&delete t.__transition}}var O,z,H,F,j=n(3626),q=180/Math.PI,U={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function V(t,e,n,r,i,s){var a,o,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*q,skewX:Math.atan(l)*q,scaleX:a,scaleY:o}}function W(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(s,a){var o=[],l=[];return s=t(s),a=t(a),function(t,r,i,s,a,o){if(t!==i||r!==s){var l=a.push("translate(",null,e,null,n);o.push({i:l-4,x:(0,j.Z)(t,i)},{i:l-2,x:(0,j.Z)(r,s)})}else(i||s)&&a.push("translate("+i+e+s+n)}(s.translateX,s.translateY,a.translateX,a.translateY,o,l),function(t,e,n,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:n.push(i(n)+"rotate(",null,r)-2,x:(0,j.Z)(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(s.rotate,a.rotate,o,l),function(t,e,n,s){t!==e?s.push({i:n.push(i(n)+"skewX(",null,r)-2,x:(0,j.Z)(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(s.skewX,a.skewX,o,l),function(t,e,n,r,s,a){if(t!==n||e!==r){var o=s.push(i(s)+"scale(",null,",",null,")");a.push({i:o-4,x:(0,j.Z)(t,n)},{i:o-2,x:(0,j.Z)(e,r)})}else 1===n&&1===r||s.push(i(s)+"scale("+n+","+r+")")}(s.scaleX,s.scaleY,a.scaleX,a.scaleY,o,l),s=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)o[(e=l[n]).i]=e.x(t);return o.join("")}}}var Y=W((function(t){return"none"===t?U:(O||(O=document.createElement("DIV"),z=document.documentElement,H=document.defaultView),O.style.transform=t,t=H.getComputedStyle(z.appendChild(O),null).getPropertyValue("transform"),z.removeChild(O),V(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),X=W((function(t){return null==t?U:(F||(F=document.createElementNS("http://www.w3.org/2000/svg","g")),F.setAttribute("transform",t),(t=F.transform.baseVal.consolidate())?V((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):U)}),", ",")",")");function Z(t,e){var n,r;return function(){var i=D(this,t),s=i.tween;if(s!==n)for(var a=0,o=(r=n=s).length;a<o;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function G(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var s=D(this,t),a=s.tween;if(a!==r){i=(r=a).slice();for(var o={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=o;break}l===c&&i.push(o)}s.tween=i}}function K(t,e,n){var r=t._id;return t.each((function(){var t=D(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return I(t,r).value[e]}}var Q=n(2650),J=n(7765),tt=n(9843);function et(t,e){var n;return("number"==typeof e?j.Z:e instanceof Q.ZP?J.ZP:(n=(0,Q.ZP)(e))?(e=n,J.ZP):tt.Z)(t,e)}function nt(t){return function(){this.removeAttribute(t)}}function rt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function it(t,e,n){var r,i,s=n+"";return function(){var a=this.getAttribute(t);return a===s?null:a===r?i:i=e(r=a,n)}}function st(t,e,n){var r,i,s=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===s?null:a===r?i:i=e(r=a,n)}}function at(t,e,n){var r,i,s;return function(){var a,o,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(o=l+"")?null:a===r&&o===i?s:(i=o,s=e(r=a,l));this.removeAttribute(t)}}function ot(t,e,n){var r,i,s;return function(){var a,o,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(o=l+"")?null:a===r&&o===i?s:(i=o,s=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function lt(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function ct(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function ut(t,e){return function(){P(this,t).delay=+e.apply(this,arguments)}}function ht(t,e){return e=+e,function(){P(this,t).delay=e}}function dt(t,e){return function(){D(this,t).duration=+e.apply(this,arguments)}}function gt(t,e){return e=+e,function(){D(this,t).duration=e}}var ft=s.selection.prototype.constructor;function pt(t){return function(){this.style.removeProperty(t)}}var mt=0;function vt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function yt(t){return(0,s.selection)().transition(t)}function bt(){return++mt}var xt=s.selection.prototype;vt.prototype=yt.prototype={constructor:vt,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=(0,s.selector)(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var l,c,u=r[o],h=u.length,d=a[o]=new Array(h),g=0;g<h;++g)(l=u[g])&&(c=t.call(l,l.__data__,g,u))&&("__data__"in l&&(c.__data__=l.__data__),d[g]=c,E(d[g],e,n,g,d,I(l,n)));return new vt(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=(0,s.selectorAll)(t));for(var r=this._groups,i=r.length,a=[],o=[],l=0;l<i;++l)for(var c,u=r[l],h=u.length,d=0;d<h;++d)if(c=u[d]){for(var g,f=t.call(c,c.__data__,d,u),p=I(c,n),m=0,v=f.length;m<v;++m)(g=f[m])&&E(g,e,n,m,f,p);a.push(f),o.push(c)}return new vt(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=(0,s.matcher)(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],l=o.length,c=r[i]=[],u=0;u<l;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&c.push(a);return new vt(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var l,c=e[o],u=n[o],h=c.length,d=a[o]=new Array(h),g=0;g<h;++g)(l=c[g]||u[g])&&(d[g]=l);for(;o<r;++o)a[o]=e[o];return new vt(a,this._parents,this._name,this._id)},selection:function(){return new ft(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=bt(),r=this._groups,i=r.length,s=0;s<i;++s)for(var a,o=r[s],l=o.length,c=0;c<l;++c)if(a=o[c]){var u=I(a,e);E(a,t,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new vt(r,this._parents,t,n)},call:xt.call,nodes:xt.nodes,node:xt.node,size:xt.size,empty:xt.empty,each:xt.each,on:function(t,e){var n=this._id;return arguments.length<2?I(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?P:D;return function(){var a=s(this,t),o=a.on;o!==r&&(i=(r=o).copy()).on(e,n),a.on=i}}(n,t,e))},attr:function(t,e){var n=(0,s.namespace)(t),r="transform"===n?X:et;return this.attrTween(t,"function"==typeof e?(n.local?ot:at)(n,r,K(this,"attr."+t,e)):null==e?(n.local?rt:nt)(n):(n.local?st:it)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=(0,s.namespace)(t);return this.tween(n,(r.local?lt:ct)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Y:et;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=(0,s.style)(this,t),o=(this.style.removeProperty(t),(0,s.style)(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,pt(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=(0,s.style)(this,t),l=n(this),c=l+"";return null==l&&(this.style.removeProperty(t),c=l=(0,s.style)(this,t)),o===c?null:o===r&&c===i?a:(i=c,a=e(r=o,l))}}(t,r,K(this,"style."+t,e))).each(function(t,e){var n,r,i,s,a="style."+e,o="end."+a;return function(){var l=D(this,t),c=l.on,u=null==l.value[a]?s||(s=pt(e)):void 0;c===n&&i===u||(r=(n=c).copy()).on(o,i=u),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=(0,s.style)(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function s(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,s,n)),r}return s._value=e,s}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(K(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=I(this.node(),n).tween,s=0,a=i.length;s<a;++s)if((r=i[s]).name===t)return r.value;return null}return this.each((null==e?Z:G)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ut:ht)(e,t)):I(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?dt:gt)(e,t)):I(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){D(this,t).ease=e}}(e,t)):I(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(s,a){var o={value:a},l={value:function(){0==--i&&s()}};n.each((function(){var n=D(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),n.on=e}))}))}};(function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n})(3),function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Math.PI;var wt=1.70158,$t=(function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(wt),function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(wt),function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(wt),2*Math.PI),St=(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=$t);function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*$t)},i.period=function(n){return t(e,n)},i}(1,.3),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=$t);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*$t)},i.period=function(n){return t(e,n)},i}(1,.3),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=$t);function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*$t)},i.period=function(n){return t(e,n)},i}(1,.3),{time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}});function At(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return St.time=m(),St;return n}s.selection.prototype.interrupt=function(t){return this.each((function(){B(this,t)}))},s.selection.prototype.transition=function(t){var e,n;t instanceof vt?(e=t._id,t=t._name):(e=bt(),(n=St).time=m(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var a,o=r[s],l=o.length,c=0;c<l;++c)(a=o[c])&&E(a,t,e,c,o,n||At(a,e));return new vt(r,this._parents,t,e)};var Ct=[null];function Mt(t,e){var n,r,i=t.__transition;if(i)for(r in e=null==e?null:e+"",i)if((n=i[r]).state>_&&n.name===e)return new vt([[t]],Ct,e,+r);return null}},4261:(t,e,n)=>{const r=n(4881),i=n(19),s=n(1479);var a=!("undefined"==typeof window||!window.document||!window.document.createElement),o={Version:"1.0.0"};o.Drawer=r,o.Parser=i,o.SvgDrawer=s,o.clean=function(t){return t.replace(/[^A-Za-z0-9@\.\+\-\?!\(\)\[\]\{\}/\\=#\$:\*]/g,"")},o.apply=function(t,e="canvas[data-smiles]",n="light",i=null){let s=new r(t),a=document.querySelectorAll(e);for(var l=0;l<a.length;l++){let t=a[l];o.parse(t.getAttribute("data-smiles"),(function(e){s.draw(e,t,n,!1)}),(function(t){i&&i(t)}))}},o.parse=function(t,e,n){try{e&&e(i.parse(t))}catch(t){n&&n(t)}},a&&(window.SmilesDrawer=o),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),n=e.length>>>0,r=arguments[1]>>0,i=r<0?Math.max(n+r,0):Math.min(r,n),s=arguments[2],a=void 0===s?n:s>>0,o=a<0?Math.max(n+a,0):Math.min(a,n);i<o;)e[i]=t,i++;return e}}),t.exports=o},6348:t=>{class e{static clone(t){let n=Array.isArray(t)?Array():{};for(let r in t){let i=t[r];"function"==typeof i.clone?n[r]=i.clone():n[r]="object"==typeof i?e.clone(i):i}return n}static equals(t,e){if(t.length!==e.length)return!1;let n=t.slice().sort(),r=e.slice().sort();for(var i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}static print(t){if(0==t.length)return"";let e="(";for(let n=0;n<t.length;n++)e+=t[n].id?t[n].id+", ":t[n]+", ";return e=e.substring(0,e.length-2),e+")"}static each(t,e){for(let n=0;n<t.length;n++)e(t[n])}static get(t,e,n){for(let r=0;r<t.length;r++)if(t[r][e]==n)return t[r]}static contains(t,e){if(e.property||e.func){if(e.func){for(let n=0;n<t.length;n++)if(e.func(t[n]))return!0}else for(let n=0;n<t.length;n++)if(t[n][e.property]==e.value)return!0}else for(let n=0;n<t.length;n++)if(t[n]==e.value)return!0;return!1}static intersection(t,e){let n=new Array;for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++)t[r]===e[i]&&n.push(t[r]);return n}static unique(t){let e={};return t.filter((function(t){return void 0===e[t]&&(e[t]=!0)}))}static count(t,e){let n=0;for(let r=0;r<t.length;r++)t[r]===e&&n++;return n}static toggle(t,e){let n=Array(),r=!1;for(let i=0;i<t.length;i++)t[i]!==e?n.push(t[i]):r=!0;return r||n.push(e),n}static remove(t,e){let n=Array();for(let r=0;r<t.length;r++)t[r]!==e&&n.push(t[r]);return n}static removeUnique(t,e){let n=t.indexOf(e);return n>-1&&t.splice(n,1),t}static removeAll(t,e){return t.filter((function(t){return-1===e.indexOf(t)}))}static merge(t,e){let n=new Array(t.length+e.length);for(let e=0;e<t.length;e++)n[e]=t[e];for(let r=0;r<e.length;r++)n[t.length+r]=e[r];return n}static containsAll(t,e){let n=0;for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++)t[r]===e[i]&&n++;return n===e.length}static sortByAtomicNumberDesc(t){let e=t.map((function(t,e){return{index:e,value:t.atomicNumber.split(".").map(Number)}}));return e.sort((function(t,e){let n=Math.min(e.value.length,t.value.length),r=0;for(;r<n&&e.value[r]===t.value[r];)r++;return r===n?e.value.length-t.value.length:e.value[r]-t.value[r]})),e.map((function(e){return t[e.index]}))}static deepCopy(t){let n=Array();for(let r=0;r<t.length;r++){let i=t[r];n[r]=i instanceof Array?e.deepCopy(i):i}return n}}t.exports=e},2427:(t,e,n)=>{const r=n(6348);n(6843),n(6421);class i{constructor(t,e="-"){this.element=1===t.length?t.toUpperCase():t,this.drawExplicit=!1,this.ringbonds=Array(),this.rings=Array(),this.bondType=e,this.branchBond=null,this.isBridge=!1,this.isBridgeNode=!1,this.originalRings=Array(),this.bridgedRing=null,this.anchoredRings=Array(),this.bracket=null,this.plane=0,this.attachedPseudoElements={},this.hasAttachedPseudoElements=!1,this.isDrawn=!0,this.isConnectedToRing=!1,this.neighbouringElements=Array(),this.isPartOfAromaticRing=t!==this.element,this.bondCount=0,this.chirality="",this.isStereoCenter=!1,this.priority=0,this.mainChain=!1,this.hydrogenDirection="down",this.subtreeDepth=1,this.hasHydrogen=!1}addNeighbouringElement(t){this.neighbouringElements.push(t)}attachPseudoElement(t,e,n=0,r=0){null===n&&(n=0),null===r&&(r=0);let i=n+t+r;this.attachedPseudoElements[i]?this.attachedPseudoElements[i].count+=1:this.attachedPseudoElements[i]={element:t,count:1,hydrogenCount:n,previousElement:e,charge:r},this.hasAttachedPseudoElements=!0}getAttachedPseudoElements(){let t={},e=this;return Object.keys(this.attachedPseudoElements).sort().forEach((function(n){t[n]=e.attachedPseudoElements[n]})),t}getAttachedPseudoElementsCount(){return Object.keys(this.attachedPseudoElements).length}isHeteroAtom(){return"C"!==this.element&&"H"!==this.element}addAnchoredRing(t){r.contains(this.anchoredRings,{value:t})||this.anchoredRings.push(t)}getRingbondCount(){return this.ringbonds.length}backupRings(){this.originalRings=Array(this.rings.length);for(let t=0;t<this.rings.length;t++)this.originalRings[t]=this.rings[t]}restoreRings(){this.rings=Array(this.originalRings.length);for(let t=0;t<this.originalRings.length;t++)this.rings[t]=this.originalRings[t]}haveCommonRingbond(t,e){for(let n=0;n<t.ringbonds.length;n++)for(let r=0;r<e.ringbonds.length;r++)if(t.ringbonds[n].id==e.ringbonds[r].id)return!0;return!1}neighbouringElementsEqual(t){if(t.length!==this.neighbouringElements.length)return!1;t.sort(),this.neighbouringElements.sort();for(var e=0;e<this.neighbouringElements.length;e++)if(t[e]!==this.neighbouringElements[e])return!1;return!0}getAtomicNumber(){return i.atomicNumbers[this.element]}getMaxBonds(){return i.maxBonds[this.element]}static get maxBonds(){return{H:1,C:4,N:3,O:2,P:3,S:2,B:3,F:1,I:1,Cl:1,Br:1}}static get atomicNumbers(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}static get mass(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}}t.exports=i},8841:(t,e,n)=>{const r=n(5474),i=n(2614),{getChargeText:s}=(n(929),n(6843),n(6421),n(537));t.exports=class{constructor(t,e,n){this.canvas="string"==typeof t||t instanceof String?document.getElementById(t):t,this.ctx=this.canvas.getContext("2d"),this.themeManager=e,this.opts=n,this.drawingWidth=0,this.drawingHeight=0,this.offsetX=0,this.offsetY=0,this.fontLarge=this.opts.fontSizeLarge+"pt Helvetica, Arial, sans-serif",this.fontSmall=this.opts.fontSizeSmall+"pt Helvetica, Arial, sans-serif",this.updateSize(this.opts.width,this.opts.height),this.ctx.font=this.fontLarge,this.hydrogenWidth=this.ctx.measureText("H").width,this.halfHydrogenWidth=this.hydrogenWidth/2,this.halfBondThickness=this.opts.bondThickness/2}updateSize(t,e){this.devicePixelRatio=window.devicePixelRatio||1,this.backingStoreRatio=this.ctx.webkitBackingStorePixelRatio||this.ctx.mozBackingStorePixelRatio||this.ctx.msBackingStorePixelRatio||this.ctx.oBackingStorePixelRatio||this.ctx.backingStorePixelRatio||1,this.ratio=this.devicePixelRatio/this.backingStoreRatio,1!==this.ratio?(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.ctx.setTransform(this.ratio,0,0,this.ratio,0,0)):(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio)}setTheme(t){this.colors=t}scale(t){let e=-Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=Number.MAX_VALUE;for(var s=0;s<t.length;s++){if(!t[s].value.isDrawn)continue;let a=t[s].position;e<a.x&&(e=a.x),n<a.y&&(n=a.y),r>a.x&&(r=a.x),i>a.y&&(i=a.y)}var a=this.opts.padding;e+=a,n+=a,r-=a,i-=a,this.drawingWidth=e-r,this.drawingHeight=n-i;var o=this.canvas.offsetWidth/this.drawingWidth,l=this.canvas.offsetHeight/this.drawingHeight,c=o<l?o:l;this.ctx.scale(c,c),this.offsetX=-r,this.offsetY=-i,o<l?this.offsetY+=this.canvas.offsetHeight/(2*c)-this.drawingHeight/2:this.offsetX+=this.canvas.offsetWidth/(2*c)-this.drawingWidth/2}reset(){this.ctx.setTransform(1,0,0,1,0,0)}getColor(t){return(t=t.toUpperCase())in this.colors?this.colors[t]:this.colors.C}drawCircle(t,e,n,i,s=!0,a=!1,o=""){let l=this.ctx,c=this.offsetX,u=this.offsetY;l.save(),l.lineWidth=1.5,l.beginPath(),l.arc(t+c,e+u,n,0,r.twoPI,!0),l.closePath(),a?(s?(l.fillStyle="#f00",l.fill()):(l.strokeStyle="#f00",l.stroke()),this.drawDebugText(t,e,o)):s?(l.fillStyle=i,l.fill()):(l.strokeStyle=i,l.stroke()),l.restore()}drawLine(t,e=!1,n=1){let r=this.ctx,i=this.offsetX,s=this.offsetY,a=t.clone().shorten(4),o=a.getLeftVector().clone(),l=a.getRightVector().clone();o.x+=i,o.y+=s,l.x+=i,l.y+=s,e||(r.save(),r.globalCompositeOperation="destination-out",r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(l.x,l.y),r.lineCap="round",r.lineWidth=this.opts.bondThickness+1.2,r.strokeStyle=this.themeManager.getColor("BACKGROUND"),r.stroke(),r.globalCompositeOperation="source-over",r.restore()),o=t.getLeftVector().clone(),l=t.getRightVector().clone(),o.x+=i,o.y+=s,l.x+=i,l.y+=s,r.save(),r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(l.x,l.y),r.lineCap="round",r.lineWidth=this.opts.bondThickness;let c=this.ctx.createLinearGradient(o.x,o.y,l.x,l.y);c.addColorStop(.4,this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),c.addColorStop(.6,this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C")),e&&(r.setLineDash([1,1.5]),r.lineWidth=this.opts.bondThickness/1.5),n<1&&(r.globalAlpha=n),r.strokeStyle=c,r.stroke(),r.restore()}drawWedge(t,e=1){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let n=this.ctx,r=this.offsetX,s=this.offsetY,a=t.clone().shorten(5),o=a.getLeftVector().clone(),l=a.getRightVector().clone();o.x+=r,o.y+=s,l.x+=r,l.y+=s,o=t.getLeftVector().clone(),l=t.getRightVector().clone(),o.x+=r,o.y+=s,l.x+=r,l.y+=s,n.save();let c=i.normals(o,l);c[0].normalize(),c[1].normalize();let u=o,h=l;t.getRightChiral()&&(u=l,h=o);let d=i.add(u,i.multiplyScalar(c[0],this.halfBondThickness)),g=i.add(h,i.multiplyScalar(c[0],1.5+this.halfBondThickness)),f=i.add(h,i.multiplyScalar(c[1],1.5+this.halfBondThickness)),p=i.add(u,i.multiplyScalar(c[1],this.halfBondThickness));n.beginPath(),n.moveTo(d.x,d.y),n.lineTo(g.x,g.y),n.lineTo(f.x,f.y),n.lineTo(p.x,p.y);let m=this.ctx.createRadialGradient(l.x,l.y,this.opts.bondLength,l.x,l.y,0);m.addColorStop(.4,this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),m.addColorStop(.6,this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C")),n.fillStyle=m,n.fill(),n.restore()}drawDashedWedge(t){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let e=this.ctx,n=this.offsetX,r=this.offsetY,s=t.getLeftVector().clone(),a=t.getRightVector().clone();s.x+=n,s.y+=r,a.x+=n,a.y+=r,e.save();let o=i.normals(s,a);o[0].normalize(),o[1].normalize();let l,c,u,h,d=t.getRightChiral(),g=t.clone();d?(l=a,c=s,g.shortenRight(1),u=g.getRightVector().clone(),h=g.getLeftVector().clone()):(l=s,c=a,g.shortenLeft(1),u=g.getLeftVector().clone(),h=g.getRightVector().clone()),u.x+=n,u.y+=r,h.x+=n,h.y+=r;let f=i.subtract(c,l).normalize();e.strokeStyle=this.themeManager.getColor("C"),e.lineCap="round",e.lineWidth=this.opts.bondThickness,e.beginPath();let p=t.getLength(),m=1.25/(p/(3*this.opts.bondThickness)),v=!1;for(var y=0;y<1;y+=m){let n=i.multiplyScalar(f,y*p),r=i.add(l,n),s=1.5*y,a=i.multiplyScalar(o[0],s);!v&&y>.5&&(e.stroke(),e.beginPath(),e.strokeStyle=this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C"),v=!0),r.subtract(a),e.moveTo(r.x,r.y),r.add(i.multiplyScalar(a,2)),e.lineTo(r.x,r.y)}e.stroke(),e.restore()}drawDebugText(t,e,n){let r=this.ctx;r.save(),r.font="5px Droid Sans, sans-serif",r.textAlign="start",r.textBaseline="top",r.fillStyle="#ff0000",r.fillText(n,t+this.offsetX,e+this.offsetY),r.restore()}drawBall(t,e,n){let i=this.ctx;i.save(),i.beginPath(),i.arc(t+this.offsetX,e+this.offsetY,this.opts.bondLength/4.5,0,r.twoPI,!1),i.fillStyle=this.themeManager.getColor(n),i.fill(),i.restore()}drawPoint(t,e,n){let i=this.ctx,s=this.offsetX,a=this.offsetY;i.save(),i.globalCompositeOperation="destination-out",i.beginPath(),i.arc(t+s,e+a,1.5,0,r.twoPI,!0),i.closePath(),i.fill(),i.globalCompositeOperation="source-over",i.beginPath(),i.arc(t+this.offsetX,e+this.offsetY,.75,0,r.twoPI,!1),i.fillStyle=this.themeManager.getColor(n),i.fill(),i.restore()}drawText(t,e,n,i,a,o,l,c,u={}){let h=this.ctx,d=this.offsetX,g=this.offsetY;h.save(),h.textAlign="start",h.textBaseline="alphabetic";let f="",p=0;l&&(f=s(l),h.font=this.fontSmall,p=h.measureText(f).width);let m="0",v=0;c>0&&(m=c.toString(),h.font=this.fontSmall,v=h.measureText(m).width),1===l&&"N"===n&&u.hasOwnProperty("0O")&&u.hasOwnProperty("0O-1")&&(u={"0O":{element:"O",count:2,hydrogenCount:0,previousElement:"C",charge:""}},l=0),h.font=this.fontLarge,h.fillStyle=this.themeManager.getColor("BACKGROUND");let y=h.measureText(n);y.totalWidth=y.width+p,y.height=parseInt(this.fontLarge,10);let b=y.width>this.opts.fontSizeLarge?y.width:this.opts.fontSizeLarge;b/=1.5,h.globalCompositeOperation="destination-out",h.beginPath(),h.arc(t+d,e+g,b,0,r.twoPI,!0),h.closePath(),h.fill(),h.globalCompositeOperation="source-over";let x=-y.width/2,w=-y.width/2;h.fillStyle=this.themeManager.getColor(n),h.fillText(n,t+d+x,e+this.opts.halfFontSizeLarge+g),x+=y.width,l&&(h.font=this.fontSmall,h.fillText(f,t+d+x,e-this.opts.fifthFontSizeSmall+g),x+=p),c>0&&(h.font=this.fontSmall,h.fillText(m,t+d+w-v,e-this.opts.fifthFontSizeSmall+g),w-=v),h.font=this.fontLarge;let $=0,S=0;if(1===i){let n=t+d,r=e+g+this.opts.halfFontSizeLarge;$=this.hydrogenWidth,w-=$,"left"===a?n+=w:"right"===a||"up"===a&&o||"down"===a&&o?n+=x:"up"!==a||o?"down"!==a||o||(r+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth):(r-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth),h.fillText("H",n,r),x+=$}else if(i>1){let n=t+d,r=e+g+this.opts.halfFontSizeLarge;$=this.hydrogenWidth,h.font=this.fontSmall,S=h.measureText(i).width,w-=$+S,"left"===a?n+=w:"right"===a||"up"===a&&o||"down"===a&&o?n+=x:"up"!==a||o?"down"!==a||o||(r+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth):(r-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth),h.font=this.fontLarge,h.fillText("H",n,r),h.font=this.fontSmall,h.fillText(i,n+this.halfHydrogenWidth+S,r+this.opts.fifthFontSizeSmall),x+=$+this.halfHydrogenWidth+S}for(let n in u){if(!u.hasOwnProperty(n))continue;let r=0,i=0,o=u[n].element,l=u[n].count,c=u[n].hydrogenCount,f=u[n].charge;h.font=this.fontLarge,l>1&&c>0&&(r=h.measureText("(").width,i=h.measureText(")").width);let p=h.measureText(o).width,m=0,v="",y=0;$=0,c>0&&($=this.hydrogenWidth),h.font=this.fontSmall,l>1&&(m=h.measureText(l).width),0!==f&&(v=s(f),y=h.measureText(v).width),S=0,c>1&&(S=h.measureText(c).width),h.font=this.fontLarge;let b=t+d,A=e+g+this.opts.halfFontSizeLarge;h.fillStyle=this.themeManager.getColor(o),l>0&&(w-=m),l>1&&c>0&&("left"===a?(w-=i,h.fillText(")",b+w,A)):(h.fillText("(",b+x,A),x+=r)),"left"===a?(w-=p,h.fillText(o,b+w,A)):(h.fillText(o,b+x,A),x+=p),c>0&&("left"===a?(w-=$+S,h.fillText("H",b+w,A),c>1&&(h.font=this.fontSmall,h.fillText(c,b+w+$,A+this.opts.fifthFontSizeSmall))):(h.fillText("H",b+x,A),x+=$,c>1&&(h.font=this.fontSmall,h.fillText(c,b+x,A+this.opts.fifthFontSizeSmall),x+=S))),h.font=this.fontLarge,l>1&&c>0&&("left"===a?(w-=r,h.fillText("(",b+w,A)):(h.fillText(")",b+x,A),x+=i)),h.font=this.fontSmall,l>1&&("left"===a?h.fillText(l,b+w+r+i+$+S+p,A+this.opts.fifthFontSizeSmall):(h.fillText(l,b+x,A+this.opts.fifthFontSizeSmall),x+=m)),0!==f&&("left"===a?h.fillText(v,b+w+r+i+$+S+p,e-this.opts.fifthFontSizeSmall+g):(h.fillText(v,b+x,e-this.opts.fifthFontSizeSmall+g),x+=y))}h.restore()}getChargeText(t){return 1===t?"+":2===t?"2+":-1===t?"-":-2===t?"2-":""}drawDebugPoint(t,e,n="",r="#f00"){this.drawCircle(t,e,2,r,!0,!0,n)}drawAromaticityRing(t){let e=this.ctx,n=r.apothemFromSideLength(this.opts.bondLength,t.getSize());e.save(),e.strokeStyle=this.themeManager.getColor("C"),e.lineWidth=this.opts.bondThickness,e.beginPath(),e.arc(t.center.x+this.offsetX,t.center.y+this.offsetY,n-this.opts.bondSpacing,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.restore()}clear(){this.ctx.clearRect(0,0,this.canvas.offsetWidth,this.canvas.offsetHeight)}}},4881:(t,e,n)=>{const r=n(5474),i=n(6348),s=n(2614),a=n(929),o=(n(6843),n(6826)),l=n(2427),c=n(6421),u=n(3333),h=n(8841),d=n(4707),g=n(1681),f=n(6654);t.exports=class{constructor(t){this.graph=null,this.doubleBondConfigCount=0,this.doubleBondConfig=null,this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.canvasWrapper=null,this.totalOverlapScore=0,this.defaultOptions={width:500,height:500,bondThickness:.6,bondLength:15,shortBondLength:.85,bondSpacing:.18*15,atomVisualization:"default",isomeric:!0,debug:!1,terminalCarbons:!1,explicitHydrogens:!0,overlapSensitivity:.42,overlapResolutionIterations:1,compactDrawing:!0,fontSizeLarge:5,fontSizeSmall:3,padding:20,experimentalSSSR:!1,kkThreshold:.1,kkInnerThreshold:.1,kkMaxIteration:2e4,kkMaxInnerIteration:50,kkMaxEnergy:1e9,themes:{dark:{C:"#fff",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#fff",BACKGROUND:"#141414"},light:{C:"#222",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#222",BACKGROUND:"#fff"}}},this.opts=this.extend(!0,this.defaultOptions,t),this.opts.halfBondSpacing=this.opts.bondSpacing/2,this.opts.bondLengthSq=this.opts.bondLength*this.opts.bondLength,this.opts.halfFontSizeLarge=this.opts.fontSizeLarge/2,this.opts.quarterFontSizeLarge=this.opts.fontSizeLarge/4,this.opts.fifthFontSizeSmall=this.opts.fontSizeSmall/5,this.theme=this.opts.themes.dark}extend(){let t=this,e={},n=!1,r=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],r++);let s=function(r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n&&"[object Object]"===Object.prototype.toString.call(r[i])?e[i]=t.extend(!0,e[i],r[i]):e[i]=r[i])};for(;r<i;r++){s(arguments[r])}return e}draw(t,e,n="light",r=!1){this.initDraw(t,n,r),this.infoOnly||(this.themeManager=new f(this.opts.themes,n),this.canvasWrapper=new h(e,this.themeManager,this.opts)),r||(this.processGraph(),this.canvasWrapper.scale(this.graph.vertices),this.drawEdges(this.opts.debug),this.drawVertices(this.opts.debug),this.canvasWrapper.reset(),this.opts.debug&&(console.log(this.graph),console.log(this.rings),console.log(this.ringConnections)))}edgeRingCount(t){let e=this.graph.edges[t],n=this.graph.vertices[e.sourceId],r=this.graph.vertices[e.targetId];return Math.min(n.value.rings.length,r.value.rings.length)}getBridgedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isBridged&&t.push(this.rings[e]);return t}getFusedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isFused&&t.push(this.rings[e]);return t}getSpiros(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isSpiro&&t.push(this.rings[e]);return t}printRingInfo(){let t="";for(var e=0;e<this.rings.length;e++){const n=this.rings[e];t+=n.id+";",t+=n.members.length+";",t+=n.neighbours.length+";",t+=n.isSpiro?"true;":"false;",t+=n.isFused?"true;":"false;",t+=n.isBridged?"true;":"false;",t+=n.rings.length+";",t+="\n"}return t}rotateDrawing(){let t=0,e=0,n=0;for(var r=0;r<this.graph.vertices.length;r++){let s=this.graph.vertices[r];if(s.value.isDrawn)for(var i=r+1;i<this.graph.vertices.length;i++){let a=this.graph.vertices[i];if(!a.value.isDrawn)continue;let o=s.position.distanceSq(a.position);o>n&&(n=o,t=r,e=i)}}let a=-s.subtract(this.graph.vertices[t].position,this.graph.vertices[e].position).angle();if(!isNaN(a)){let t=a%.523599;t<.2617995?a-=t:a+=.523599-t;for(r=0;r<this.graph.vertices.length;r++)r!==e&&this.graph.vertices[r].position.rotateAround(a,this.graph.vertices[e].position);for(r=0;r<this.rings.length;r++)this.rings[r].center.rotateAround(a,this.graph.vertices[e].position)}}getTotalOverlapScore(){return this.totalOverlapScore}getRingCount(){return this.rings.length}hasBridgedRing(){return this.bridgedRing}getHeavyAtomCount(){let t=0;for(var e=0;e<this.graph.vertices.length;e++)"H"!==this.graph.vertices[e].value.element&&t++;return t}getMolecularFormula(){let t="",e=new Map;for(var n=0;n<this.graph.vertices.length;n++){let t=this.graph.vertices[n].value;if(e.has(t.element)?e.set(t.element,e.get(t.element)+1):e.set(t.element,1),t.bracket&&!t.bracket.chirality&&(e.has("H")?e.set("H",e.get("H")+t.bracket.hcount):e.set("H",t.bracket.hcount)),!t.bracket){let n=l.maxBonds[t.element]-t.bondCount;t.isPartOfAromaticRing&&n--,e.has("H")?e.set("H",e.get("H")+n):e.set("H",n)}}if(e.has("C")){let n=e.get("C");t+="C"+(n>1?n:""),e.delete("C")}if(e.has("H")){let n=e.get("H");t+="H"+(n>1?n:""),e.delete("H")}return Object.keys(l.atomicNumbers).sort().map((n=>{if(e.has(n)){let r=e.get(n);t+=n+(r>1?r:"")}})),t}getRingbondType(t,e){if(t.value.getRingbondCount()<1||e.value.getRingbondCount()<1)return null;for(var n=0;n<t.value.ringbonds.length;n++)for(var r=0;r<e.value.ringbonds.length;r++)if(t.value.ringbonds[n].id===e.value.ringbonds[r].id)return"-"===t.value.ringbonds[n].bondType?e.value.ringbonds[r].bond:t.value.ringbonds[n].bond;return null}initDraw(t,e,n){this.data=t,this.infoOnly=n,this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.graph=new d(t,this.opts.isomeric),this.rings=Array(),this.ringConnections=Array(),this.originalRings=Array(),this.originalRingConnections=Array(),this.bridgedRing=!1,this.doubleBondConfigCount=null,this.doubleBondConfig=null,this.initRings(),this.initHydrogens()}processGraph(){this.position(),this.restoreRingInformation(),this.resolvePrimaryOverlaps();let t=this.getOverlapScore();this.totalOverlapScore=this.getOverlapScore().total;for(var e=0;e<this.opts.overlapResolutionIterations;e++)for(var n=0;n<this.graph.edges.length;n++){let e=this.graph.edges[n];if(this.isEdgeRotatable(e)){let n=this.graph.getTreeDepth(e.sourceId,e.targetId),i=this.graph.getTreeDepth(e.targetId,e.sourceId),s=e.targetId,a=e.sourceId;if(n>i&&(s=e.sourceId,a=e.targetId),this.getSubtreeOverlapScore(a,s,t.vertexScores).value>this.opts.overlapSensitivity){let e=this.graph.vertices[s],n=this.graph.vertices[a],i=n.getNeighbours(s);if(1===i.length){let t=this.graph.vertices[i[0]],s=t.position.getRotateAwayFromAngle(e.position,n.position,r.toRad(120));this.rotateSubtree(t.id,n.id,s,n.position);let a=this.getOverlapScore().total;a>this.totalOverlapScore?this.rotateSubtree(t.id,n.id,-s,n.position):this.totalOverlapScore=a}else if(2===i.length){if(0!==n.value.rings.length&&0!==e.value.rings.length)continue;let t=this.graph.vertices[i[0]],s=this.graph.vertices[i[1]];if(1===t.value.rings.length&&1===s.value.rings.length){if(t.value.rings[0]!==s.value.rings[0])continue}else{if(0!==t.value.rings.length||0!==s.value.rings.length)continue;{let i=t.position.getRotateAwayFromAngle(e.position,n.position,r.toRad(120)),a=s.position.getRotateAwayFromAngle(e.position,n.position,r.toRad(120));this.rotateSubtree(t.id,n.id,i,n.position),this.rotateSubtree(s.id,n.id,a,n.position);let o=this.getOverlapScore().total;o>this.totalOverlapScore?(this.rotateSubtree(t.id,n.id,-i,n.position),this.rotateSubtree(s.id,n.id,-a,n.position)):this.totalOverlapScore=o}}}t=this.getOverlapScore()}}}this.resolveSecondaryOverlaps(t.scores),this.opts.isomeric&&this.annotateStereochemistry(),this.opts.compactDrawing&&"default"===this.opts.atomVisualization&&this.initPseudoElements(),this.rotateDrawing()}initRings(){let t=new Map;for(var e=this.graph.vertices.length-1;e>=0;e--){let r=this.graph.vertices[e];if(0!==r.value.ringbonds.length)for(var n=0;n<r.value.ringbonds.length;n++){let e=r.value.ringbonds[n].id,i=r.value.ringbonds[n].bond;if(t.has(e)){let s=r.id,a=t.get(e)[0],l=t.get(e)[1],c=new o(s,a,1);c.setBondType(l||i||"-");let u=this.graph.addEdge(c),h=this.graph.vertices[a];r.addRingbondChild(a,n),r.value.addNeighbouringElement(h.value.element),h.addRingbondChild(s,n),h.value.addNeighbouringElement(r.value.element),r.edges.push(u),h.edges.push(u),t.delete(e)}else t.set(e,[r.id,i])}}let r=g.getRings(this.graph,this.opts.experimentalSSSR);if(null!==r){for(e=0;e<r.length;e++){let t=[...r[e]],i=this.addRing(new c(t));for(n=0;n<t.length;n++)this.graph.vertices[t[n]].value.rings.push(i)}for(e=0;e<this.rings.length-1;e++)for(n=e+1;n<this.rings.length;n++){let t=this.rings[e],r=this.rings[n],i=new u(t,r);i.vertices.size>0&&this.addRingConnection(i)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];t.neighbours=u.getNeighbours(this.ringConnections,t.id)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];this.graph.vertices[t.members[0]].value.addAnchoredRing(t.id)}for(this.backupRingInformation();this.rings.length>0;){let t=-1;for(e=0;e<this.rings.length;e++){let n=this.rings[e];this.isPartOfBridgedRing(n.id)&&!n.isBridged&&(t=n.id)}if(-1===t)break;let n=this.getRing(t),r=this.getBridgedRingRings(n.id);this.bridgedRing=!0,this.createBridgedRing(r,n.members[0]);for(e=0;e<r.length;e++)this.removeRing(r[e])}}}initHydrogens(){if(!this.opts.explicitHydrogens)for(var t=0;t<this.graph.vertices.length;t++){let e=this.graph.vertices[t];if("H"!==e.value.element)continue;let n=this.graph.vertices[e.neighbours[0]];n.value.hasHydrogen=!0,(!n.value.isStereoCenter||n.value.rings.length<2&&!n.value.bridgedRing||n.value.bridgedRing&&n.value.originalRings.length<2)&&(e.value.isDrawn=!1)}}getBridgedRingRings(t){let e=Array(),n=this,r=function(t){let i=n.getRing(t);e.push(t);for(var s=0;s<i.neighbours.length;s++){let a=i.neighbours[s];-1===e.indexOf(a)&&a!==t&&u.isBridge(n.ringConnections,n.graph.vertices,t,a)&&r(a)}};return r(t),i.unique(e)}isPartOfBridgedRing(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].containsRing(t)&&this.ringConnections[e].isBridge(this.graph.vertices))return!0;return!1}createBridgedRing(t,e){let n=new Set,r=new Set,s=new Set;for(var a=0;a<t.length;a++){let e=this.getRing(t[a]);e.isPartOfBridged=!0;for(var o=0;o<e.members.length;o++)r.add(e.members[o]);for(o=0;o<e.neighbours.length;o++){let n=e.neighbours[o];-1===t.indexOf(n)&&s.add(e.neighbours[o])}}let l=new Set;for(let e of r){let r=this.graph.vertices[e],s=i.intersection(t,r.value.rings);1===r.value.rings.length||1===s.length?n.add(r.id):l.add(r.id)}Array();let u=Array();for(let t of l){let e=this.graph.vertices[t],r=!1;for(let t=0;t<e.edges.length;t++)1===this.edgeRingCount(e.edges[t])&&(r=!0);r?(e.value.isBridgeNode=!0,n.add(e.id)):(e.value.isBridge=!0,n.add(e.id))}let h=new c([...n]);this.addRing(h),h.isBridged=!0,h.neighbours=[...s];for(a=0;a<t.length;a++)h.rings.push(this.getRing(t[a]).clone());for(a=0;a<h.members.length;a++)this.graph.vertices[h.members[a]].value.bridgedRing=h.id;for(a=0;a<u.length;a++){this.graph.vertices[u[a]].value.rings=Array()}for(let e of n){let n=this.graph.vertices[e];n.value.rings=i.removeAll(n.value.rings,t),n.value.rings.push(h.id)}for(a=0;a<t.length;a++)for(o=a+1;o<t.length;o++)this.removeRingConnectionsBetween(t[a],t[o]);for(let e of s){let n=this.getRingConnections(e,t);for(o=0;o<n.length;o++)this.getRingConnection(n[o]).updateOther(h.id,e);this.getRing(e).neighbours.push(h.id)}return h}areVerticesInSameRing(t,e){for(var n=0;n<t.value.rings.length;n++)for(var r=0;r<e.value.rings.length;r++)if(t.value.rings[n]===e.value.rings[r])return!0;return!1}getCommonRings(t,e){let n=Array();for(var r=0;r<t.value.rings.length;r++)for(var i=0;i<e.value.rings.length;i++)t.value.rings[r]==e.value.rings[i]&&n.push(t.value.rings[r]);return n}getLargestOrAromaticCommonRing(t,e){let n=this.getCommonRings(t,e),r=0,i=null;for(var s=0;s<n.length;s++){let t=this.getRing(n[s]),e=t.getSize();if(t.isBenzeneLike(this.graph.vertices))return t;e>r&&(r=e,i=t)}return i}getVerticesAt(t,e,n){let r=Array();for(var i=0;i<this.graph.vertices.length;i++){let s=this.graph.vertices[i];s.id!==n&&s.positioned&&(t.distanceSq(s.position)<=e*e&&r.push(s.id))}return r}getClosestVertex(t){let e=99999,n=null;for(var r=0;r<this.graph.vertices.length;r++){let i=this.graph.vertices[r];if(i.id===t.id)continue;let s=t.position.distanceSq(i.position);s<e&&(e=s,n=i)}return n}addRing(t){return t.id=this.ringIdCounter++,this.rings.push(t),t.id}removeRing(t){this.rings=this.rings.filter((function(e){return e.id!==t})),this.ringConnections=this.ringConnections.filter((function(e){return e.firstRingId!==t&&e.secondRingId!==t}));for(var e=0;e<this.rings.length;e++){let n=this.rings[e];n.neighbours=n.neighbours.filter((function(e){return e!==t}))}}getRing(t){for(var e=0;e<this.rings.length;e++)if(this.rings[e].id==t)return this.rings[e]}addRingConnection(t){return t.id=this.ringConnectionIdCounter++,this.ringConnections.push(t),t.id}removeRingConnection(t){this.ringConnections=this.ringConnections.filter((function(e){return e.id!==t}))}removeRingConnectionsBetween(t,e){let n=Array();for(var r=0;r<this.ringConnections.length;r++){let i=this.ringConnections[r];(i.firstRingId===t&&i.secondRingId===e||i.firstRingId===e&&i.secondRingId===t)&&n.push(i.id)}for(r=0;r<n.length;r++)this.removeRingConnection(n[r])}getRingConnection(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].id==t)return this.ringConnections[e]}getRingConnections(t,e){let n=Array();for(var r=0;r<this.ringConnections.length;r++){let s=this.ringConnections[r];for(var i=0;i<e.length;i++){let r=e[i];(s.firstRingId===t&&s.secondRingId===r||s.firstRingId===r&&s.secondRingId===t)&&n.push(s.id)}}return n}getOverlapScore(){let t=0,e=new Float32Array(this.graph.vertices.length);for(var n=0;n<this.graph.vertices.length;n++)e[n]=0;for(n=0;n<this.graph.vertices.length;n++)for(var r=this.graph.vertices.length;--r>n;){let i=this.graph.vertices[n],a=this.graph.vertices[r];if(!i.value.isDrawn||!a.value.isDrawn)continue;let o=s.subtract(i.position,a.position).lengthSq();if(o<this.opts.bondLengthSq){let i=(this.opts.bondLength-Math.sqrt(o))/this.opts.bondLength;t+=i,e[n]+=i,e[r]+=i}}let i=Array();for(n=0;n<this.graph.vertices.length;n++)i.push({id:n,score:e[n]});return i.sort((function(t,e){return e.score-t.score})),{total:t,scores:i,vertexScores:e}}chooseSide(t,e,n){let r=t.getNeighbours(e.id),s=e.getNeighbours(t.id),a=r.length,o=s.length,l=i.merge(r,s),c=[0,0];for(var u=0;u<l.length;u++){this.graph.vertices[l[u]].position.sameSideAs(t.position,e.position,n[0])?c[0]++:c[1]++}let h=[0,0];for(u=0;u<this.graph.vertices.length;u++){this.graph.vertices[u].position.sameSideAs(t.position,e.position,n[0])?h[0]++:h[1]++}return{totalSideCount:h,totalPosition:h[0]>h[1]?0:1,sideCount:c,position:c[0]>c[1]?0:1,anCount:a,bnCount:o}}setRingCenter(t){let e=t.getSize(),n=new s(0,0);for(var r=0;r<e;r++)n.add(this.graph.vertices[t.members[r]].position);t.center=n.divide(e)}getSubringCenter(t,e){let n=e.value.originalRings,r=t.center,i=Number.MAX_VALUE;for(var s=0;s<n.length;s++)for(var a=0;a<t.rings.length;a++)n[s]===t.rings[a].id&&t.rings[a].getSize()<i&&(r=t.rings[a].center,i=t.rings[a].getSize());return r}drawEdges(t){let e=this,n=Array(this.graph.edges.length);if(n.fill(!1),this.graph.traverseBF(0,(function(r){let i=e.graph.getEdges(r.id);for(var s=0;s<i.length;s++){let r=i[s];n[r]||(n[r]=!0,e.drawEdge(r,t))}})),!this.bridgedRing)for(var r=0;r<this.rings.length;r++){let t=this.rings[r];this.isRingAromatic(t)&&this.canvasWrapper.drawAromaticityRing(t)}}drawEdge(t,e){let n=this,r=this.graph.edges[t],o=this.graph.vertices[r.sourceId],l=this.graph.vertices[r.targetId],c=o.value.element,u=l.value.element;if(!(o.value.isDrawn&&l.value.isDrawn||"default"!==this.opts.atomVisualization))return;let h=o.position,d=l.position,g=this.getEdgeNormals(r),f=i.clone(g);if(f[0].multiplyScalar(10).add(h),f[1].multiplyScalar(10).add(h),"="===r.bondType||"="===this.getRingbondType(o,l)||r.isPartOfAromaticRing&&this.bridgedRing){let t=this.areVerticesInSameRing(o,l),e=this.chooseSide(o,l,f);if(t){let t=this.getLargestOrAromaticCommonRing(o,l).center;g[0].multiplyScalar(n.opts.bondSpacing),g[1].multiplyScalar(n.opts.bondSpacing);let e=null;e=t.sameSideAs(o.position,l.position,s.add(h,g[0]))?new a(s.add(h,g[0]),s.add(d,g[0]),c,u):new a(s.add(h,g[1]),s.add(d,g[1]),c,u),e.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),r.isPartOfAromaticRing?this.canvasWrapper.drawLine(e,!0):this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new a(h,d,c,u))}else if(r.center||o.isTerminal()&&l.isTerminal()){g[0].multiplyScalar(n.opts.halfBondSpacing),g[1].multiplyScalar(n.opts.halfBondSpacing);let t=new a(s.add(h,g[0]),s.add(d,g[0]),c,u),e=new a(s.add(h,g[1]),s.add(d,g[1]),c,u);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(0==e.anCount&&e.bnCount>1||0==e.bnCount&&e.anCount>1){g[0].multiplyScalar(n.opts.halfBondSpacing),g[1].multiplyScalar(n.opts.halfBondSpacing);let t=new a(s.add(h,g[0]),s.add(d,g[0]),c,u),e=new a(s.add(h,g[1]),s.add(d,g[1]),c,u);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(e.sideCount[0]>e.sideCount[1]){g[0].multiplyScalar(n.opts.bondSpacing),g[1].multiplyScalar(n.opts.bondSpacing);let t=new a(s.add(h,g[0]),s.add(d,g[0]),c,u);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new a(h,d,c,u))}else if(e.sideCount[0]<e.sideCount[1]){g[0].multiplyScalar(n.opts.bondSpacing),g[1].multiplyScalar(n.opts.bondSpacing);let t=new a(s.add(h,g[1]),s.add(d,g[1]),c,u);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new a(h,d,c,u))}else if(e.totalSideCount[0]>e.totalSideCount[1]){g[0].multiplyScalar(n.opts.bondSpacing),g[1].multiplyScalar(n.opts.bondSpacing);let t=new a(s.add(h,g[0]),s.add(d,g[0]),c,u);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new a(h,d,c,u))}else if(e.totalSideCount[0]<=e.totalSideCount[1]){g[0].multiplyScalar(n.opts.bondSpacing),g[1].multiplyScalar(n.opts.bondSpacing);let t=new a(s.add(h,g[1]),s.add(d,g[1]),c,u);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new a(h,d,c,u))}}else if("#"===r.bondType){g[0].multiplyScalar(n.opts.bondSpacing/1.5),g[1].multiplyScalar(n.opts.bondSpacing/1.5);let t=new a(s.add(h,g[0]),s.add(d,g[0]),c,u),e=new a(s.add(h,g[1]),s.add(d,g[1]),c,u);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new a(h,d,c,u))}else if("."===r.bondType);else{let t=o.value.isStereoCenter,e=l.value.isStereoCenter;"up"===r.wedge?this.canvasWrapper.drawWedge(new a(h,d,c,u,t,e)):"down"===r.wedge?this.canvasWrapper.drawDashedWedge(new a(h,d,c,u,t,e)):this.canvasWrapper.drawLine(new a(h,d,c,u,t,e))}if(e){let e=s.midpoint(h,d);this.canvasWrapper.drawDebugText(e.x,e.y,"e: "+t)}}drawVertices(t){var e=this.graph.vertices.length;for(e=0;e<this.graph.vertices.length;e++){let n=this.graph.vertices[e],r=n.value,a=0,o=0,c=n.value.bondCount,u=r.element,h=l.maxBonds[u]-c,d=n.getTextDirection(this.graph.vertices),g=!(!this.opts.terminalCarbons&&"C"===u&&!r.hasAttachedPseudoElements)&&n.isTerminal(),f="C"===r.element;if("N"===r.element&&r.isPartOfAromaticRing&&(h=0),r.bracket&&(h=r.bracket.hcount,a=r.bracket.charge,o=r.bracket.isotope),"allballs"===this.opts.atomVisualization)this.canvasWrapper.drawBall(n.position.x,n.position.y,u);else if(r.isDrawn&&(!f||r.drawExplicit||g||r.hasAttachedPseudoElements)||1===this.graph.vertices.length)"default"===this.opts.atomVisualization?this.canvasWrapper.drawText(n.position.x,n.position.y,u,h,d,g,a,o,r.getAttachedPseudoElements()):"balls"===this.opts.atomVisualization&&this.canvasWrapper.drawBall(n.position.x,n.position.y,u);else if(2===n.getNeighbourCount()&&1==n.forcePositioned){let t=this.graph.vertices[n.neighbours[0]].position,e=this.graph.vertices[n.neighbours[1]].position,r=s.threePointangle(n.position,t,e);Math.abs(Math.PI-r)<.1&&this.canvasWrapper.drawPoint(n.position.x,n.position.y,u)}if(t){let t="v: "+n.id+" "+i.print(r.ringbonds);this.canvasWrapper.drawDebugText(n.position.x,n.position.y,t)}}if(this.opts.debug)for(e=0;e<this.rings.length;e++){let t=this.rings[e].center;this.canvasWrapper.drawDebugPoint(t.x,t.y,"r: "+this.rings[e].id)}}position(){let t=null;for(var e=0;e<this.graph.vertices.length;e++)if(null!==this.graph.vertices[e].value.bridgedRing){t=this.graph.vertices[e];break}for(e=0;e<this.rings.length;e++)this.rings[e].isBridged&&(t=this.graph.vertices[this.rings[e].members[0]]);this.rings.length>0&&null===t&&(t=this.graph.vertices[this.rings[0].members[0]]),null===t&&(t=this.graph.vertices[0]),this.createNextBond(t,null,0)}backupRingInformation(){this.originalRings=Array(),this.originalRingConnections=Array();for(var t=0;t<this.rings.length;t++)this.originalRings.push(this.rings[t]);for(t=0;t<this.ringConnections.length;t++)this.originalRingConnections.push(this.ringConnections[t]);for(t=0;t<this.graph.vertices.length;t++)this.graph.vertices[t].value.backupRings()}restoreRingInformation(){let t=this.getBridgedRings();this.rings=Array(),this.ringConnections=Array();for(var e=0;e<t.length;e++){let r=t[e];for(var n=0;n<r.rings.length;n++){let t=r.rings[n];this.originalRings[t.id].center=t.center}}for(e=0;e<this.originalRings.length;e++)this.rings.push(this.originalRings[e]);for(e=0;e<this.originalRingConnections.length;e++)this.ringConnections.push(this.originalRingConnections[e]);for(e=0;e<this.graph.vertices.length;e++)this.graph.vertices[e].value.restoreRings()}createRing(t,e=null,n=null,i=null){if(t.positioned)return;e=e||new s(0,0);let a=t.getOrderedNeighbours(this.ringConnections),o=n?s.subtract(n.position,e).angle():0,l=r.polyCircumradius(this.opts.bondLength,t.getSize()),c=r.centralAngle(t.getSize());t.centralAngle=c;let h=o,d=this,g=n?n.id:null;if(-1===t.members.indexOf(g)&&(n&&(n.positioned=!1),g=t.members[0]),t.isBridged){this.graph.kkLayout(t.members.slice(),e,n.id,t,this.opts.bondLength,this.opts.kkThreshold,this.opts.kkInnerThreshold,this.opts.kkMaxIteration,this.opts.kkMaxInnerIteration,this.opts.kkMaxEnergy),t.positioned=!0,this.setRingCenter(t),e=t.center;for(var f=0;f<t.rings.length;f++)this.setRingCenter(t.rings[f])}else t.eachMember(this.graph.vertices,(function(n){let r=d.graph.vertices[n];r.positioned||r.setPosition(e.x+Math.cos(h)*l,e.y+Math.sin(h)*l),h+=c,(!t.isBridged||t.rings.length<3)&&(r.angle=h,r.positioned=!0)}),g,i?i.id:null);t.positioned=!0,t.center=e;for(f=0;f<a.length;f++){let n=this.getRing(a[f].neighbour);if(n.positioned)continue;let i=u.getVertices(this.ringConnections,t.id,n.id);if(2===i.length){t.isFused=!0,n.isFused=!0;let a=this.graph.vertices[i[0]],o=this.graph.vertices[i[1]],l=s.midpoint(a.position,o.position),c=s.normals(a.position,o.position);c[0].normalize(),c[1].normalize();let u=r.polyCircumradius(this.opts.bondLength,n.getSize()),h=r.apothem(u,n.getSize());c[0].multiplyScalar(h).add(l),c[1].multiplyScalar(h).add(l);let d=c[0];s.subtract(e,c[1]).lengthSq()>s.subtract(e,c[0]).lengthSq()&&(d=c[1]);let g=s.subtract(a.position,d),f=s.subtract(o.position,d);-1===g.clockwise(f)?n.positioned||this.createRing(n,d,a,o):n.positioned||this.createRing(n,d,o,a)}else if(1===i.length){t.isSpiro=!0,n.isSpiro=!0;let a=this.graph.vertices[i[0]],o=s.subtract(e,a.position);o.invert(),o.normalize();let l=r.polyCircumradius(this.opts.bondLength,n.getSize());o.multiplyScalar(l),o.add(a.position),n.positioned||this.createRing(n,o,a)}}for(f=0;f<t.members.length;f++){let e=this.graph.vertices[t.members[f]],n=e.neighbours;for(var p=0;p<n.length;p++){let t=this.graph.vertices[n[p]];t.positioned||(t.value.isConnectedToRing=!0,this.createNextBond(t,e,0))}}}rotateSubtree(t,e,n,r){let i=this;this.graph.traverseTree(t,e,(function(t){t.position.rotateAround(n,r);for(var e=0;e<t.value.anchoredRings.length;e++){let s=i.rings[t.value.anchoredRings[e]];s&&s.center.rotateAround(n,r)}}))}getSubtreeOverlapScore(t,e,n){let r=this,i=0,a=new s(0,0),o=0;return this.graph.traverseTree(t,e,(function(t){if(!t.value.isDrawn)return;let e=n[t.id];e>r.opts.overlapSensitivity&&(i+=e,o++);let s=r.graph.vertices[t.id].position.clone();s.multiplyScalar(e),a.add(s)})),a.divide(i),{value:i/o,center:a}}getCurrentCenterOfMass(){let t=new s(0,0),e=0;for(var n=0;n<this.graph.vertices.length;n++){let r=this.graph.vertices[n];r.positioned&&(t.add(r.position),e++)}return t.divide(e)}getCurrentCenterOfMassInNeigbourhood(t,e=2*this.opts.bondLength){let n=new s(0,0),r=0,i=e*e;for(var a=0;a<this.graph.vertices.length;a++){let e=this.graph.vertices[a];e.positioned&&t.distanceSq(e.position)<i&&(n.add(e.position),r++)}return n.divide(r)}resolvePrimaryOverlaps(){let t=Array(),e=Array(this.graph.vertices.length);for(var n=0;n<this.rings.length;n++){let s=this.rings[n];for(var r=0;r<s.members.length;r++){let n=this.graph.vertices[s.members[r]];if(e[n.id])continue;e[n.id]=!0;let a=this.getNonRingNeighbours(n.id);if(a.length>1){let e=Array();for(var i=0;i<n.value.rings.length;i++)e.push(n.value.rings[i]);t.push({common:n,rings:e,vertices:a})}else if(1===a.length&&2===n.value.rings.length){let e=Array();for(i=0;i<n.value.rings.length;i++)e.push(n.value.rings[i]);t.push({common:n,rings:e,vertices:a})}}}for(n=0;n<t.length;n++){let e=t[n];if(2===e.vertices.length){let t=e.vertices[0],n=e.vertices[1];if(!t.value.isDrawn||!n.value.isDrawn)continue;let r=(2*Math.PI-this.getRing(e.rings[0]).getAngle())/6;this.rotateSubtree(t.id,e.common.id,r,e.common.position),this.rotateSubtree(n.id,e.common.id,-r,e.common.position);let i=this.getOverlapScore(),s=this.getSubtreeOverlapScore(t.id,e.common.id,i.vertexScores),a=this.getSubtreeOverlapScore(n.id,e.common.id,i.vertexScores),o=s.value+a.value;this.rotateSubtree(t.id,e.common.id,-2*r,e.common.position),this.rotateSubtree(n.id,e.common.id,2*r,e.common.position),i=this.getOverlapScore(),s=this.getSubtreeOverlapScore(t.id,e.common.id,i.vertexScores),a=this.getSubtreeOverlapScore(n.id,e.common.id,i.vertexScores),s.value+a.value>o&&(this.rotateSubtree(t.id,e.common.id,2*r,e.common.position),this.rotateSubtree(n.id,e.common.id,-2*r,e.common.position))}else 1===e.vertices.length&&e.rings.length}}resolveSecondaryOverlaps(t){for(var e=0;e<t.length;e++)if(t[e].score>this.opts.overlapSensitivity){let n=this.graph.vertices[t[e].id];if(n.isTerminal()){let t=this.getClosestVertex(n);if(t){let e=null;e=t.isTerminal()?0===t.id?this.graph.vertices[1].position:t.previousPosition:0===t.id?this.graph.vertices[1].position:t.position;let i=0===n.id?this.graph.vertices[1].position:n.previousPosition;n.position.rotateAwayFrom(e,i,r.toRad(20))}}}}getLastVertexWithAngle(t){let e=0,n=null;for(;!e&&t;)n=this.graph.vertices[t],e=n.angle,t=n.parentVertexId;return n}createNextBond(t,e=null,n=0,a=!1,o=!1){if(t.positioned&&!o)return;let l=!1;if(e){let n=this.graph.getEdge(t.id,e.id);"/"!==n.bondType&&"\\"!==n.bondType||++this.doubleBondConfigCount%2!=1||null===this.doubleBondConfig&&(this.doubleBondConfig=n.bondType,l=!0,null===e.parentVertexId&&t.value.branchBond&&("/"===this.doubleBondConfig?this.doubleBondConfig="\\":"\\"===this.doubleBondConfig&&(this.doubleBondConfig="/")))}if(!o)if(e)if(e.value.rings.length>0){let n=e.neighbours,r=null,a=new s(0,0);if(null===e.value.bridgedRing&&e.value.rings.length>1)for(var c=0;c<n.length;c++){let t=this.graph.vertices[n[c]];if(i.containsAll(t.value.rings,e.value.rings)){r=t;break}}if(null===r){for(c=0;c<n.length;c++){let t=this.graph.vertices[n[c]];t.positioned&&this.areVerticesInSameRing(t,e)&&a.add(s.subtract(t.position,e.position))}a.invert().normalize().multiplyScalar(this.opts.bondLength).add(e.position)}else a=r.position.clone().rotateAround(Math.PI,e.position);t.previousPosition=e.position,t.setPositionFromVector(a),t.positioned=!0}else{let r=new s(this.opts.bondLength,0);r.rotate(n),r.add(e.position),t.setPositionFromVector(r),t.previousPosition=e.position,t.positioned=!0}else{let e=new s(this.opts.bondLength,0);e.rotate(r.toRad(-60)),t.previousPosition=e,t.setPosition(this.opts.bondLength,0),t.angle=r.toRad(-60),null===t.value.bridgedRing&&(t.positioned=!0)}if(null!==t.value.bridgedRing){let e=this.getRing(t.value.bridgedRing);if(!e.positioned){let n=s.subtract(t.previousPosition,t.position);n.invert(),n.normalize();let i=r.polyCircumradius(this.opts.bondLength,e.members.length);n.multiplyScalar(i),n.add(t.position),this.createRing(e,n,t)}}else if(t.value.rings.length>0){let e=this.getRing(t.value.rings[0]);if(!e.positioned){let n=s.subtract(t.previousPosition,t.position);n.invert(),n.normalize();let i=r.polyCircumradius(this.opts.bondLength,e.getSize());n.multiplyScalar(i),n.add(t.position),this.createRing(e,n,t)}}else{t.value.isStereoCenter;let n=t.getNeighbours(),o=Array();for(c=0;c<n.length;c++)this.graph.vertices[n[c]].value.isDrawn&&o.push(n[c]);e&&(o=i.remove(o,e.id));let u=t.getAngle();if(1===o.length){let n=this.graph.vertices[o[0]];if("#"===t.value.bondType||e&&"#"===e.value.bondType||"="===t.value.bondType&&e&&0===e.value.rings.length&&"="===e.value.bondType&&"-"!==t.value.branchBond){if(t.value.drawExplicit=!1,e){this.graph.getEdge(t.id,e.id).center=!0}this.graph.getEdge(t.id,n.id).center=!0,("#"===t.value.bondType||e&&"#"===e.value.bondType)&&(n.angle=0),n.drawExplicit=!0,this.createNextBond(n,t,u+n.angle)}else if(e&&e.value.rings.length>0){let e=r.toRad(60),i=-e,a=new s(this.opts.bondLength,0),o=new s(this.opts.bondLength,0);a.rotate(e).add(t.position),o.rotate(i).add(t.position);let l=this.getCurrentCenterOfMass(),c=a.distanceSq(l),h=o.distanceSq(l);n.angle=c<h?i:e,this.createNextBond(n,t,u+n.angle)}else{let r=t.angle;if(e&&e.neighbours.length>3)r=r>0?Math.min(1.0472,r):r<0?Math.max(-1.0472,r):1.0472;else if(!r){r=this.getLastVertexWithAngle(t.id).angle,r||(r=1.0472)}if(e&&!l){let e=this.graph.getEdge(t.id,n.id).bondType;"/"===e?("/"===this.doubleBondConfig||"\\"===this.doubleBondConfig&&(r=-r),this.doubleBondConfig=null):"\\"===e&&("/"===this.doubleBondConfig?r=-r:this.doubleBondConfig,this.doubleBondConfig=null)}n.angle=a?r:-r,this.createNextBond(n,t,u+n.angle)}}else if(2===o.length){let n=t.angle;n||(n=1.0472);let r=this.graph.getTreeDepth(o[0],t.id),i=this.graph.getTreeDepth(o[1],t.id),s=this.graph.vertices[o[0]],a=this.graph.vertices[o[1]];s.value.subtreeDepth=r,a.value.subtreeDepth=i;let l=this.graph.getTreeDepth(e?e.id:null,t.id);e&&(e.value.subtreeDepth=l);let c=0,h=1;"C"===a.value.element&&"C"!==s.value.element&&i>1&&r<5?(c=1,h=0):"C"!==a.value.element&&"C"===s.value.element&&r>1&&i<5?(c=0,h=1):i>r&&(c=1,h=0);let d=this.graph.vertices[o[c]],g=this.graph.vertices[o[h]],f=(this.graph.getEdge(t.id,d.id),this.graph.getEdge(t.id,g.id),!1);l<r&&l<i&&(f=!0),g.angle=n,d.angle=-n,"\\"===this.doubleBondConfig?"\\"===g.value.branchBond&&(g.angle=-n,d.angle=n):"/"===this.doubleBondConfig&&"/"===g.value.branchBond&&(g.angle=-n,d.angle=n),this.createNextBond(g,t,u+g.angle,f),this.createNextBond(d,t,u+d.angle,f)}else if(3===o.length){let n=this.graph.getTreeDepth(o[0],t.id),i=this.graph.getTreeDepth(o[1],t.id),s=this.graph.getTreeDepth(o[2],t.id),a=this.graph.vertices[o[0]],l=this.graph.vertices[o[1]],c=this.graph.vertices[o[2]];a.value.subtreeDepth=n,l.value.subtreeDepth=i,c.value.subtreeDepth=s,i>n&&i>s?(a=this.graph.vertices[o[1]],l=this.graph.vertices[o[0]],c=this.graph.vertices[o[2]]):s>n&&s>i&&(a=this.graph.vertices[o[2]],l=this.graph.vertices[o[0]],c=this.graph.vertices[o[1]]),e&&e.value.rings.length<1&&a.value.rings.length<1&&l.value.rings.length<1&&c.value.rings.length<1&&1===this.graph.getTreeDepth(l.id,t.id)&&1===this.graph.getTreeDepth(c.id,t.id)&&this.graph.getTreeDepth(a.id,t.id)>1?(a.angle=-t.angle,t.angle>=0?(l.angle=r.toRad(30),c.angle=r.toRad(90)):(l.angle=-r.toRad(30),c.angle=-r.toRad(90)),this.createNextBond(a,t,u+a.angle),this.createNextBond(l,t,u+l.angle),this.createNextBond(c,t,u+c.angle)):(a.angle=0,l.angle=r.toRad(90),c.angle=-r.toRad(90),this.createNextBond(a,t,u+a.angle),this.createNextBond(l,t,u+l.angle),this.createNextBond(c,t,u+c.angle))}else if(4===o.length){let e=this.graph.getTreeDepth(o[0],t.id),n=this.graph.getTreeDepth(o[1],t.id),i=this.graph.getTreeDepth(o[2],t.id),s=this.graph.getTreeDepth(o[3],t.id),a=this.graph.vertices[o[0]],l=this.graph.vertices[o[1]],c=this.graph.vertices[o[2]],h=this.graph.vertices[o[3]];a.value.subtreeDepth=e,l.value.subtreeDepth=n,c.value.subtreeDepth=i,h.value.subtreeDepth=s,n>e&&n>i&&n>s?(a=this.graph.vertices[o[1]],l=this.graph.vertices[o[0]],c=this.graph.vertices[o[2]],h=this.graph.vertices[o[3]]):i>e&&i>n&&i>s?(a=this.graph.vertices[o[2]],l=this.graph.vertices[o[0]],c=this.graph.vertices[o[1]],h=this.graph.vertices[o[3]]):s>e&&s>n&&s>i&&(a=this.graph.vertices[o[3]],l=this.graph.vertices[o[0]],c=this.graph.vertices[o[1]],h=this.graph.vertices[o[2]]),a.angle=-r.toRad(36),l.angle=r.toRad(36),c.angle=-r.toRad(108),h.angle=r.toRad(108),this.createNextBond(a,t,u+a.angle),this.createNextBond(l,t,u+l.angle),this.createNextBond(c,t,u+c.angle),this.createNextBond(h,t,u+h.angle)}}}getCommonRingbondNeighbour(t){let e=t.neighbours;for(var n=0;n<e.length;n++){let r=this.graph.vertices[e[n]];if(i.containsAll(r.value.rings,t.value.rings))return r}return null}isPointInRing(t){for(var e=0;e<this.rings.length;e++){let n=this.rings[e];if(!n.positioned)continue;let i=r.polyCircumradius(this.opts.bondLength,n.getSize()),s=i*i;if(t.distanceSq(n.center)<s)return!0}return!1}isEdgeInRing(t){let e=this.graph.vertices[t.sourceId],n=this.graph.vertices[t.targetId];return this.areVerticesInSameRing(e,n)}isEdgeRotatable(t){let e=this.graph.vertices[t.sourceId],n=this.graph.vertices[t.targetId];return"-"===t.bondType&&(!e.isTerminal()&&!n.isTerminal()&&!(e.value.rings.length>0&&n.value.rings.length>0&&this.areVerticesInSameRing(e,n)))}isRingAromatic(t){for(var e=0;e<t.members.length;e++){if(!this.graph.vertices[t.members[e]].value.isPartOfAromaticRing)return!1}return!0}getEdgeNormals(t){let e=this.graph.vertices[t.sourceId].position,n=this.graph.vertices[t.targetId].position;return s.units(e,n)}getNonRingNeighbours(t){let e=Array(),n=this.graph.vertices[t],r=n.neighbours;for(var s=0;s<r.length;s++){let t=this.graph.vertices[r[s]];0===i.intersection(n.value.rings,t.value.rings).length&&0==t.value.isBridge&&e.push(t)}return e}annotateStereochemistry(){for(var t=0;t<this.graph.vertices.length;t++){let s=this.graph.vertices[t];if(!s.value.isStereoCenter)continue;let a=s.getNeighbours(),o=a.length,l=Array(o);for(var e=0;e<o;e++){let t=new Uint8Array(this.graph.vertices.length),r=Array(Array());t[s.id]=1,this.visitStereochemistry(a[e],s.id,t,r,10,0);for(var n=0;n<r.length;n++)r[n].sort((function(t,e){return e-t}));l[e]=[e,r]}let c=0,u=0;for(e=0;e<l.length;e++){l[e][1].length>c&&(c=l[e][1].length);for(n=0;n<l[e][1].length;n++)l[e][1][n].length>u&&(u=l[e][1][n].length)}for(e=0;e<l.length;e++){let t=c-l[e][1].length;for(n=0;n<t;n++)l[e][1].push([]);l[e][1].push([a[e]]);for(n=0;n<l[e][1].length;n++){let t=u-l[e][1][n].length;for(var i=0;i<t;i++)l[e][1][n].push(0)}}l.sort((function(t,e){for(var n=0;n<t[1].length;n++)for(var r=0;r<t[1][n].length;r++){if(t[1][n][r]>e[1][n][r])return-1;if(t[1][n][r]<e[1][n][r])return 1}return 0}));let h=new Uint8Array(o);for(e=0;e<o;e++)h[e]=l[e][0],s.value.priority=e;let d=this.graph.vertices[a[h[0]]].position,g=this.graph.vertices[a[h[1]]].position,f=this.graph.vertices[a[h[2]]].position,p=d.relativeClockwise(g,s.position),m=(d.relativeClockwise(f,s.position),-1===p),v="@"===s.value.bracket.chirality?-1:1,y=r.parityOfPermutation(h)*v==1?"R":"S",b="down",x="up";(m&&"R"!==y||!m&&"S"!==y)&&(s.value.hydrogenDirection="up",b="up",x="down"),s.value.hasHydrogen&&(this.graph.getEdge(s.id,a[h[h.length-1]]).wedge=b);let w=new Array(a.length-1),$=s.value.rings.length>1&&s.value.hasHydrogen,S=s.value.hasHydrogen?1:0;for(e=0;e<h.length-S;e++){w[e]=new Uint32Array(2);let t=this.graph.vertices[a[h[e]]];w[e][0]+=t.value.isStereoCenter?0:1e5,w[e][0]+=this.areVerticesInSameRing(t,s)?0:1e4,w[e][0]+=t.value.isHeteroAtom()?1e3:0,w[e][0]-=0===t.value.subtreeDepth?1e3:0,w[e][0]+=1e3-t.value.subtreeDepth,w[e][1]=a[h[e]]}if(w.sort((function(t,e){return t[0]>e[0]?-1:t[0]<e[0]?1:0})),!$){let t=w[0][1];if(s.value.hasHydrogen)this.graph.getEdge(s.id,t).wedge=x;else{let n=x;for(e=h.length-1;e>=0&&(n=n===b?x:b,a[h[e]]!==t);e--);this.graph.getEdge(s.id,t).wedge=n}}s.value.chirality=y}}visitStereochemistry(t,e,n,r,i,s,a=0){n[t]=1;let o=this.graph.vertices[t],l=o.value.getAtomicNumber();r.length<=s&&r.push(Array());for(var c=0;c<this.graph.getEdge(t,e).weight;c++)r[s].push(1e3*a+l);let u=this.graph.vertices[t].neighbours;for(c=0;c<u.length;c++)1!==n[u[c]]&&s<i-1&&this.visitStereochemistry(u[c],t,n.slice(),r,i,s+1,l);if(s<i-1){let e=0;for(c=0;c<u.length;c++)e+=this.graph.getEdge(t,u[c]).weight;for(c=0;c<o.value.getMaxBonds()-e;c++)r.length<=s+1&&r.push(Array()),r[s+1].push(1e3*l+1)}}initPseudoElements(){for(var t=0;t<this.graph.vertices.length;t++){const n=this.graph.vertices[t],r=n.neighbours;let i=Array(r.length);for(var e=0;e<r.length;e++)i[e]=this.graph.vertices[r[e]];if(n.getNeighbourCount()<3||n.value.rings.length>0)continue;if("P"===n.value.element)continue;if("C"===n.value.element&&3===i.length&&"N"===i[0].value.element&&"N"===i[1].value.element&&"N"===i[2].value.element)continue;let s=0,a=0;for(e=0;e<i.length;e++){let t=i[e],n=t.value.element,r=t.getNeighbourCount();"C"!==n&&"H"!==n&&1===r&&s++,r>1&&a++}if(a>1||s<2)continue;let o=null;for(e=0;e<i.length;e++){let t=i[e];t.getNeighbourCount()>1&&(o=t)}for(e=0;e<i.length;e++){let t=i[e];if(t.getNeighbourCount()>1)continue;t.value.isDrawn=!1;let r=l.maxBonds[t.value.element]-t.value.bondCount,s="";t.value.bracket&&(r=t.value.bracket.hcount,s=t.value.bracket.charge||0),n.value.attachPseudoElement(t.value.element,o?o.value.element:null,r,s)}}for(t=0;t<this.graph.vertices.length;t++){const n=this.graph.vertices[t],r=n.value,i=r.element;if("C"===i||"H"===i||!r.isDrawn)continue;const s=n.neighbours;let a=Array(s.length);for(e=0;e<s.length;e++)a[e]=this.graph.vertices[s[e]];for(e=0;e<a.length;e++){let t=a[e].value;if(!t.hasAttachedPseudoElements||2!==t.getAttachedPseudoElementsCount())continue;const r=t.getAttachedPseudoElements();r.hasOwnProperty("0O")&&r.hasOwnProperty("3C")&&(t.isDrawn=!1,n.value.attachPseudoElement("Ac","",0))}}}}},6826:t=>{class e{constructor(t,e,n=1){this.id=null,this.sourceId=t,this.targetId=e,this.weight=n,this.bondType="-",this.isPartOfAromaticRing=!1,this.center=!1,this.wedge=""}setBondType(t){this.bondType=t,this.weight=e.bonds[t]}static get bonds(){return{"-":1,"/":1,"\\":1,"=":2,"#":3,$:4}}}t.exports=e},4707:(t,e,n)=>{const r=n(5474),i=(n(2614),n(6843)),s=n(6826),a=(n(6421),n(2427));class o{constructor(t,e=!1){this.vertices=Array(),this.edges=Array(),this.vertexIdsToEdgeId={},this.isomeric=e,this._time=0,this._init(t)}_init(t,e=0,n=null,r=!1){let o=new a(t.atom.element?t.atom.element:t.atom,t.bond);o.branchBond=t.branchBond,o.ringbonds=t.ringbonds,o.bracket=t.atom.element?t.atom:null;let l=new i(o),c=this.vertices[n];if(this.addVertex(l),null!==n){l.setParentVertexId(n),l.value.addNeighbouringElement(c.value.element),c.addChild(l.id),c.value.addNeighbouringElement(o.element),c.spanningTreeChildren.push(l.id);let t=new s(n,l.id,1),e=null;r?(t.setBondType(l.value.branchBond||"-"),e=l.id,t.setBondType(l.value.branchBond||"-"),e=l.id):(t.setBondType(c.value.bondType||"-"),e=c.id);this.addEdge(t)}let u=t.ringbondCount+1;o.bracket&&(u+=o.bracket.hcount);let h=0;if(o.bracket&&o.bracket.chirality){o.isStereoCenter=!0,h=o.bracket.hcount;for(var d=0;d<h;d++)this._init({atom:"H",isBracket:"false",branches:Array(),branchCount:0,ringbonds:Array(),ringbondCount:!1,next:null,hasNext:!1,bond:"-"},d,l.id,!0)}for(d=0;d<t.branchCount;d++)this._init(t.branches[d],d+u,l.id,!0);t.hasNext&&this._init(t.next,t.branchCount+u,l.id)}clear(){this.vertices=Array(),this.edges=Array(),this.vertexIdsToEdgeId={}}addVertex(t){return t.id=this.vertices.length,this.vertices.push(t),t.id}addEdge(t){let e=this.vertices[t.sourceId],n=this.vertices[t.targetId];return t.id=this.edges.length,this.edges.push(t),this.vertexIdsToEdgeId[t.sourceId+"_"+t.targetId]=t.id,this.vertexIdsToEdgeId[t.targetId+"_"+t.sourceId]=t.id,t.isPartOfAromaticRing=e.value.isPartOfAromaticRing&&n.value.isPartOfAromaticRing,e.value.bondCount+=t.weight,n.value.bondCount+=t.weight,e.edges.push(t.id),n.edges.push(t.id),t.id}getEdge(t,e){let n=this.vertexIdsToEdgeId[t+"_"+e];return void 0===n?null:this.edges[n]}getEdges(t){let e=Array(),n=this.vertices[t];for(var r=0;r<n.neighbours.length;r++)e.push(this.vertexIdsToEdgeId[t+"_"+n.neighbours[r]]);return e}hasEdge(t,e){return void 0!==this.vertexIdsToEdgeId[t+"_"+e]}getVertexList(){let t=[this.vertices.length];for(var e=0;e<this.vertices.length;e++)t[e]=this.vertices[e].id;return t}getEdgeList(){let t=Array(this.edges.length);for(var e=0;e<this.edges.length;e++)t[e]=[this.edges[e].sourceId,this.edges[e].targetId];return t}getAdjacencyMatrix(){let t=this.vertices.length,e=Array(t);for(var n=0;n<t;n++)e[n]=new Array(t),e[n].fill(0);for(n=0;n<this.edges.length;n++){let t=this.edges[n];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}return e}getComponentsAdjacencyMatrix(){let t=this.vertices.length,e=Array(t),n=this.getBridges();for(var r=0;r<t;r++)e[r]=new Array(t),e[r].fill(0);for(r=0;r<this.edges.length;r++){let t=this.edges[r];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}for(r=0;r<n.length;r++)e[n[r][0]][n[r][1]]=0,e[n[r][1]][n[r][0]]=0;return e}getSubgraphAdjacencyMatrix(t){let e=t.length,n=Array(e);for(var r=0;r<e;r++){n[r]=new Array(e),n[r].fill(0);for(var i=0;i<e;i++)r!==i&&this.hasEdge(t[r],t[i])&&(n[r][i]=1)}return n}getDistanceMatrix(){let t=this.vertices.length,e=this.getAdjacencyMatrix(),n=Array(t);for(var r=0;r<t;r++)n[r]=Array(t),n[r].fill(1/0);for(r=0;r<t;r++)for(var i=0;i<t;i++)1===e[r][i]&&(n[r][i]=1);for(var s=0;s<t;s++)for(r=0;r<t;r++)for(i=0;i<t;i++)n[r][i]>n[r][s]+n[s][i]&&(n[r][i]=n[r][s]+n[s][i]);return n}getSubgraphDistanceMatrix(t){let e=t.length,n=this.getSubgraphAdjacencyMatrix(t),r=Array(e);for(var i=0;i<e;i++)r[i]=Array(e),r[i].fill(1/0);for(i=0;i<e;i++)for(var s=0;s<e;s++)1===n[i][s]&&(r[i][s]=1);for(var a=0;a<e;a++)for(i=0;i<e;i++)for(s=0;s<e;s++)r[i][s]>r[i][a]+r[a][s]&&(r[i][s]=r[i][a]+r[a][s]);return r}getAdjacencyList(){let t=this.vertices.length,e=Array(t);for(var n=0;n<t;n++){e[n]=[];for(var r=0;r<t;r++)n!==r&&this.hasEdge(this.vertices[n].id,this.vertices[r].id)&&e[n].push(r)}return e}getSubgraphAdjacencyList(t){let e=t.length,n=Array(e);for(var r=0;r<e;r++){n[r]=Array();for(var i=0;i<e;i++)r!==i&&this.hasEdge(t[r],t[i])&&n[r].push(i)}return n}getBridges(){let t=this.vertices.length,e=new Array(t),n=new Array(t),r=new Array(t),i=new Array(t),s=this.getAdjacencyList(),a=Array();e.fill(!1),i.fill(null),this._time=0;for(var o=0;o<t;o++)e[o]||this._bridgeDfs(o,e,n,r,i,s,a);return a}traverseBF(t,e){let n=this.vertices.length,r=new Array(n);r.fill(!1);for(var i=[t];i.length>0;){let t=i.shift(),n=this.vertices[t];e(n);for(var s=0;s<n.neighbours.length;s++){let t=n.neighbours[s];r[t]||(r[t]=!0,i.push(t))}}}getTreeDepth(t,e){if(null===t||null===e)return 0;let n=this.vertices[t].getSpanningTreeNeighbours(e),r=0;for(var i=0;i<n.length;i++){let e=n[i],s=this.getTreeDepth(e,t);s>r&&(r=s)}return r+1}traverseTree(t,e,n,r=999999,i=!1,s=1,a=null){if(null===a&&(a=new Uint8Array(this.vertices.length)),s>r+1||1===a[t])return;a[t]=1;let o=this.vertices[t],l=o.getNeighbours(e);(!i||s>1)&&n(o);for(var c=0;c<l.length;c++)this.traverseTree(l[c],t,n,r,i,s+1,a)}kkLayout(t,e,n,i,s,a=.1,o=.1,l=2e3,c=50,u=1e9){let h=s;for(var d=t.length;d--;){var g=this.vertices[t[d]].neighbours.length}let f=this.getSubgraphDistanceMatrix(t),p=t.length,m=r.polyCircumradius(500,p),v=r.centralAngle(p),y=0,b=new Float32Array(p),x=new Float32Array(p),w=Array(p);for(d=p;d--;){let n=this.vertices[t[d]];n.positioned?(b[d]=n.position.x,x[d]=n.position.y):(b[d]=e.x+Math.cos(y)*m,x[d]=e.y+Math.sin(y)*m),w[d]=n.positioned,y+=v}let $=Array(p);for(d=p;d--;){$[d]=new Array(p);for(g=p;g--;)$[d][g]=s*f[d][g]}let S=Array(p);for(d=p;d--;){S[d]=Array(p);for(g=p;g--;)S[d][g]=h*Math.pow(f[d][g],-2)}let A,C,M,_,T,k,N,R=Array(p),L=new Float32Array(p),E=new Float32Array(p);for(d=p;d--;)R[d]=Array(p);for(d=p;d--;){A=b[d],C=x[d],M=0,_=0;let t=p;for(;t--;)d!==t&&(T=b[t],k=x[t],N=1/Math.sqrt((A-T)*(A-T)+(C-k)*(C-k)),R[d][t]=[S[d][t]*(A-T-$[d][t]*(A-T)*N),S[d][t]*(C-k-$[d][t]*(C-k)*N)],R[t][d]=R[d][t],M+=R[d][t][0],_+=R[d][t][1]);L[d]=M,E[d]=_}let P=function(t){return[L[t]*L[t]+E[t]*E[t],L[t],E[t]]},D=function(){let t=0,e=0,n=0,r=0;for(d=p;d--;){let[i,s,a]=P(d);i>t&&!1===w[d]&&(t=i,e=d,n=s,r=a)}return[e,t,n,r]},I=function(t,e,n){let r=0,i=0,s=0,a=b[t],o=x[t],l=$[t],c=S[t];for(d=p;d--;){if(d===t)continue;let e=b[d],n=x[d],u=l[d],h=c[d],g=(a-e)*(a-e),f=1/Math.pow(g+(o-n)*(o-n),1.5);r+=h*(1-u*(o-n)*(o-n)*f),i+=h*(1-u*g*f),s+=h*(u*(a-e)*(o-n)*f)}0===r&&(r=.1),0===i&&(i=.1),0===s&&(s=.1);let u=e/r+n/s;u/=s/r-i/s;let h=-(s*u+e)/r;b[t]+=h,x[t]+=u;let g,f,m,v,y,w=R[t];for(e=0,n=0,a=b[t],o=x[t],d=p;d--;)t!==d&&(g=b[d],f=x[d],m=w[d][0],v=w[d][1],y=1/Math.sqrt((a-g)*(a-g)+(o-f)*(o-f)),h=c[d]*(a-g-l[d]*(a-g)*y),u=c[d]*(o-f-l[d]*(o-f)*y),w[d]=[h,u],e+=h,n+=u,L[d]+=h-m,E[d]+=u-v);L[t]=e,E[t]=n},B=0,O=0,z=0,H=0,F=0,j=0;for(;u>a&&l>F;)for(F++,[B,u,O,z]=D(),H=u,j=0;H>o&&c>j;)j++,I(B,O,z),[H,O,z]=P(B);for(d=p;d--;){let e=t[d],n=this.vertices[e];n.position.x=b[d],n.position.y=x[d],n.positioned=!0,n.forcePositioned=!0}}_bridgeDfs(t,e,n,r,i,s,a){e[t]=!0,n[t]=r[t]=++this._time;for(var o=0;o<s[t].length;o++){let l=s[t][o];e[l]?l!==i[t]&&(r[t]=Math.min(r[t],n[l])):(i[l]=t,this._bridgeDfs(l,e,n,r,i,s,a),r[t]=Math.min(r[t],r[l]),r[l]>n[t]&&a.push([t,l]))}}static getConnectedComponents(t){let e=t.length,n=new Array(e),r=new Array;n.fill(!1);for(var i=0;i<e;i++)if(!n[i]){let e=Array();n[i]=!0,e.push(i),o._ccGetDfs(i,n,t,e),e.length>1&&r.push(e)}return r}static getConnectedComponentCount(t){let e=t.length,n=new Array(e),r=0;n.fill(!1);for(var i=0;i<e;i++)n[i]||(n[i]=!0,r++,o._ccCountDfs(i,n,t));return r}static _ccCountDfs(t,e,n){for(var r=0;r<n[t].length;r++){n[t][r]&&!e[r]&&t!==r&&(e[r]=!0,o._ccCountDfs(r,e,n))}}static _ccGetDfs(t,e,n,r){for(var i=0;i<n[t].length;i++){n[t][i]&&!e[i]&&t!==i&&(e[i]=!0,r.push(i),o._ccGetDfs(i,e,n,r))}}}t.exports=o},929:(t,e,n)=>{const r=n(2614);class i{constructor(t=new r(0,0),e=new r(0,0),n=null,i=null,s=!1,a=!1){this.from=t,this.to=e,this.elementFrom=n,this.elementTo=i,this.chiralFrom=s,this.chiralTo=a}clone(){return new i(this.from.clone(),this.to.clone(),this.elementFrom,this.elementTo)}getLength(){return Math.sqrt(Math.pow(this.to.x-this.from.x,2)+Math.pow(this.to.y-this.from.y,2))}getAngle(){return r.subtract(this.getRightVector(),this.getLeftVector()).angle()}getRightVector(){return this.from.x<this.to.x?this.to:this.from}getLeftVector(){return this.from.x<this.to.x?this.from:this.to}getRightElement(){return this.from.x<this.to.x?this.elementTo:this.elementFrom}getLeftElement(){return this.from.x<this.to.x?this.elementFrom:this.elementTo}getRightChiral(){return this.from.x<this.to.x?this.chiralTo:this.chiralFrom}getLeftChiral(){return this.from.x<this.to.x?this.chiralFrom:this.chiralTo}setRightVector(t,e){return this.from.x<this.to.x?(this.to.x=t,this.to.y=e):(this.from.x=t,this.from.y=e),this}setLeftVector(t,e){return this.from.x<this.to.x?(this.from.x=t,this.from.y=e):(this.to.x=t,this.to.y=e),this}rotateToXAxis(){let t=this.getLeftVector();return this.setRightVector(t.x+this.getLength(),t.y),this}rotate(t){let e=this.getLeftVector(),n=this.getRightVector(),r=Math.sin(t),i=Math.cos(t),s=i*(n.x-e.x)-r*(n.y-e.y)+e.x,a=r*(n.x-e.x)-i*(n.y-e.y)+e.y;return this.setRightVector(s,a),this}shortenFrom(t){let e=r.subtract(this.to,this.from);return e.normalize(),e.multiplyScalar(t),this.from.add(e),this}shortenTo(t){let e=r.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t),this.to.add(e),this}shortenRight(t){return this.from.x<this.to.x?this.shortenTo(t):this.shortenFrom(t),this}shortenLeft(t){return this.from.x<this.to.x?this.shortenFrom(t):this.shortenTo(t),this}shorten(t){let e=r.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t/2),this.to.add(e),this.from.subtract(e),this}}t.exports=i},5474:t=>{class e{static round(t,e){return e=e||1,Number(Math.round(t+"e"+e)+"e-"+e)}static meanAngle(t){let e=0,n=0;for(var r=0;r<t.length;r++)e+=Math.sin(t[r]),n+=Math.cos(t[r]);return Math.atan2(e/t.length,n/t.length)}static innerAngle(t){return e.toRad(180*(t-2)/t)}static polyCircumradius(t,e){return t/(2*Math.sin(Math.PI/e))}static apothem(t,e){return t*Math.cos(Math.PI/e)}static apothemFromSideLength(t,n){let r=e.polyCircumradius(t,n);return e.apothem(r,n)}static centralAngle(t){return e.toRad(360/t)}static toDeg(t){return t*e.degFactor}static toRad(t){return t*e.radFactor}static parityOfPermutation(t){let e=new Uint8Array(t.length),n=0,r=function(n,i=0){return 1===e[n]?i:(i++,e[n]=1,r(t[n],i))};for(var i=0;i<t.length;i++){if(1===e[i])continue;n+=1-r(i)%2}return n%2?-1:1}static get radFactor(){return Math.PI/180}static get degFactor(){return 180/Math.PI}static get twoPI(){return 2*Math.PI}}t.exports=e},19:t=>{t.exports=function(){"use strict";function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(t,Error),t.buildMessage=function(t,e){var n={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?s(t.parts[e][0])+"-"+s(t.parts[e][1]):s(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var e,r,i,s=new Array(t.length);for(e=0;e<t.length;e++)s[e]=(i=t[e],n[i.type](i));if(s.sort(),s.length>0){for(e=1,r=1;e<s.length;e++)s[e-1]!==s[e]&&(s[r]=s[e],r++);s.length=r}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(e)+" found."},{SyntaxError:t,parse:function(e,n){if(n=void 0!==n?n:{},e.split("(").length-1!==e.split(")").length-1)throw qt("The number of opening parentheses does not match the number of closing parentheses.",0);var r,i={},s={chain:Vt},a=Vt,o=function(t){for(var e=[],n=[],r=0;r<t[1].length;r++)e.push(t[1][r]);for(r=0;r<t[2].length;r++){var i=t[2][r][0]?t[2][r][0]:"-";n.push({bond:i,id:t[2][r][1]})}for(r=0;r<t[3].length;r++)e.push(t[3][r]);for(r=0;r<t[6].length;r++)e.push(t[6][r]);return{atom:t[0],isBracket:!!t[0].element,branches:e,branchCount:e.length,ringbonds:n,ringbondCount:n.length,bond:t[4]?t[4]:"-",next:t[5],hasNext:!!t[5]}},l="(",c=Ot("(",!1),u=")",h=Ot(")",!1),d=function(t){var e=t[1]?t[1]:"-";return t[2].branchBond=e,t[2]},g=function(t){return t},f=/^[\-=#$:\/\\.]/,p=zt(["-","=","#","$",":","/","\\","."],!1,!1),m=function(t){return t},v="[",y=Ot("[",!1),b="se",x=Ot("se",!1),w="as",$=Ot("as",!1),S="]",A=Ot("]",!1),C=function(t){return{isotope:t[1],element:t[2],chirality:t[3],hcount:t[4],charge:t[5],class:t[6]}},M="B",_=Ot("B",!1),T="r",k=Ot("r",!1),N="C",R=Ot("C",!1),L="l",E=Ot("l",!1),P=/^[NOPSFI]/,D=zt(["N","O","P","S","F","I"],!1,!1),I=function(t){return t.length>1?t.join(""):t},B=/^[bcnops]/,O=zt(["b","c","n","o","p","s"],!1,!1),z="*",H=Ot("*",!1),F=function(t){return t},j=/^[A-Z]/,q=zt([["A","Z"]],!1,!1),U=/^[a-z]/,V=zt([["a","z"]],!1,!1),W=function(t){return t.join("")},Y="%",X=Ot("%",!1),Z=/^[1-9]/,G=zt([["1","9"]],!1,!1),K=/^[0-9]/,Q=zt([["0","9"]],!1,!1),J=function(t){return 1==t.length?Number(t):Number(t.join("").replace("%",""))},tt="@",et=Ot("@",!1),nt="TH",rt=Ot("TH",!1),it=/^[12]/,st=zt(["1","2"],!1,!1),at="AL",ot=Ot("AL",!1),lt="SP",ct=Ot("SP",!1),ut=/^[1-3]/,ht=zt([["1","3"]],!1,!1),dt="TB",gt=Ot("TB",!1),ft="OH",pt=Ot("OH",!1),mt=function(t){return t[1]?"@"==t[1]?"@@":t[1].join("").replace(",",""):"@"},vt=function(t){return t},yt="+",bt=Ot("+",!1),xt=function(t){return t[1]?"+"!=t[1]?Number(t[1].join("")):2:1},wt="-",$t=Ot("-",!1),St=function(t){return t[1]?"-"!=t[1]?-Number(t[1].join("")):-2:-1},At="H",Ct=Ot("H",!1),Mt=function(t){return t[1]?Number(t[1]):1},_t=":",Tt=Ot(":",!1),kt=/^[0]/,Nt=zt(["0"],!1,!1),Rt=function(t){return Number(t[1][0]+t[1][1].join(""))},Lt=function(t){return Number(t.join(""))},Et=0,Pt=[{line:1,column:1}],Dt=0,It=[],Bt=0;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=s[n.startRule]}function Ot(t,e){return{type:"literal",text:t,ignoreCase:e}}function zt(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function Ht(t){var n,r=Pt[t];if(r)return r;for(n=t-1;!Pt[n];)n--;for(r={line:(r=Pt[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Pt[t]=r,r}function Ft(t,e){var n=Ht(t),r=Ht(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function jt(t){Et<Dt||(Et>Dt&&(Dt=Et,It=[]),It.push(t))}function qt(e,n){return new t(e,null,null,n)}function Ut(e,n,r){return new t(t.buildMessage(e,n),e,n,r)}function Vt(){var t,n,r,s,a,l,c,u,h,d;if(t=Et,n=Et,r=function(){var t,n;t=Et,n=function(){var t,n,r,s;t=Et,n=Et,66===e.charCodeAt(Et)?(r=M,Et++):(r=i,0===Bt&&jt(_));r!==i?(114===e.charCodeAt(Et)?(s=T,Et++):(s=i,0===Bt&&jt(k)),s===i&&(s=null),s!==i?n=r=[r,s]:(Et=n,n=i)):(Et=n,n=i);n===i&&(n=Et,67===e.charCodeAt(Et)?(r=N,Et++):(r=i,0===Bt&&jt(R)),r!==i?(108===e.charCodeAt(Et)?(s=L,Et++):(s=i,0===Bt&&jt(E)),s===i&&(s=null),s!==i?n=r=[r,s]:(Et=n,n=i)):(Et=n,n=i),n===i&&(P.test(e.charAt(Et))?(n=e.charAt(Et),Et++):(n=i,0===Bt&&jt(D))));n!==i&&(t,n=I(n));return t=n,t}(),n===i&&(n=Xt())===i&&(n=function(){var t,n,r,s,a,o,l,c,u,h;t=Et,n=Et,91===e.charCodeAt(Et)?(r=v,Et++):(r=i,0===Bt&&jt(y));r!==i?(s=function(){var t,n,r,s,a;t=Et,n=Et,Z.test(e.charAt(Et))?(r=e.charAt(Et),Et++):(r=i,0===Bt&&jt(G));r!==i?(K.test(e.charAt(Et))?(s=e.charAt(Et),Et++):(s=i,0===Bt&&jt(Q)),s===i&&(s=null),s!==i?(K.test(e.charAt(Et))?(a=e.charAt(Et),Et++):(a=i,0===Bt&&jt(Q)),a===i&&(a=null),a!==i?n=r=[r,s,a]:(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i);n!==i&&(t,n=Lt(n));return t=n,t}(),s===i&&(s=null),s!==i?(e.substr(Et,2)===b?(a=b,Et+=2):(a=i,0===Bt&&jt(x)),a===i&&(e.substr(Et,2)===w?(a=w,Et+=2):(a=i,0===Bt&&jt($)),a===i&&(a=Xt())===i&&(a=function(){var t,n,r,s;t=Et,n=Et,j.test(e.charAt(Et))?(r=e.charAt(Et),Et++):(r=i,0===Bt&&jt(q));r!==i?(U.test(e.charAt(Et))?(s=e.charAt(Et),Et++):(s=i,0===Bt&&jt(V)),s===i&&(s=null),s!==i?n=r=[r,s]:(Et=n,n=i)):(Et=n,n=i);n!==i&&(t,n=W(n));return t=n,t}(),a===i&&(a=Zt()))),a!==i?(o=function(){var t,n,r,s,a,o,l;t=Et,n=Et,64===e.charCodeAt(Et)?(r=tt,Et++):(r=i,0===Bt&&jt(et));r!==i?(64===e.charCodeAt(Et)?(s=tt,Et++):(s=i,0===Bt&&jt(et)),s===i&&(s=Et,e.substr(Et,2)===nt?(a=nt,Et+=2):(a=i,0===Bt&&jt(rt)),a!==i?(it.test(e.charAt(Et))?(o=e.charAt(Et),Et++):(o=i,0===Bt&&jt(st)),o!==i?s=a=[a,o]:(Et=s,s=i)):(Et=s,s=i),s===i&&(s=Et,e.substr(Et,2)===at?(a=at,Et+=2):(a=i,0===Bt&&jt(ot)),a!==i?(it.test(e.charAt(Et))?(o=e.charAt(Et),Et++):(o=i,0===Bt&&jt(st)),o!==i?s=a=[a,o]:(Et=s,s=i)):(Et=s,s=i),s===i&&(s=Et,e.substr(Et,2)===lt?(a=lt,Et+=2):(a=i,0===Bt&&jt(ct)),a!==i?(ut.test(e.charAt(Et))?(o=e.charAt(Et),Et++):(o=i,0===Bt&&jt(ht)),o!==i?s=a=[a,o]:(Et=s,s=i)):(Et=s,s=i),s===i&&(s=Et,e.substr(Et,2)===dt?(a=dt,Et+=2):(a=i,0===Bt&&jt(gt)),a!==i?(Z.test(e.charAt(Et))?(o=e.charAt(Et),Et++):(o=i,0===Bt&&jt(G)),o!==i?(K.test(e.charAt(Et))?(l=e.charAt(Et),Et++):(l=i,0===Bt&&jt(Q)),l===i&&(l=null),l!==i?s=a=[a,o,l]:(Et=s,s=i)):(Et=s,s=i)):(Et=s,s=i),s===i&&(s=Et,e.substr(Et,2)===ft?(a=ft,Et+=2):(a=i,0===Bt&&jt(pt)),a!==i?(Z.test(e.charAt(Et))?(o=e.charAt(Et),Et++):(o=i,0===Bt&&jt(G)),o!==i?(K.test(e.charAt(Et))?(l=e.charAt(Et),Et++):(l=i,0===Bt&&jt(Q)),l===i&&(l=null),l!==i?s=a=[a,o,l]:(Et=s,s=i)):(Et=s,s=i)):(Et=s,s=i)))))),s===i&&(s=null),s!==i?n=r=[r,s]:(Et=n,n=i)):(Et=n,n=i);n!==i&&(t,n=mt(n));return t=n,t}(),o===i&&(o=null),o!==i?(l=function(){var t,n,r,s;t=Et,n=Et,72===e.charCodeAt(Et)?(r=At,Et++):(r=i,0===Bt&&jt(Ct));r!==i?(K.test(e.charAt(Et))?(s=e.charAt(Et),Et++):(s=i,0===Bt&&jt(Q)),s===i&&(s=null),s!==i?n=r=[r,s]:(Et=n,n=i)):(Et=n,n=i);n!==i&&(t,n=Mt(n));return t=n,t}(),l===i&&(l=null),l!==i?(c=function(){var t,n;t=Et,n=function(){var t,n,r,s,a,o;t=Et,n=Et,43===e.charCodeAt(Et)?(r=yt,Et++):(r=i,0===Bt&&jt(bt));r!==i?(43===e.charCodeAt(Et)?(s=yt,Et++):(s=i,0===Bt&&jt(bt)),s===i&&(s=Et,Z.test(e.charAt(Et))?(a=e.charAt(Et),Et++):(a=i,0===Bt&&jt(G)),a!==i?(K.test(e.charAt(Et))?(o=e.charAt(Et),Et++):(o=i,0===Bt&&jt(Q)),o===i&&(o=null),o!==i?s=a=[a,o]:(Et=s,s=i)):(Et=s,s=i)),s===i&&(s=null),s!==i?n=r=[r,s]:(Et=n,n=i)):(Et=n,n=i);n!==i&&(t,n=xt(n));return t=n,t}(),n===i&&(n=function(){var t,n,r,s,a,o;t=Et,n=Et,45===e.charCodeAt(Et)?(r=wt,Et++):(r=i,0===Bt&&jt($t));r!==i?(45===e.charCodeAt(Et)?(s=wt,Et++):(s=i,0===Bt&&jt($t)),s===i&&(s=Et,Z.test(e.charAt(Et))?(a=e.charAt(Et),Et++):(a=i,0===Bt&&jt(G)),a!==i?(K.test(e.charAt(Et))?(o=e.charAt(Et),Et++):(o=i,0===Bt&&jt(Q)),o===i&&(o=null),o!==i?s=a=[a,o]:(Et=s,s=i)):(Et=s,s=i)),s===i&&(s=null),s!==i?n=r=[r,s]:(Et=n,n=i)):(Et=n,n=i);n!==i&&(t,n=St(n));return t=n,t}());n!==i&&(t,n=vt(n));return t=n,t}(),c===i&&(c=null),c!==i?(u=function(){var t,n,r,s,a,o,l;t=Et,n=Et,58===e.charCodeAt(Et)?(r=_t,Et++):(r=i,0===Bt&&jt(Tt));if(r!==i){if(s=Et,Z.test(e.charAt(Et))?(a=e.charAt(Et),Et++):(a=i,0===Bt&&jt(G)),a!==i){for(o=[],K.test(e.charAt(Et))?(l=e.charAt(Et),Et++):(l=i,0===Bt&&jt(Q));l!==i;)o.push(l),K.test(e.charAt(Et))?(l=e.charAt(Et),Et++):(l=i,0===Bt&&jt(Q));o!==i?s=a=[a,o]:(Et=s,s=i)}else Et=s,s=i;s===i&&(kt.test(e.charAt(Et))?(s=e.charAt(Et),Et++):(s=i,0===Bt&&jt(Nt))),s!==i?n=r=[r,s]:(Et=n,n=i)}else Et=n,n=i;n!==i&&(t,n=Rt(n));return t=n,t}(),u===i&&(u=null),u!==i?(93===e.charCodeAt(Et)?(h=S,Et++):(h=i,0===Bt&&jt(A)),h!==i?n=r=[r,s,a,o,l,c,u,h]:(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i);n!==i&&(t,n=C(n));return t=n,t}(),n===i&&(n=Zt()));n!==i&&(t,n=g(n));return t=n,t}(),r!==i){for(s=[],a=Wt();a!==i;)s.push(a),a=Wt();if(s!==i){for(a=[],l=Et,(c=Yt())===i&&(c=null),c!==i&&(u=Gt())!==i?l=c=[c,u]:(Et=l,l=i);l!==i;)a.push(l),l=Et,(c=Yt())===i&&(c=null),c!==i&&(u=Gt())!==i?l=c=[c,u]:(Et=l,l=i);if(a!==i){for(l=[],c=Wt();c!==i;)l.push(c),c=Wt();if(l!==i)if((c=Yt())===i&&(c=null),c!==i)if((u=Vt())===i&&(u=null),u!==i){for(h=[],d=Wt();d!==i;)h.push(d),d=Wt();h!==i?n=r=[r,s,a,l,c,u,h]:(Et=n,n=i)}else Et=n,n=i;else Et=n,n=i;else Et=n,n=i}else Et=n,n=i}else Et=n,n=i}else Et=n,n=i;return n!==i&&(t,n=o(n)),t=n}function Wt(){var t,n,r,s,a,o;return t=Et,n=Et,40===e.charCodeAt(Et)?(r=l,Et++):(r=i,0===Bt&&jt(c)),r!==i?((s=Yt())===i&&(s=null),s!==i&&(a=Vt())!==i?(41===e.charCodeAt(Et)?(o=u,Et++):(o=i,0===Bt&&jt(h)),o!==i?n=r=[r,s,a,o]:(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i),n!==i&&(t,n=d(n)),t=n}function Yt(){var t,n;if(t=Et,f.test(e.charAt(Et))){if((n=e.charAt(Et))===e.charAt(Et+1)&&(n=i,0===Bt))throw qt("The parser encountered a bond repetition.",Et+1);Et++}else n=i,0===Bt&&jt(p);return n!==i&&(t,n=m(n)),t=n}function Xt(){var t,n;return t=Et,B.test(e.charAt(Et))?(n=e.charAt(Et),Et++):(n=i,0===Bt&&jt(O)),n!==i&&(t,n=g(n)),t=n}function Zt(){var t,n;return t=Et,42===e.charCodeAt(Et)?(n=z,Et++):(n=i,0===Bt&&jt(H)),n!==i&&(t,n=F(n)),t=n}function Gt(){var t,n,r,s,a;return t=Et,n=Et,37===e.charCodeAt(Et)?(r=Y,Et++):(r=i,0===Bt&&jt(X)),r!==i?(Z.test(e.charAt(Et))?(s=e.charAt(Et),Et++):(s=i,0===Bt&&jt(G)),s!==i?(K.test(e.charAt(Et))?(a=e.charAt(Et),Et++):(a=i,0===Bt&&jt(Q)),a!==i?n=r=[r,s,a]:(Et=n,n=i)):(Et=n,n=i)):(Et=n,n=i),n===i&&(K.test(e.charAt(Et))?(n=e.charAt(Et),Et++):(n=i,0===Bt&&jt(Q))),n!==i&&(t,n=J(n)),t=n}if((r=a())!==i&&Et===e.length)return r;throw r!==i&&Et<e.length&&jt({type:"end"}),Ut(It,Dt<e.length?e.charAt(Dt):null,Dt<e.length?Ft(Dt,Dt+1):Ft(Dt,Dt))}}}()},6421:(t,e,n)=>{const r=n(6348),i=n(2614),s=(n(6843),n(3333));class a{constructor(t){this.id=null,this.members=t,this.edges=[],this.insiders=[],this.neighbours=[],this.positioned=!1,this.center=new i(0,0),this.rings=[],this.isBridged=!1,this.isPartOfBridged=!1,this.isSpiro=!1,this.isFused=!1,this.centralAngle=0,this.canFlip=!0}clone(){let t=new a(this.members);return t.id=this.id,t.insiders=r.clone(this.insiders),t.neighbours=r.clone(this.neighbours),t.positioned=this.positioned,t.center=this.center.clone(),t.rings=r.clone(this.rings),t.isBridged=this.isBridged,t.isPartOfBridged=this.isPartOfBridged,t.isSpiro=this.isSpiro,t.isFused=this.isFused,t.centralAngle=this.centralAngle,t.canFlip=this.canFlip,t}getSize(){return this.members.length}getPolygon(t){let e=[];for(let n=0;n<this.members.length;n++)e.push(t[this.members[n]].position);return e}getAngle(){return Math.PI-this.centralAngle}eachMember(t,e,n,r){let i=n=n||0===n?n:this.members[0],s=0;for(;null!=i&&s<100;){let a=i;e(a),i=t[i].getNextInRing(t,this.id,r),r=a,i==n&&(i=null),s++}}getOrderedNeighbours(t){let e=Array(this.neighbours.length);for(let n=0;n<this.neighbours.length;n++){let r=s.getVertices(t,this.id,this.neighbours[n]);e[n]={n:r.length,neighbour:this.neighbours[n]}}return e.sort((function(t,e){return e.n-t.n})),e}isBenzeneLike(t){let e=this.getDoubleBondCount(t),n=this.members.length;return 3===e&&6===n||2===e&&5===n}getDoubleBondCount(t){let e=0;for(let n=0;n<this.members.length;n++){let r=t[this.members[n]].value;"="!==r.bondType&&"="!==r.branchBond||e++}return e}contains(t){for(let e=0;e<this.members.length;e++)if(this.members[e]==t)return!0;return!1}}t.exports=a},3333:(t,e,n)=>{n(6843),n(6421);t.exports=class{constructor(t,e){this.id=null,this.firstRingId=t.id,this.secondRingId=e.id,this.vertices=new Set;for(var n=0;n<t.members.length;n++){let r=t.members[n];for(let t=0;t<e.members.length;t++){r===e.members[t]&&this.addVertex(r)}}}addVertex(t){this.vertices.add(t)}updateOther(t,e){this.firstRingId===e?this.secondRingId=t:this.firstRingId=t}containsRing(t){return this.firstRingId===t||this.secondRingId===t}isBridge(t){if(this.vertices.size>2)return!0;for(let e of this.vertices)if(t[e].value.rings.length>2)return!0;return!1}static isBridge(t,e,n,r){let i=null;for(let s=0;s<t.length;s++)if(i=t[s],i.firstRingId===n&&i.secondRingId===r||i.firstRingId===r&&i.secondRingId===n)return i.isBridge(e);return!1}static getNeighbours(t,e){let n=[];for(let r=0;r<t.length;r++){let i=t[r];i.firstRingId===e?n.push(i.secondRingId):i.secondRingId===e&&n.push(i.firstRingId)}return n}static getVertices(t,e,n){for(let r=0;r<t.length;r++){let i=t[r];if(i.firstRingId===e&&i.secondRingId===n||i.firstRingId===n&&i.secondRingId===e)return[...i.vertices]}}}},1681:(t,e,n)=>{const r=n(4707);class i{static getRings(t,e=!1){let n=t.getComponentsAdjacencyMatrix();if(0===n.length)return null;let s=r.getConnectedComponents(n),a=Array();for(var o=0;o<s.length;o++){let n=s[o],r=t.getSubgraphAdjacencyMatrix([...n]),u=new Uint16Array(r.length),h=new Uint16Array(r.length);for(var l=0;l<r.length;l++){h[l]=0,u[l]=0;for(var c=0;c<r[l].length;c++)u[l]+=r[l][c]}let d=0;for(l=0;l<r.length;l++)for(c=l+1;c<r.length;c++)d+=r[l][c];let g=d-r.length+1,f=!0;for(l=0;l<u.length;l++)3!==u[l]&&(f=!1);if(f&&(g=2+d-r.length),1===g){a.push([...n]);continue}e&&(g=999);let{d:p,pe:m,pe_prime:v}=i.getPathIncludedDistanceMatrices(r),y=i.getRingCandidates(p,m,v),b=i.getSSSR(y,p,r,m,v,u,h,g);for(l=0;l<b.length;l++){let t=Array(b[l].size),e=0;for(let r of b[l])t[e++]=n[r];a.push(t)}}return a}static matrixToString(t){let e="";for(var n=0;n<t.length;n++){for(var r=0;r<t[n].length;r++)e+=t[n][r]+" ";e+="\n"}return e}static getPathIncludedDistanceMatrices(t){let e=t.length,n=Array(e),r=Array(e),i=Array(e);for(var s=0,a=0,o=0,l=e;l--;){n[l]=Array(e),r[l]=Array(e),i[l]=Array(e);for(var c=e;c--;)n[l][c]=l===c||1===t[l][c]?t[l][c]:Number.POSITIVE_INFINITY,1===n[l][c]?r[l][c]=[[[l,c]]]:r[l][c]=Array(),i[l][c]=Array()}for(var u=e;u--;)for(l=e;l--;)for(c=e;c--;){const t=n[l][c],e=n[l][u]+n[u][c];if(t>e){if(t===e+1)for(i[l][c]=[r[l][c].length],s=r[l][c].length;s--;)for(i[l][c][s]=[r[l][c][s].length],a=r[l][c][s].length;a--;)for(i[l][c][s][a]=[r[l][c][s][a].length],o=r[l][c][s][a].length;o--;)i[l][c][s][a][o]=[r[l][c][s][a][0],r[l][c][s][a][1]];else i[l][c]=Array();for(n[l][c]=e,r[l][c]=[[]],s=r[l][u][0].length;s--;)r[l][c][0].push(r[l][u][0][s]);for(s=r[u][c][0].length;s--;)r[l][c][0].push(r[u][c][0][s])}else if(t===e){if(r[l][u].length&&r[u][c].length)if(r[l][c].length){let t=Array();for(s=r[l][u][0].length;s--;)t.push(r[l][u][0][s]);for(s=r[u][c][0].length;s--;)t.push(r[u][c][0][s]);r[l][c].push(t)}else{let t=Array();for(s=r[l][u][0].length;s--;)t.push(r[l][u][0][s]);for(s=r[u][c][0].length;s--;)t.push(r[u][c][0][s]);r[l][c][0]=t}}else if(t===e-1){if(i[l][c].length){let t=Array();for(s=r[l][u][0].length;s--;)t.push(r[l][u][0][s]);for(s=r[u][c][0].length;s--;)t.push(r[u][c][0][s]);i[l][c].push(t)}else{let t=Array();for(s=r[l][u][0].length;s--;)t.push(r[l][u][0][s]);for(s=r[u][c][0].length;s--;)t.push(r[u][c][0][s]);i[l][c][0]=t}}}return{d:n,pe:r,pe_prime:i}}static getRingCandidates(t,e,n){let r=t.length,i=Array(),s=0;for(let a=0;a<r;a++)for(let o=0;o<r;o++)0===t[a][o]||1===e[a][o].length&&0===n[a][o]||(s=0!==n[a][o].length?2*(t[a][o]+.5):2*t[a][o],s!==1/0&&i.push([s,e[a][o],n[a][o]]));return i.sort((function(t,e){return t[0]-e[0]})),i}static getSSSR(t,e,n,r,s,a,o,l){let c=Array(),u=Array();for(let e=0;e<t.length;e++)if(t[e][0]%2!=0)for(let r=0;r<t[e][2].length;r++){let s=t[e][1][0].concat(t[e][2][r]);for(var h=0;h<s.length;h++)s[h][0].constructor===Array&&(s[h]=s[h][0]);let d=i.bondsToAtoms(s);if(i.getBondCount(d,n)!==d.size||i.pathSetsContain(c,d,s,u,a,o)||(c.push(d),u=u.concat(s)),c.length>l)return c}else for(let r=0;r<t[e][1].length-1;r++){let s=t[e][1][r].concat(t[e][1][r+1]);for(h=0;h<s.length;h++)s[h][0].constructor===Array&&(s[h]=s[h][0]);let d=i.bondsToAtoms(s);if(i.getBondCount(d,n)!==d.size||i.pathSetsContain(c,d,s,u,a,o)||(c.push(d),u=u.concat(s)),c.length>l)return c}return c}static getEdgeCount(t){let e=0,n=t.length;for(var r=n-1;r--;)for(var i=n;i--;)1===t[r][i]&&e++;return e}static getEdgeList(t){let e=t.length,n=Array();for(var r=e-1;r--;)for(var i=e;i--;)1===t[r][i]&&n.push([r,i]);return n}static bondsToAtoms(t){let e=new Set;for(var n=t.length;n--;)e.add(t[n][0]),e.add(t[n][1]);return e}static getBondCount(t,e){let n=0;for(let r of t)for(let i of t)r!==i&&(n+=e[r][i]);return n/2}static pathSetsContain(t,e,n,r,s,a){for(var o=t.length;o--;){if(i.isSupersetOf(e,t[o]))return!0;if(t[o].size===e.size&&i.areSetsEqual(t[o],e))return!0}let l=0,c=!1;for(o=n.length;o--;)for(var u=r.length;u--;)(n[o][0]===r[u][0]&&n[o][1]===r[u][1]||n[o][1]===r[u][0]&&n[o][0]===r[u][1])&&l++,l===n.length&&(c=!0);let h=!1;if(c)for(let t of e)if(a[t]<s[t]){h=!0;break}if(c&&!h)return!0;for(let t of e)a[t]++;return!1}static areSetsEqual(t,e){if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}static isSupersetOf(t,e){for(var n of e)if(!t.has(n))return!1;return!0}}t.exports=i},1479:(t,e,n)=>{const r=n(6348),i=n(2427),s=n(4881),a=(n(4707),n(929)),o=n(6036),l=n(6654),c=n(2614);t.exports=class{constructor(t){this.preprocessor=new s(t)}draw(t,e,n="light",r=!1){let i=this.preprocessor;return i.initDraw(t,n,r),r||(this.themeManager=new l(this.preprocessor.opts.themes,n),this.svgWrapper=new o(this.themeManager,e,this.preprocessor.opts)),i.processGraph(),this.svgWrapper.determineDimensions(i.graph.vertices),this.drawEdges(i.opts.debug),this.drawVertices(i.opts.debug),i.opts.debug&&(console.log(i.graph),console.log(i.rings),console.log(i.ringConnections)),this.svgWrapper.constructSvg()}drawAromaticityRing(t){let e=this.ctx,n=MathHelper.apothemFromSideLength(this.opts.bondLength,t.getSize());e.save(),e.strokeStyle=this.getColor("C"),e.lineWidth=this.opts.bondThickness,e.beginPath(),e.arc(t.center.x+this.offsetX,t.center.y+this.offsetY,n-this.opts.bondSpacing,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.restore()}drawEdges(t){let e=this.preprocessor,n=e.graph,r=e.rings,i=Array(this.preprocessor.graph.edges.length);if(i.fill(!1),n.traverseBF(0,(e=>{let r=n.getEdges(e.id);for(var s=0;s<r.length;s++){let e=r[s];i[e]||(i[e]=!0,this.drawEdge(e,t))}})),!this.bridgedRing)for(var s=0;s<r.length;s++){let t=r[s];e.isRingAromatic(t)&&this.drawAromaticityRing(t)}}drawEdge(t,e){let n=this.preprocessor,i=n.opts,s=this.svgWrapper,o=n.graph.edges[t],l=n.graph.vertices[o.sourceId],u=n.graph.vertices[o.targetId],h=l.value.element,d=u.value.element;if(!(l.value.isDrawn&&u.value.isDrawn||"default"!==n.opts.atomVisualization))return;let g=l.position,f=u.position,p=n.getEdgeNormals(o),m=r.clone(p);if(m[0].multiplyScalar(10).add(g),m[1].multiplyScalar(10).add(g),"="===o.bondType||"="===n.getRingbondType(l,u)||o.isPartOfAromaticRing&&n.bridgedRing){let t=n.areVerticesInSameRing(l,u),e=n.chooseSide(l,u,m);if(t){let t=n.getLargestOrAromaticCommonRing(l,u).center;p[0].multiplyScalar(i.bondSpacing),p[1].multiplyScalar(i.bondSpacing);let e=null;e=t.sameSideAs(l.position,u.position,c.add(g,p[0]))?new a(c.add(g,p[0]),c.add(f,p[0]),h,d):new a(c.add(g,p[1]),c.add(f,p[1]),h,d),e.shorten(i.bondLength-i.shortBondLength*i.bondLength),o.isPartOfAromaticRing?s.drawLine(e,!0):s.drawLine(e),s.drawLine(new a(g,f,h,d))}else if(o.center||l.isTerminal()&&u.isTerminal()||0==e.anCount&&e.bnCount>1||0==e.bnCount&&e.anCount>1){this.multiplyNormals(p,i.halfBondSpacing);let t=new a(c.add(g,p[0]),c.add(f,p[0]),h,d),e=new a(c.add(g,p[1]),c.add(f,p[1]),h,d);s.drawLine(t),s.drawLine(e)}else if(e.sideCount[0]>e.sideCount[1]||e.totalSideCount[0]>e.totalSideCount[1]){this.multiplyNormals(p,i.bondSpacing);let t=new a(c.add(g,p[0]),c.add(f,p[0]),h,d);t.shorten(i.bondLength-i.shortBondLength*i.bondLength),s.drawLine(t),s.drawLine(new a(g,f,h,d))}else if(e.sideCount[0]<e.sideCount[1]||e.totalSideCount[0]<=e.totalSideCount[1]){this.multiplyNormals(p,i.bondSpacing);let t=new a(c.add(g,p[1]),c.add(f,p[1]),h,d);t.shorten(i.bondLength-i.shortBondLength*i.bondLength),s.drawLine(t),s.drawLine(new a(g,f,h,d))}}else if("#"===o.bondType){p[0].multiplyScalar(i.bondSpacing/1.5),p[1].multiplyScalar(i.bondSpacing/1.5);let t=new a(c.add(g,p[0]),c.add(f,p[0]),h,d),e=new a(c.add(g,p[1]),c.add(f,p[1]),h,d);s.drawLine(t),s.drawLine(e),s.drawLine(new a(g,f,h,d))}else if("."===o.bondType);else{let t=l.value.isStereoCenter,e=u.value.isStereoCenter;"up"===o.wedge?s.drawWedge(new a(g,f,h,d,t,e)):"down"===o.wedge?s.drawDashedWedge(new a(g,f,h,d,t,e)):s.drawLine(new a(g,f,h,d,t,e))}if(e){let e=c.midpoint(g,f);s.drawDebugText(e.x,e.y,"e: "+t)}}drawVertices(t){let e=this.preprocessor,n=e.opts,s=e.graph,a=e.rings,o=this.svgWrapper;var l=s.vertices.length;for(l=0;l<s.vertices.length;l++){let e=s.vertices[l],a=e.value,u=0,h=0,d=e.value.bondCount,g=a.element,f=i.maxBonds[g]-d,p=e.getTextDirection(s.vertices),m=!(!n.terminalCarbons&&"C"===g&&!a.hasAttachedPseudoElements)&&e.isTerminal(),v="C"===a.element;if("N"===a.element&&a.isPartOfAromaticRing&&(f=0),a.bracket&&(f=a.bracket.hcount,u=a.bracket.charge,h=a.bracket.isotope),"allballs"===n.atomVisualization)o.drawBall(e.position.x,e.position.y,g);else if(a.isDrawn&&(!v||a.drawExplicit||m||a.hasAttachedPseudoElements)||1===s.vertices.length)"default"===n.atomVisualization?o.drawText(e.position.x,e.position.y,g,f,p,m,u,h,a.getAttachedPseudoElements()):"balls"===n.atomVisualization&&o.drawBall(e.position.x,e.position.y,g);else if(2===e.getNeighbourCount()&&1==e.forcePositioned){let t=s.vertices[e.neighbours[0]].position,n=s.vertices[e.neighbours[1]].position,r=c.threePointangle(e.position,t,n);Math.abs(Math.PI-r)<.1&&o.drawPoint(e.position.x,e.position.y,g)}if(t){let t="v: "+e.id+" "+r.print(a.ringbonds);o.drawDebugText(e.position.x,e.position.y,t)}else o.drawDebugText(e.position.x,e.position.y,e.value.chirality)}if(n.debug)for(l=0;l<a.length;l++){let t=a[l].center;o.drawDebugPoint(t.x,t.y,"r: "+a[l].id)}}getTotalOverlapScore(){return this.preprocessor.getTotalOverlapScore()}getMolecularFormula(){return this.preprocessor.getMolecularFormula()}multiplyNormals(t,e){t[0].multiplyScalar(e),t[1].multiplyScalar(e)}}},6036:(t,e,n)=>{const{getChargeText:r}=n(537),i=n(929),s=n(2614);t.exports=class{constructor(t,e,n){this.svg=document.getElementById(e),this.opts=n,this.gradientId=0,this.paths=[],this.vertices=[],this.gradients=[],this.offsetX=0,this.offsetY=0,this.drawingWidth=0,this.drawingHeight=0,this.halfBondThickness=this.opts.bondThickness/2,this.themeManager=t,this.maskElements=[];let r=document.createElementNS("http://www.w3.org/2000/svg","rect");for(r.setAttributeNS(null,"x",0),r.setAttributeNS(null,"y",0),r.setAttributeNS(null,"width","100%"),r.setAttributeNS(null,"height","100%"),r.setAttributeNS(null,"fill","white"),this.maskElements.push(r);this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild)}constructSvg(){let t=document.createElementNS("http://www.w3.org/2000/svg","defs"),e=document.createElementNS("http://www.w3.org/2000/svg","mask"),n=document.createElementNS("http://www.w3.org/2000/svg","style"),r=document.createElementNS("http://www.w3.org/2000/svg","g"),i=document.createElementNS("http://www.w3.org/2000/svg","g"),s=this.paths;e.setAttributeNS(null,"id","text-mask"),n.appendChild(document.createTextNode(`\n                .element {\n                    font: ${this.opts.fontSizeLarge}pt Helvetica, Arial, sans-serif;\n                    alignment-baseline: 'middle';\n                }\n                .sub {\n                    font: ${this.opts.fontSizeSmall}pt Helvetica, Arial, sans-serif;\n                }\n            `));for(let t of s)r.appendChild(t);for(let t of this.vertices)i.appendChild(t);for(let t of this.maskElements)e.appendChild(t);for(let e of this.gradients)t.appendChild(e);if(r.setAttributeNS(null,"mask","url(#text-mask)"),this.svg)return this.svg.appendChild(t),this.svg.appendChild(e),this.svg.appendChild(n),this.svg.appendChild(r),this.svg.appendChild(i),this.svg;{let s=document.createElementNS("http://www.w3.org/2000/svg","g");return s.appendChild(t),s.appendChild(e),s.appendChild(n),s.appendChild(r),s.appendChild(i),s}}createGradient(t){let e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),n="line-"+this.gradientId++,r=t.getLeftVector(),i=t.getRightVector(),s=r.x+this.offsetX,a=r.y+this.offsetY,o=i.x+this.offsetX,l=i.y+this.offsetY;e.setAttributeNS(null,"id",n),e.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),e.setAttributeNS(null,"x1",s),e.setAttributeNS(null,"y1",a),e.setAttributeNS(null,"x2",o),e.setAttributeNS(null,"y2",l);let c=document.createElementNS("http://www.w3.org/2000/svg","stop");c.setAttributeNS(null,"stop-color",this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),c.setAttributeNS(null,"offset","20%");let u=document.createElementNS("http://www.w3.org/2000/svg","stop");return u.setAttributeNS(null,"stop-color",this.themeManager.getColor(t.getRightElement()||this.themeManager.getColor("C"))),u.setAttributeNS(null,"offset","100%"),e.appendChild(c),e.appendChild(u),this.gradients.push(e),n}createSubSuperScripts(t,e){let n=document.createElementNS("http://www.w3.org/2000/svg","tspan");return n.setAttributeNS(null,"baseline-shift",e),n.appendChild(document.createTextNode(t)),n.setAttributeNS(null,"class","sub"),n}determineDimensions(t){let e=-Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=Number.MAX_VALUE;for(var s=0;s<t.length;s++){if(!t[s].value.isDrawn)continue;let a=t[s].position;e<a.x&&(e=a.x),n<a.y&&(n=a.y),r>a.x&&(r=a.x),i>a.y&&(i=a.y)}let a=this.opts.padding;e+=a,n+=a,r-=a,i-=a,this.drawingWidth=e-r,this.drawingHeight=n-i;let o=this.svg.clientWidth/this.drawingWidth,l=this.svg.clientHeight/this.drawingHeight,c=o<l?o:l,u=Math.round(this.drawingWidth>this.drawingHeight?this.drawingWidth:this.drawingHeight);this.svg.setAttributeNS(null,"viewBox",`0 0 ${u} ${u}`),this.offsetX=-r,this.offsetY=-i,o<l?this.offsetY+=this.svg.clientHeight/(2*c)-this.drawingHeight/2:this.offsetX+=this.svg.clientWidth/(2*c)-this.drawingWidth/2}drawBall(t,e,n){let r=document.createElementNS("http://www.w3.org/2000/svg","circle");r.setAttributeNS(null,"cx",t+this.offsetX),r.setAttributeNS(null,"cy",e+this.offsetY),r.setAttributeNS(null,"r",this.opts.bondLength/4.5),r.setAttributeNS(null,"fill",this.themeManager.getColor(n)),this.vertices.push(r)}drawDashedWedge(t){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;this.offsetX,this.offsetY;let e,n,r=t.getLeftVector().clone(),a=t.getRightVector().clone(),o=s.normals(r,a);o[0].normalize(),o[1].normalize(),t.getRightChiral()?(e=a,n=r):(e=r,n=a);let l=s.subtract(n,e).normalize(),c=t.getLength(),u=1.25/(c/(3*this.opts.bondThickness)),h=this.createGradient(t);for(let t=0;t<1;t+=u){let n=s.multiplyScalar(l,t*c),r=s.add(e,n),a=1.5*t,u=s.multiplyScalar(o[0],a);r.subtract(u);let d=r.clone();d.add(s.multiplyScalar(u,2)),this.drawLine(new i(r,d),null,h)}}drawDebugPoint(t,e,n="",r="#f00"){let i=document.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttributeNS(null,"cx",t+this.offsetX),i.setAttributeNS(null,"cy",e+this.offsetY),i.setAttributeNS(null,"r","2"),i.setAttributeNS(null,"fill","#f00"),this.vertices.push(i),this.drawDebugText(t,e,n)}drawDebugText(t,e,n){let r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttributeNS(null,"x",t+this.offsetX),r.setAttributeNS(null,"y",e+this.offsetY),r.setAttributeNS(null,"class","debug"),r.setAttributeNS(null,"fill","#ff0000"),r.setAttributeNS(null,"style","\n                font: 5px Droid Sans, sans-serif;\n            "),r.appendChild(document.createTextNode(n)),this.vertices.push(r)}drawLine(t,e=!1,n=null){this.opts;let r=[["stroke-linecap","round"],["stroke-dasharray",e?"5, 5":"none"]],i=t.getLeftVector(),s=t.getRightVector(),a=i.x+this.offsetX,o=i.y+this.offsetY,l=s.x+this.offsetX,c=s.y+this.offsetY,u=r.map((t=>t.join(":"))).join(";"),h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttributeNS(null,"x1",a),h.setAttributeNS(null,"y1",o),h.setAttributeNS(null,"x2",l),h.setAttributeNS(null,"y2",c),h.setAttributeNS(null,"style",u),this.paths.push(h),null==n&&(n=this.createGradient(t,a,o,l,c)),h.setAttributeNS(null,"stroke",`url('#${n}')`)}drawPoint(t,e,n){this.ctx;let r=this.offsetX,i=this.offsetY,s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.setAttributeNS(null,"cx",t+r),s.setAttributeNS(null,"cy",e+i),s.setAttributeNS(null,"r","1.5"),s.setAttributeNS(null,"fill","black"),this.maskElements.push(s);let a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.setAttributeNS(null,"cx",t+r),a.setAttributeNS(null,"cy",e+i),a.setAttributeNS(null,"r","0.75"),a.setAttributeNS(null,"fill",this.themeManager.getColor(n)),this.vertices.push(a)}drawText(t,e,n,i,s,a,o,l,c={}){let u={x:t+this.offsetX,y:e+this.offsetY},h=document.createElementNS("http://www.w3.org/2000/svg","text"),d="horizontal-tb",g="normal",f="mixed",p="direction: ltr;",m=-2,v=2.5,y=document.createElementNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"cx",u.x),y.setAttributeNS(null,"cy",u.y),y.setAttributeNS(null,"r","3.5"),y.setAttributeNS(null,"fill","black"),this.maskElements.push(y),/up|down/.test(s)&&!a&&(d="vertical-rl",f="upright",g="-1px"),"down"!==s||a?"up"!==s||a?"left"===s&&(m=2):m=.5:(m=0,v=-2),("left"===s||"up"===s&&!a)&&(p="direction: rtl; unicode-bidi: bidi-override;"),h.setAttributeNS(null,"x",u.x+m),h.setAttributeNS(null,"y",u.y+v),h.setAttributeNS(null,"class","element"),h.setAttributeNS(null,"fill",this.themeManager.getColor(n)),h.setAttributeNS(null,"style",`\n                text-anchor: start;\n                writing-mode: ${d};\n                text-orientation: ${f};\n                letter-spacing: ${g};\n                ${p}\n            `);let b=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(n.length>1){let t=/up|down/.test(s)?"middle":"start";b.setAttributeNS(null,"style",`\n                unicode-bidi: plaintext;\n                writing-mode: lr-tb;\n                letter-spacing: normal;\n                text-anchor: ${t};\n            `)}if(b.appendChild(document.createTextNode(n)),h.appendChild(b),o){let t=this.createSubSuperScripts(r(o),"super");b.appendChild(t)}if(l>0){let t=this.createSubSuperScripts(l.toString(),"super");b.appendChild(t)}if(1===o&&"N"===n&&c.hasOwnProperty("0O")&&c.hasOwnProperty("0O-1")&&(c={"0O":{element:"O",count:2,hydrogenCount:0,previousElement:"C",charge:""}},o=0),i>0){let t=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(t.setAttributeNS(null,"style","unicode-bidi: plaintext;"),t.appendChild(document.createTextNode("H")),h.appendChild(t),i>1){let e=this.createSubSuperScripts(i,"sub");t.appendChild(e)}}for(let t in c){if(!c.hasOwnProperty(t))continue;let e=c[t].element,n=c[t].count,i=c[t].hydrogenCount,s=c[t].charge,a=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(a.setAttributeNS(null,"style","unicode-bidi: plaintext;"),a.appendChild(document.createTextNode(e)),a.setAttributeNS(null,"fill",this.themeManager.getColor(e)),0!==s){let t=this.createSubSuperScripts(r(s),"super");a.appendChild(t)}if(i>0){let t=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(t.setAttributeNS(null,"style","unicode-bidi: plaintext;"),t.appendChild(document.createTextNode("H")),a.appendChild(t),i>1){let e=this.createSubSuperScripts(i,"sub");t.appendChild(e)}}if(n>1){let t=this.createSubSuperScripts(n,"sub");a.appendChild(t)}h.appendChild(a)}this.vertices.push(h)}drawWedge(t){let e=this.offsetX,n=this.offsetY,r=t.getLeftVector().clone(),i=t.getRightVector().clone();r.x+=e,r.y+=n,i.x+=e,i.y+=n;let a=s.normals(r,i);a[0].normalize(),a[1].normalize();let o=r,l=i;t.getRightChiral()&&(o=i,l=r);let c=s.add(o,s.multiplyScalar(a[0],this.halfBondThickness)),u=s.add(l,s.multiplyScalar(a[0],1.5+this.halfBondThickness)),h=s.add(l,s.multiplyScalar(a[1],1.5+this.halfBondThickness)),d=s.add(o,s.multiplyScalar(a[1],this.halfBondThickness)),g=document.createElementNS("http://www.w3.org/2000/svg","polygon"),f=this.createGradient(t,r.x,r.y,i.x,i.y);g.setAttributeNS(null,"points",`${c.x},${c.y} ${u.x},${u.y} ${h.x},${h.y} ${d.x},${d.y}`),g.setAttributeNS(null,"fill",`url('#${f}')`),this.paths.push(g)}}},6654:t=>{t.exports=class{constructor(t,e){this.colors=t,this.theme=this.colors[e]}getColor(t){return t&&(t=t.toUpperCase())in this.theme?this.theme[t]:this.theme.C}setTheme(t){this.colors.hasOwnProperty(t)&&(this.theme=this.colors[t])}}},537:t=>{t.exports={getChargeText:function(t){return console.log("in the utility version of getChargeText"),1===t?"+":2===t?"2+":-1===t?"-":-2===t?"2-":""}}},2614:t=>{class e{constructor(t,e){0==arguments.length?(this.x=0,this.y=0):1==arguments.length?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}clone(){return new e(this.x,this.y)}toString(){return"("+this.x+","+this.y+")"}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}divide(t){return this.x/=t,this.y/=t,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}invert(){return this.x=-this.x,this.y=-this.y,this}angle(){return Math.atan2(this.y,this.x)}distance(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))}distanceSq(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)}clockwise(t){let e=this.y*t.x,n=this.x*t.y;return e>n?-1:e===n?0:1}relativeClockwise(t,e){let n=(this.y-t.y)*(e.x-t.x),r=(this.x-t.x)*(e.y-t.y);return n>r?-1:n===r?0:1}rotate(t){let n=new e(0,0),r=Math.cos(t),i=Math.sin(t);return n.x=this.x*r-this.y*i,n.y=this.x*i+this.y*r,this.x=n.x,this.y=n.y,this}rotateAround(t,e){let n=Math.sin(t),r=Math.cos(t);this.x-=e.x,this.y-=e.y;let i=this.x*r-this.y*n,s=this.x*n+this.y*r;return this.x=i+e.x,this.y=s+e.y,this}rotateTo(t,n,r=0){this.x+=.001,this.y-=.001;let i=e.subtract(this,n),s=e.subtract(t,n),a=e.angle(s,i);return this.rotateAround(a+r,n),this}rotateAwayFrom(t,e,n){this.rotateAround(n,e);let r=this.distanceSq(t);this.rotateAround(-2*n,e),this.distanceSq(t)<r&&this.rotateAround(2*n,e)}getRotateAwayFromAngle(t,e,n){let r=this.clone();r.rotateAround(n,e);let i=r.distanceSq(t);return r.rotateAround(-2*n,e),r.distanceSq(t)<i?n:-n}getRotateTowardsAngle(t,e,n){let r=this.clone();r.rotateAround(n,e);let i=r.distanceSq(t);return r.rotateAround(-2*n,e),r.distanceSq(t)>i?n:-n}getRotateToAngle(t,n){let r=e.subtract(this,n),i=e.subtract(t,n),s=e.angle(i,r);return Number.isNaN(s)?0:s}isInPolygon(t){let e=!1;for(let n=0,r=t.length-1;n<t.length;r=n++)t[n].y>this.y!=t[r].y>this.y&&this.x<(t[r].x-t[n].x)*(this.y-t[n].y)/(t[r].y-t[n].y)+t[n].x&&(e=!e);return e}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSq(){return this.x*this.x+this.y*this.y}normalize(){return this.divide(this.length()),this}normalized(){return e.divideScalar(this,this.length())}whichSide(t,e){return(this.x-t.x)*(e.y-t.y)-(this.y-t.y)*(e.x-t.x)}sameSideAs(t,e,n){let r=this.whichSide(t,e),i=n.whichSide(t,e);return r<0&&i<0||0==r&&0==i||r>0&&i>0}static add(t,n){return new e(t.x+n.x,t.y+n.y)}static subtract(t,n){return new e(t.x-n.x,t.y-n.y)}static multiply(t,n){return new e(t.x*n.x,t.y*n.y)}static multiplyScalar(t,n){return new e(t.x,t.y).multiplyScalar(n)}static midpoint(t,n){return new e((t.x+n.x)/2,(t.y+n.y)/2)}static normals(t,n){let r=e.subtract(n,t);return[new e(-r.y,r.x),new e(r.y,-r.x)]}static units(t,n){let r=e.subtract(n,t);return[new e(-r.y,r.x).normalize(),new e(r.y,-r.x).normalize()]}static divide(t,n){return new e(t.x/n.x,t.y/n.y)}static divideScalar(t,n){return new e(t.x/n,t.y/n)}static dot(t,e){return t.x*e.x+t.y*e.y}static angle(t,n){let r=e.dot(t,n);return Math.acos(r/(t.length()*n.length()))}static threePointangle(t,n,r){let i=e.subtract(n,t),s=e.subtract(r,n),a=t.distance(n),o=n.distance(r);return Math.acos(e.dot(i,s)/(a*o))}static scalarProjection(t,n){let r=n.normalized();return e.dot(t,r)}static averageDirection(t){let n=new e(0,0);for(var r=0;r<t.length;r++){let e=t[r];n.add(e)}return n.normalize()}}t.exports=e},6843:(t,e,n)=>{const r=n(5474),i=n(6348),s=n(2614);n(2427);class a{constructor(t,e=0,n=0){this.id=null,this.value=t,this.position=new s(e||0,n||0),this.previousPosition=new s(0,0),this.parentVertexId=null,this.children=Array(),this.spanningTreeChildren=Array(),this.edges=Array(),this.positioned=!1,this.angle=null,this.dir=1,this.neighbourCount=0,this.neighbours=Array(),this.neighbouringElements=Array(),this.forcePositioned=!1}setPosition(t,e){this.position.x=t,this.position.y=e}setPositionFromVector(t){this.position.x=t.x,this.position.y=t.y}addChild(t){this.children.push(t),this.neighbours.push(t),this.neighbourCount++}addRingbondChild(t,e){if(this.children.push(t),this.value.bracket){let n=1;0===this.id&&0===this.value.bracket.hcount&&(n=0),1===this.value.bracket.hcount&&0===e&&(n=2),1===this.value.bracket.hcount&&1===e&&(n=this.neighbours.length<3?2:3),null===this.value.bracket.hcount&&0===e&&(n=1),null===this.value.bracket.hcount&&1===e&&(n=this.neighbours.length<3?1:2),this.neighbours.splice(n,0,t)}else this.neighbours.push(t);this.neighbourCount++}setParentVertexId(t){this.neighbourCount++,this.parentVertexId=t,this.neighbours.push(t)}isTerminal(){return!!this.value.hasAttachedPseudoElements||(null===this.parentVertexId&&this.children.length<2||0===this.children.length)}clone(){let t=new a(this.value,this.position.x,this.position.y);return t.id=this.id,t.previousPosition=new s(this.previousPosition.x,this.previousPosition.y),t.parentVertexId=this.parentVertexId,t.children=i.clone(this.children),t.spanningTreeChildren=i.clone(this.spanningTreeChildren),t.edges=i.clone(this.edges),t.positioned=this.positioned,t.angle=this.angle,t.forcePositioned=this.forcePositioned,t}equals(t){return this.id===t.id}getAngle(t=null,e=!1){let n=null;return n=t?s.subtract(this.position,t):s.subtract(this.position,this.previousPosition),e?r.toDeg(n.angle()):n.angle()}getTextDirection(t){let e=this.getDrawnNeighbours(t),n=Array();for(let r=0;r<e.length;r++)n.push(this.getAngle(t[e[r]].position));let i=r.meanAngle(n),s=Math.PI/2;return i=Math.round(Math.round(i/s)*s),2===i?"down":-2===i?"up":0===i||-0===i?"right":3===i||-3===i?"left":"down"}getNeighbours(t=null){if(null===t)return this.neighbours.slice();let e=Array();for(let n=0;n<this.neighbours.length;n++)this.neighbours[n]!==t&&e.push(this.neighbours[n]);return e}getDrawnNeighbours(t){let e=Array();for(let n=0;n<this.neighbours.length;n++)t[this.neighbours[n]].value.isDrawn&&e.push(this.neighbours[n]);return e}getNeighbourCount(){return this.neighbourCount}getSpanningTreeNeighbours(t=null){let e=Array();for(let n=0;n<this.spanningTreeChildren.length;n++)void 0!==t&&t==this.spanningTreeChildren[n]||e.push(this.spanningTreeChildren[n]);return null!=this.parentVertexId&&(void 0!==t&&t==this.parentVertexId||e.push(this.parentVertexId)),e}getNextInRing(t,e,n){let r=this.getNeighbours();for(let s=0;s<r.length;s++)if(i.contains(t[r[s]].value.rings,{value:e})&&r[s]!=n)return r[s];return null}}t.exports=a}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,n),s.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";var t=r;Object.defineProperty(t,"__esModule",{value:!0}),t.start=t.initialiseDomains=t.createRegionNavigationHandlers=t.createGeneralHandlers=t.setData=t.addHelpTooltipHandlers=t.tabKeyUpEvent=t.switchToRegion=t.getAnchor=t.initDownloadButtons=t.setupDetails=t.drawStructures=t.createModuleHandlers=t.createRecordOverviews=t.downloadSvg=void 0;const e=n(2220),i=n(5225),s=n(9026),a=n(8322),o=n(6128),l=n(4501),c=n(5415),u=n(7082),h=n(6457),d=n(6878),g=n(9681),f=n(2625),p=n(7024),m=n(5003);var v=n(5415);Object.defineProperty(t,"downloadSvg",{enumerable:!0,get:function(){return v.downloadSvg}});var y=n(9681);Object.defineProperty(t,"createRecordOverviews",{enumerable:!0,get:function(){return y.createRecordOverviews}});var b=n(6878);Object.defineProperty(t,"createModuleHandlers",{enumerable:!0,get:function(){return b.createModuleHandlers}});var x=n(2625);Object.defineProperty(t,"drawStructures",{enumerable:!0,get:function(){return x.drawStructures}});var w=n(6128);Object.defineProperty(t,"setupDetails",{enumerable:!0,get:function(){return w.setupDetails}});var S=n(5415);Object.defineProperty(t,"initDownloadButtons",{enumerable:!0,get:function(){return S.initDownloadButtons}});const A="antismash.outputs.html.visualisers";let C=null,M=null;function _(t){t.preventDefault(),$("#downloadmenu").fadeToggle("fast","linear")}function T(){const t=window.location.hash.substring(1);return t||"overview"}function k(){setTimeout((()=>{$(".page").hide(),$(".empty-on-leave").empty(),$(".regbutton").removeClass("active");const t=T();$(`#${t}`).show(),"overview"!==t&&($(`.regbutton.${t}`).addClass("active"),void 0!==C[t]&&(0,m.drawRegion)(`${t}-svg`,C[t],20),(0,i.setClusterblastData)(t,M[t]["antismash.modules.clusterblast"],C[t]),t in M&&(`${A}.nrps_pks_domains`in M[t]&&(0,d.drawDomains)(t,M[t][`${A}.nrps_pks_domains`],25),"antismash.modules.cluster_compare"in M[t]&&(0,a.setComparisonData)(t,M[t]["antismash.modules.cluster_compare"],C[t]),`${A}.bubble_view`in M[t]&&(0,l.drawDomainBubbleData)(t,M[t][`${A}.bubble_view`]),`${A}.generic_domains`in M[t]&&(0,u.drawGenericDomains)(t,M[t][`${A}.generic_domains`],25),`${A}.gene_table`in M[t]&&(0,h.initGeneTableHandler)(C[t],M[t][`${A}.gene_table`]),"antismash.modules.tfbs_finder"in M[t]&&(0,p.drawBindingSites)(t,M[t]["antismash.modules.tfbs_finder"])),$(`#${t} .comparison-selector`).change(),$(`#${t} * .body-details-header-active`).first().click())}),1)}function N(){const t=C.order,e=T();let n="overview";if("overview"===e)n=t[0];else{const r=t.indexOf(e);r!==t.length-1&&(n=t[r+1])}window.location.href=`#${n}`,k()}function R(){const t=C.order,e=T();let n="";if("overview"===e)n=t[t.length-1];else{const r=t.indexOf(e);0!==r&&(n=t[r-1])}window.location.href=`#${n}`,k()}function L(t,e){const n=t+"-active",r=T(),i=$(`#${r}`).find(`.${t}`),s=$(`#${r}`).find(`.${n}`);i&&s&&s&&(e>0?s.is(i.last())?i.first().trigger("click"):s.next().trigger("click"):s.is(i.first())?i.last().trigger("click"):s.prev().trigger("click"))}function E(t){const e=t.keyCode;"overview"!==T()&&(65===e?L("body-details-header",-1):83===e?L("body-details-header",1):68===e?L("sidepanel-details-header",-1):70===e?L("sidepanel-details-header",1):77===e&&$("input.show-module-domains").first().click())}function P(t){const e=t.keyCode;37===e||87===e?R():39!==e&&69!==e||N(),E(t)}function D(t){t.preventDefault();const e=($(this).attr("id")||"").replace(/-header/,"");if(!e)return;const n=$(`#${e}`);"none"===n.css("display")?$(this).text("Hide pHMM detection rules used"):$(this).text("Show pHMM detection rules used"),n.fadeToggle("fast","linear")}function I(){$(".help-icon").off("click").click((function(){$(this).toggleClass("active"),$(this).next().toggle()})),$(".help-tooltip").off("click").click((function(){$(this).hide(),$(this).prev().removeClass("active")}))}function B(t,e,n){C=t,M=e}function O(){$("#download").click(_),$(".clipboard-copy").off("click").click(e.copyToClipboard),$(".collapser").click(s.toggleCollapserHandler),$(".cds-selector").click(m.locusSelectionHandler)}function z(){$("#next-region").click(N),$("#prev-region").click(R),$(".regbutton").click((function(){const t=$(this).children().first().attr("href");void 0!==t&&(window.location.href=t,k())})).mouseover((function(){const t=($(this).attr("class")||"").split(" ");if(t.length<2)return;if("separator"===t[1])return;const e=function(t){switch(t){case"nrps":return"NRPS";case"t1pks":return"Type I PKS";case"t2pks":return"Type II PKS";case"t3pks":return"Type III PKS";case"t4pks":return"Type IV PKS";default:return t}}(t[1]),n=$("#region-type");n.data("orig_text",n.text()),n.text(`${e}:`)})).mouseout((()=>{const t=$("#region-type");t.text(t.data("orig_text"))}))}function H(){$("input.domains-selected-only").change((function(){$("input.domains-selected-only").prop("checked",$(this).prop("checked")),(0,d.redrawDomains)(),(0,u.redrawGenericDomains)()})),$("input.domains-expand-full").change((function(){$("input.domains-expand-full").prop("checked",$(this).prop("checked")),(0,u.redrawGenericDomains)({reset:!0,anchor:T()})}))}t.getAnchor=T,t.switchToRegion=k,t.tabKeyUpEvent=E,t.addHelpTooltipHandlers=I,t.setData=B,t.createGeneralHandlers=O,t.createRegionNavigationHandlers=z,t.initialiseDomains=H,t.start=function(t,e,n){(0,g.createRecordOverviews)(n),B(t,e),document.addEventListener("keyup",P,!1),O(),z(),$(".comparison-selector").change((function(){const t=($(this).attr("id")||"nonexistant").replace("-selector","");$(`#${t}`).siblings().removeClass("comparison-container-active");const e=$(this).attr("data-tag");$(`#${t}-${$(this).val()}`).addClass("comparison-container-active").find(`.heat-row-${e}`).first().click()})),$(".cluster-rules-header").click(D),k(),$("input.overview-switch-compact").change((function(){$(this).prop("checked")?($("#single-record-tables").hide(),$("#compact-record-table").show()):($("#single-record-tables").show(),$("#compact-record-table").hide())})).trigger("change"),$(".linked-row").off("click").click((function(){const t=$(this).attr("data-anchor");t&&(window.location.href=t,k())})),H(),(0,d.createModuleHandlers)(),(0,f.drawStructures)(),(0,o.setupDetails)(t.order),I(),(0,c.initDownloadButtons)()}})(),viewer=r})();